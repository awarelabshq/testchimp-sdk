{"version":3,"file":"testchimp-sdk.js","mappings":"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","sources":["webpack://TestChimpSDK/webpack/universalModuleDefinition","webpack://TestChimpSDK/webpack/bootstrap","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/packages/rrweb-snapshot/es/rrweb-snapshot.js","webpack://TestChimpSDK/webpack/runtime/define property getters","webpack://TestChimpSDK/webpack/runtime/hasOwnProperty shorthand","webpack://TestChimpSDK/webpack/runtime/make namespace object","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/packages/rrweb/src/utils.js","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/packages/types/dist/types.js","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/packages/rrweb/src/record/mutation.js","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/packages/rrweb/src/record/observer.js","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/packages/rrweb/src/record/cross-origin-iframe-mirror.js","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/packages/rrweb/src/record/iframe-manager.js","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/packages/rrweb/src/record/shadow-dom-manager.js","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/ext/base64-arraybuffer/dist/base64-arraybuffer.es5.js","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/packages/rrweb/src/record/observers/canvas/serialize-args.js","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/packages/rrweb/src/record/observers/canvas/canvas.js","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/packages/rrweb/src/record/observers/canvas/webgl.js","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/_virtual/_rollup-plugin-web-worker-loader__helper__node__WorkerClass.js","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/_virtual/_rollup-plugin-web-worker-loader__helper__auto__isNodeJS.js","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/_virtual/_rollup-plugin-web-worker-loader__helper__auto__createBase64WorkerFactory.js","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/_virtual/image-bitmap-data-url-worker.js","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/_virtual/_rollup-plugin-web-worker-loader__helper__node__createBase64WorkerFactory.js","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/_virtual/_rollup-plugin-web-worker-loader__helper__browser__createBase64WorkerFactory.js","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/packages/rrweb/src/record/observers/canvas/canvas-manager.js","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/ext/tslib/tslib.es6.js","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/packages/rrweb/src/record/observers/canvas/2d.js","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/packages/rrweb/src/record/stylesheet-manager.js","webpack://TestChimpSDK/./node_modules/rrweb/es/rrweb/packages/rrweb/src/record/index.js","webpack://TestChimpSDK/./node_modules/@mswjs/interceptors/lib/browser/chunk-6HYIRFX2.mjs","webpack://TestChimpSDK/./node_modules/@mswjs/interceptors/lib/browser/chunk-OMISYKWR.mjs","webpack://TestChimpSDK/./node_modules/is-node-process/lib/index.mjs","webpack://TestChimpSDK/./node_modules/outvariant/lib/index.mjs","webpack://TestChimpSDK/./node_modules/@open-draft/logger/lib/index.mjs","webpack://TestChimpSDK/./node_modules/strict-event-emitter/lib/index.mjs","webpack://TestChimpSDK/./node_modules/@mswjs/interceptors/lib/browser/chunk-QED3Q6Z2.mjs","webpack://TestChimpSDK/./node_modules/@mswjs/interceptors/lib/browser/index.mjs","webpack://TestChimpSDK/./node_modules/@open-draft/deferred-promise/build/index.mjs","webpack://TestChimpSDK/./node_modules/@mswjs/interceptors/lib/browser/chunk-OUWBQF3Z.mjs","webpack://TestChimpSDK/./node_modules/@open-draft/until/lib/index.mjs","webpack://TestChimpSDK/./node_modules/@mswjs/interceptors/lib/browser/chunk-MAEPOYB6.mjs","webpack://TestChimpSDK/./node_modules/@mswjs/interceptors/lib/browser/chunk-732REFPX.mjs","webpack://TestChimpSDK/./index.mjs"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"TestChimpSDK\"] = factory();\n\telse\n\t\troot[\"TestChimpSDK\"] = factory();\n})(this, function() {\nreturn ","// The require scope\nvar __webpack_require__ = {};\n\n","var NodeType;\r\n(function (NodeType) {\r\n    NodeType[NodeType[\"Document\"] = 0] = \"Document\";\r\n    NodeType[NodeType[\"DocumentType\"] = 1] = \"DocumentType\";\r\n    NodeType[NodeType[\"Element\"] = 2] = \"Element\";\r\n    NodeType[NodeType[\"Text\"] = 3] = \"Text\";\r\n    NodeType[NodeType[\"CDATA\"] = 4] = \"CDATA\";\r\n    NodeType[NodeType[\"Comment\"] = 5] = \"Comment\";\r\n})(NodeType || (NodeType = {}));\n\nfunction isElement(n) {\r\n    return n.nodeType === n.ELEMENT_NODE;\r\n}\r\nfunction isShadowRoot(n) {\r\n    var host = n === null || n === void 0 ? void 0 : n.host;\r\n    return Boolean((host === null || host === void 0 ? void 0 : host.shadowRoot) === n);\r\n}\r\nfunction isNativeShadowDom(shadowRoot) {\r\n    return Object.prototype.toString.call(shadowRoot) === '[object ShadowRoot]';\r\n}\r\nfunction fixBrowserCompatibilityIssuesInCSS(cssText) {\r\n    if (cssText.includes(' background-clip: text;') &&\r\n        !cssText.includes(' -webkit-background-clip: text;')) {\r\n        cssText = cssText.replace(' background-clip: text;', ' -webkit-background-clip: text; background-clip: text;');\r\n    }\r\n    return cssText;\r\n}\r\nfunction getCssRulesString(s) {\r\n    try {\r\n        var rules = s.rules || s.cssRules;\r\n        return rules\r\n            ? fixBrowserCompatibilityIssuesInCSS(Array.from(rules).map(getCssRuleString).join(''))\r\n            : null;\r\n    }\r\n    catch (error) {\r\n        return null;\r\n    }\r\n}\r\nfunction getCssRuleString(rule) {\r\n    var cssStringified = rule.cssText;\r\n    if (isCSSImportRule(rule)) {\r\n        try {\r\n            cssStringified = getCssRulesString(rule.styleSheet) || cssStringified;\r\n        }\r\n        catch (_a) {\r\n        }\r\n    }\r\n    return cssStringified;\r\n}\r\nfunction isCSSImportRule(rule) {\r\n    return 'styleSheet' in rule;\r\n}\r\nvar Mirror = (function () {\r\n    function Mirror() {\r\n        this.idNodeMap = new Map();\r\n        this.nodeMetaMap = new WeakMap();\r\n    }\r\n    Mirror.prototype.getId = function (n) {\r\n        var _a;\r\n        if (!n)\r\n            return -1;\r\n        var id = (_a = this.getMeta(n)) === null || _a === void 0 ? void 0 : _a.id;\r\n        return id !== null && id !== void 0 ? id : -1;\r\n    };\r\n    Mirror.prototype.getNode = function (id) {\r\n        return this.idNodeMap.get(id) || null;\r\n    };\r\n    Mirror.prototype.getIds = function () {\r\n        return Array.from(this.idNodeMap.keys());\r\n    };\r\n    Mirror.prototype.getMeta = function (n) {\r\n        return this.nodeMetaMap.get(n) || null;\r\n    };\r\n    Mirror.prototype.removeNodeFromMap = function (n) {\r\n        var _this = this;\r\n        var id = this.getId(n);\r\n        this.idNodeMap[\"delete\"](id);\r\n        if (n.childNodes) {\r\n            n.childNodes.forEach(function (childNode) {\r\n                return _this.removeNodeFromMap(childNode);\r\n            });\r\n        }\r\n    };\r\n    Mirror.prototype.has = function (id) {\r\n        return this.idNodeMap.has(id);\r\n    };\r\n    Mirror.prototype.hasNode = function (node) {\r\n        return this.nodeMetaMap.has(node);\r\n    };\r\n    Mirror.prototype.add = function (n, meta) {\r\n        var id = meta.id;\r\n        this.idNodeMap.set(id, n);\r\n        this.nodeMetaMap.set(n, meta);\r\n    };\r\n    Mirror.prototype.replace = function (id, n) {\r\n        var oldNode = this.getNode(id);\r\n        if (oldNode) {\r\n            var meta = this.nodeMetaMap.get(oldNode);\r\n            if (meta)\r\n                this.nodeMetaMap.set(n, meta);\r\n        }\r\n        this.idNodeMap.set(id, n);\r\n    };\r\n    Mirror.prototype.reset = function () {\r\n        this.idNodeMap = new Map();\r\n        this.nodeMetaMap = new WeakMap();\r\n    };\r\n    return Mirror;\r\n}());\r\nfunction createMirror() {\r\n    return new Mirror();\r\n}\r\nfunction maskInputValue(_a) {\r\n    var maskInputOptions = _a.maskInputOptions, tagName = _a.tagName, type = _a.type, value = _a.value, maskInputFn = _a.maskInputFn;\r\n    var text = value || '';\r\n    if (maskInputOptions[tagName.toLowerCase()] ||\r\n        maskInputOptions[type]) {\r\n        if (maskInputFn) {\r\n            text = maskInputFn(text);\r\n        }\r\n        else {\r\n            text = '*'.repeat(text.length);\r\n        }\r\n    }\r\n    return text;\r\n}\r\nvar ORIGINAL_ATTRIBUTE_NAME = '__rrweb_original__';\r\nfunction is2DCanvasBlank(canvas) {\r\n    var ctx = canvas.getContext('2d');\r\n    if (!ctx)\r\n        return true;\r\n    var chunkSize = 50;\r\n    for (var x = 0; x < canvas.width; x += chunkSize) {\r\n        for (var y = 0; y < canvas.height; y += chunkSize) {\r\n            var getImageData = ctx.getImageData;\r\n            var originalGetImageData = ORIGINAL_ATTRIBUTE_NAME in getImageData\r\n                ? getImageData[ORIGINAL_ATTRIBUTE_NAME]\r\n                : getImageData;\r\n            var pixelBuffer = new Uint32Array(originalGetImageData.call(ctx, x, y, Math.min(chunkSize, canvas.width - x), Math.min(chunkSize, canvas.height - y)).data.buffer);\r\n            if (pixelBuffer.some(function (pixel) { return pixel !== 0; }))\r\n                return false;\r\n        }\r\n    }\r\n    return true;\r\n}\n\nvar _id = 1;\r\nvar tagNameRegex = new RegExp('[^a-z0-9-_:]');\r\nvar IGNORED_NODE = -2;\r\nfunction genId() {\r\n    return _id++;\r\n}\r\nfunction getValidTagName(element) {\r\n    if (element instanceof HTMLFormElement) {\r\n        return 'form';\r\n    }\r\n    var processedTagName = element.tagName.toLowerCase().trim();\r\n    if (tagNameRegex.test(processedTagName)) {\r\n        return 'div';\r\n    }\r\n    return processedTagName;\r\n}\r\nfunction stringifyStyleSheet(sheet) {\r\n    return sheet.cssRules\r\n        ? Array.from(sheet.cssRules)\r\n            .map(function (rule) { return rule.cssText || ''; })\r\n            .join('')\r\n        : '';\r\n}\r\nfunction extractOrigin(url) {\r\n    var origin = '';\r\n    if (url.indexOf('//') > -1) {\r\n        origin = url.split('/').slice(0, 3).join('/');\r\n    }\r\n    else {\r\n        origin = url.split('/')[0];\r\n    }\r\n    origin = origin.split('?')[0];\r\n    return origin;\r\n}\r\nvar canvasService;\r\nvar canvasCtx;\r\nvar URL_IN_CSS_REF = /url\\((?:(')([^']*)'|(\")(.*?)\"|([^)]*))\\)/gm;\r\nvar RELATIVE_PATH = /^(?!www\\.|(?:http|ftp)s?:\\/\\/|[A-Za-z]:\\\\|\\/\\/|#).*/;\r\nvar DATA_URI = /^(data:)([^,]*),(.*)/i;\r\nfunction absoluteToStylesheet(cssText, href) {\r\n    return (cssText || '').replace(URL_IN_CSS_REF, function (origin, quote1, path1, quote2, path2, path3) {\r\n        var filePath = path1 || path2 || path3;\r\n        var maybeQuote = quote1 || quote2 || '';\r\n        if (!filePath) {\r\n            return origin;\r\n        }\r\n        if (!RELATIVE_PATH.test(filePath)) {\r\n            return \"url(\".concat(maybeQuote).concat(filePath).concat(maybeQuote, \")\");\r\n        }\r\n        if (DATA_URI.test(filePath)) {\r\n            return \"url(\".concat(maybeQuote).concat(filePath).concat(maybeQuote, \")\");\r\n        }\r\n        if (filePath[0] === '/') {\r\n            return \"url(\".concat(maybeQuote).concat(extractOrigin(href) + filePath).concat(maybeQuote, \")\");\r\n        }\r\n        var stack = href.split('/');\r\n        var parts = filePath.split('/');\r\n        stack.pop();\r\n        for (var _i = 0, parts_1 = parts; _i < parts_1.length; _i++) {\r\n            var part = parts_1[_i];\r\n            if (part === '.') {\r\n                continue;\r\n            }\r\n            else if (part === '..') {\r\n                stack.pop();\r\n            }\r\n            else {\r\n                stack.push(part);\r\n            }\r\n        }\r\n        return \"url(\".concat(maybeQuote).concat(stack.join('/')).concat(maybeQuote, \")\");\r\n    });\r\n}\r\nvar SRCSET_NOT_SPACES = /^[^ \\t\\n\\r\\u000c]+/;\r\nvar SRCSET_COMMAS_OR_SPACES = /^[, \\t\\n\\r\\u000c]+/;\r\nfunction getAbsoluteSrcsetString(doc, attributeValue) {\r\n    if (attributeValue.trim() === '') {\r\n        return attributeValue;\r\n    }\r\n    var pos = 0;\r\n    function collectCharacters(regEx) {\r\n        var chars;\r\n        var match = regEx.exec(attributeValue.substring(pos));\r\n        if (match) {\r\n            chars = match[0];\r\n            pos += chars.length;\r\n            return chars;\r\n        }\r\n        return '';\r\n    }\r\n    var output = [];\r\n    while (true) {\r\n        collectCharacters(SRCSET_COMMAS_OR_SPACES);\r\n        if (pos >= attributeValue.length) {\r\n            break;\r\n        }\r\n        var url = collectCharacters(SRCSET_NOT_SPACES);\r\n        if (url.slice(-1) === ',') {\r\n            url = absoluteToDoc(doc, url.substring(0, url.length - 1));\r\n            output.push(url);\r\n        }\r\n        else {\r\n            var descriptorsStr = '';\r\n            url = absoluteToDoc(doc, url);\r\n            var inParens = false;\r\n            while (true) {\r\n                var c = attributeValue.charAt(pos);\r\n                if (c === '') {\r\n                    output.push((url + descriptorsStr).trim());\r\n                    break;\r\n                }\r\n                else if (!inParens) {\r\n                    if (c === ',') {\r\n                        pos += 1;\r\n                        output.push((url + descriptorsStr).trim());\r\n                        break;\r\n                    }\r\n                    else if (c === '(') {\r\n                        inParens = true;\r\n                    }\r\n                }\r\n                else {\r\n                    if (c === ')') {\r\n                        inParens = false;\r\n                    }\r\n                }\r\n                descriptorsStr += c;\r\n                pos += 1;\r\n            }\r\n        }\r\n    }\r\n    return output.join(', ');\r\n}\r\nfunction absoluteToDoc(doc, attributeValue) {\r\n    if (!attributeValue || attributeValue.trim() === '') {\r\n        return attributeValue;\r\n    }\r\n    var a = doc.createElement('a');\r\n    a.href = attributeValue;\r\n    return a.href;\r\n}\r\nfunction isSVGElement(el) {\r\n    return Boolean(el.tagName === 'svg' || el.ownerSVGElement);\r\n}\r\nfunction getHref() {\r\n    var a = document.createElement('a');\r\n    a.href = '';\r\n    return a.href;\r\n}\r\nfunction transformAttribute(doc, tagName, name, value) {\r\n    if (name === 'src' ||\r\n        (name === 'href' && value && !(tagName === 'use' && value[0] === '#'))) {\r\n        return absoluteToDoc(doc, value);\r\n    }\r\n    else if (name === 'xlink:href' && value && value[0] !== '#') {\r\n        return absoluteToDoc(doc, value);\r\n    }\r\n    else if (name === 'background' &&\r\n        value &&\r\n        (tagName === 'table' || tagName === 'td' || tagName === 'th')) {\r\n        return absoluteToDoc(doc, value);\r\n    }\r\n    else if (name === 'srcset' && value) {\r\n        return getAbsoluteSrcsetString(doc, value);\r\n    }\r\n    else if (name === 'style' && value) {\r\n        return absoluteToStylesheet(value, getHref());\r\n    }\r\n    else if (tagName === 'object' && name === 'data' && value) {\r\n        return absoluteToDoc(doc, value);\r\n    }\r\n    else {\r\n        return value;\r\n    }\r\n}\r\nfunction _isBlockedElement(element, blockClass, blockSelector) {\r\n    if (typeof blockClass === 'string') {\r\n        if (element.classList.contains(blockClass)) {\r\n            return true;\r\n        }\r\n    }\r\n    else {\r\n        for (var eIndex = element.classList.length; eIndex--;) {\r\n            var className = element.classList[eIndex];\r\n            if (blockClass.test(className)) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    if (blockSelector) {\r\n        return element.matches(blockSelector);\r\n    }\r\n    return false;\r\n}\r\nfunction classMatchesRegex(node, regex, checkAncestors) {\r\n    if (!node)\r\n        return false;\r\n    if (node.nodeType !== node.ELEMENT_NODE) {\r\n        if (!checkAncestors)\r\n            return false;\r\n        return classMatchesRegex(node.parentNode, regex, checkAncestors);\r\n    }\r\n    for (var eIndex = node.classList.length; eIndex--;) {\r\n        var className = node.classList[eIndex];\r\n        if (regex.test(className)) {\r\n            return true;\r\n        }\r\n    }\r\n    if (!checkAncestors)\r\n        return false;\r\n    return classMatchesRegex(node.parentNode, regex, checkAncestors);\r\n}\r\nfunction needMaskingText(node, maskTextClass, maskTextSelector) {\r\n    var el = node.nodeType === node.ELEMENT_NODE\r\n        ? node\r\n        : node.parentElement;\r\n    if (el === null)\r\n        return false;\r\n    if (typeof maskTextClass === 'string') {\r\n        if (el.classList.contains(maskTextClass))\r\n            return true;\r\n        if (el.closest(\".\".concat(maskTextClass)))\r\n            return true;\r\n    }\r\n    else {\r\n        if (classMatchesRegex(el, maskTextClass, true))\r\n            return true;\r\n    }\r\n    if (maskTextSelector) {\r\n        if (el.matches(maskTextSelector))\r\n            return true;\r\n        if (el.closest(maskTextSelector))\r\n            return true;\r\n    }\r\n    return false;\r\n}\r\nfunction onceIframeLoaded(iframeEl, listener, iframeLoadTimeout) {\r\n    var win = iframeEl.contentWindow;\r\n    if (!win) {\r\n        return;\r\n    }\r\n    var fired = false;\r\n    var readyState;\r\n    try {\r\n        readyState = win.document.readyState;\r\n    }\r\n    catch (error) {\r\n        return;\r\n    }\r\n    if (readyState !== 'complete') {\r\n        var timer_1 = setTimeout(function () {\r\n            if (!fired) {\r\n                listener();\r\n                fired = true;\r\n            }\r\n        }, iframeLoadTimeout);\r\n        iframeEl.addEventListener('load', function () {\r\n            clearTimeout(timer_1);\r\n            fired = true;\r\n            listener();\r\n        });\r\n        return;\r\n    }\r\n    var blankUrl = 'about:blank';\r\n    if (win.location.href !== blankUrl ||\r\n        iframeEl.src === blankUrl ||\r\n        iframeEl.src === '') {\r\n        setTimeout(listener, 0);\r\n        return iframeEl.addEventListener('load', listener);\r\n    }\r\n    iframeEl.addEventListener('load', listener);\r\n}\r\nfunction onceStylesheetLoaded(link, listener, styleSheetLoadTimeout) {\r\n    var fired = false;\r\n    var styleSheetLoaded;\r\n    try {\r\n        styleSheetLoaded = link.sheet;\r\n    }\r\n    catch (error) {\r\n        return;\r\n    }\r\n    if (styleSheetLoaded)\r\n        return;\r\n    var timer = setTimeout(function () {\r\n        if (!fired) {\r\n            listener();\r\n            fired = true;\r\n        }\r\n    }, styleSheetLoadTimeout);\r\n    link.addEventListener('load', function () {\r\n        clearTimeout(timer);\r\n        fired = true;\r\n        listener();\r\n    });\r\n}\r\nfunction serializeNode(n, options) {\r\n    var doc = options.doc, mirror = options.mirror, blockClass = options.blockClass, blockSelector = options.blockSelector, maskTextClass = options.maskTextClass, maskTextSelector = options.maskTextSelector, inlineStylesheet = options.inlineStylesheet, _a = options.maskInputOptions, maskInputOptions = _a === void 0 ? {} : _a, maskTextFn = options.maskTextFn, maskInputFn = options.maskInputFn, _b = options.dataURLOptions, dataURLOptions = _b === void 0 ? {} : _b, inlineImages = options.inlineImages, recordCanvas = options.recordCanvas, keepIframeSrcFn = options.keepIframeSrcFn, _c = options.newlyAddedElement, newlyAddedElement = _c === void 0 ? false : _c;\r\n    var rootId = getRootId(doc, mirror);\r\n    switch (n.nodeType) {\r\n        case n.DOCUMENT_NODE:\r\n            if (n.compatMode !== 'CSS1Compat') {\r\n                return {\r\n                    type: NodeType.Document,\r\n                    childNodes: [],\r\n                    compatMode: n.compatMode\r\n                };\r\n            }\r\n            else {\r\n                return {\r\n                    type: NodeType.Document,\r\n                    childNodes: []\r\n                };\r\n            }\r\n        case n.DOCUMENT_TYPE_NODE:\r\n            return {\r\n                type: NodeType.DocumentType,\r\n                name: n.name,\r\n                publicId: n.publicId,\r\n                systemId: n.systemId,\r\n                rootId: rootId\r\n            };\r\n        case n.ELEMENT_NODE:\r\n            return serializeElementNode(n, {\r\n                doc: doc,\r\n                blockClass: blockClass,\r\n                blockSelector: blockSelector,\r\n                inlineStylesheet: inlineStylesheet,\r\n                maskInputOptions: maskInputOptions,\r\n                maskInputFn: maskInputFn,\r\n                dataURLOptions: dataURLOptions,\r\n                inlineImages: inlineImages,\r\n                recordCanvas: recordCanvas,\r\n                keepIframeSrcFn: keepIframeSrcFn,\r\n                newlyAddedElement: newlyAddedElement,\r\n                rootId: rootId\r\n            });\r\n        case n.TEXT_NODE:\r\n            return serializeTextNode(n, {\r\n                maskTextClass: maskTextClass,\r\n                maskTextSelector: maskTextSelector,\r\n                maskTextFn: maskTextFn,\r\n                rootId: rootId\r\n            });\r\n        case n.CDATA_SECTION_NODE:\r\n            return {\r\n                type: NodeType.CDATA,\r\n                textContent: '',\r\n                rootId: rootId\r\n            };\r\n        case n.COMMENT_NODE:\r\n            return {\r\n                type: NodeType.Comment,\r\n                textContent: n.textContent || '',\r\n                rootId: rootId\r\n            };\r\n        default:\r\n            return false;\r\n    }\r\n}\r\nfunction getRootId(doc, mirror) {\r\n    if (!mirror.hasNode(doc))\r\n        return undefined;\r\n    var docId = mirror.getId(doc);\r\n    return docId === 1 ? undefined : docId;\r\n}\r\nfunction serializeTextNode(n, options) {\r\n    var _a;\r\n    var maskTextClass = options.maskTextClass, maskTextSelector = options.maskTextSelector, maskTextFn = options.maskTextFn, rootId = options.rootId;\r\n    var parentTagName = n.parentNode && n.parentNode.tagName;\r\n    var textContent = n.textContent;\r\n    var isStyle = parentTagName === 'STYLE' ? true : undefined;\r\n    var isScript = parentTagName === 'SCRIPT' ? true : undefined;\r\n    if (isStyle && textContent) {\r\n        try {\r\n            if (n.nextSibling || n.previousSibling) {\r\n            }\r\n            else if ((_a = n.parentNode.sheet) === null || _a === void 0 ? void 0 : _a.cssRules) {\r\n                textContent = stringifyStyleSheet(n.parentNode.sheet);\r\n            }\r\n        }\r\n        catch (err) {\r\n            console.warn(\"Cannot get CSS styles from text's parentNode. Error: \".concat(err), n);\r\n        }\r\n        textContent = absoluteToStylesheet(textContent, getHref());\r\n    }\r\n    if (isScript) {\r\n        textContent = 'SCRIPT_PLACEHOLDER';\r\n    }\r\n    if (!isStyle &&\r\n        !isScript &&\r\n        textContent &&\r\n        needMaskingText(n, maskTextClass, maskTextSelector)) {\r\n        textContent = maskTextFn\r\n            ? maskTextFn(textContent)\r\n            : textContent.replace(/[\\S]/g, '*');\r\n    }\r\n    return {\r\n        type: NodeType.Text,\r\n        textContent: textContent || '',\r\n        isStyle: isStyle,\r\n        rootId: rootId\r\n    };\r\n}\r\nfunction serializeElementNode(n, options) {\r\n    var doc = options.doc, blockClass = options.blockClass, blockSelector = options.blockSelector, inlineStylesheet = options.inlineStylesheet, _a = options.maskInputOptions, maskInputOptions = _a === void 0 ? {} : _a, maskInputFn = options.maskInputFn, _b = options.dataURLOptions, dataURLOptions = _b === void 0 ? {} : _b, inlineImages = options.inlineImages, recordCanvas = options.recordCanvas, keepIframeSrcFn = options.keepIframeSrcFn, _c = options.newlyAddedElement, newlyAddedElement = _c === void 0 ? false : _c, rootId = options.rootId;\r\n    var needBlock = _isBlockedElement(n, blockClass, blockSelector);\r\n    var tagName = getValidTagName(n);\r\n    var attributes = {};\r\n    var len = n.attributes.length;\r\n    for (var i = 0; i < len; i++) {\r\n        var attr = n.attributes[i];\r\n        attributes[attr.name] = transformAttribute(doc, tagName, attr.name, attr.value);\r\n    }\r\n    if (tagName === 'link' && inlineStylesheet) {\r\n        var stylesheet = Array.from(doc.styleSheets).find(function (s) {\r\n            return s.href === n.href;\r\n        });\r\n        var cssText = null;\r\n        if (stylesheet) {\r\n            cssText = getCssRulesString(stylesheet);\r\n        }\r\n        if (cssText) {\r\n            delete attributes.rel;\r\n            delete attributes.href;\r\n            attributes._cssText = absoluteToStylesheet(cssText, stylesheet.href);\r\n        }\r\n    }\r\n    if (tagName === 'style' &&\r\n        n.sheet &&\r\n        !(n.innerText || n.textContent || '').trim().length) {\r\n        var cssText = getCssRulesString(n.sheet);\r\n        if (cssText) {\r\n            attributes._cssText = absoluteToStylesheet(cssText, getHref());\r\n        }\r\n    }\r\n    if (tagName === 'input' || tagName === 'textarea' || tagName === 'select') {\r\n        var value = n.value;\r\n        var checked = n.checked;\r\n        if (attributes.type !== 'radio' &&\r\n            attributes.type !== 'checkbox' &&\r\n            attributes.type !== 'submit' &&\r\n            attributes.type !== 'button' &&\r\n            value) {\r\n            attributes.value = maskInputValue({\r\n                type: attributes.type,\r\n                tagName: tagName,\r\n                value: value,\r\n                maskInputOptions: maskInputOptions,\r\n                maskInputFn: maskInputFn\r\n            });\r\n        }\r\n        else if (checked) {\r\n            attributes.checked = checked;\r\n        }\r\n    }\r\n    if (tagName === 'option') {\r\n        if (n.selected && !maskInputOptions['select']) {\r\n            attributes.selected = true;\r\n        }\r\n        else {\r\n            delete attributes.selected;\r\n        }\r\n    }\r\n    if (tagName === 'canvas' && recordCanvas) {\r\n        if (n.__context === '2d') {\r\n            if (!is2DCanvasBlank(n)) {\r\n                attributes.rr_dataURL = n.toDataURL(dataURLOptions.type, dataURLOptions.quality);\r\n            }\r\n        }\r\n        else if (!('__context' in n)) {\r\n            var canvasDataURL = n.toDataURL(dataURLOptions.type, dataURLOptions.quality);\r\n            var blankCanvas = document.createElement('canvas');\r\n            blankCanvas.width = n.width;\r\n            blankCanvas.height = n.height;\r\n            var blankCanvasDataURL = blankCanvas.toDataURL(dataURLOptions.type, dataURLOptions.quality);\r\n            if (canvasDataURL !== blankCanvasDataURL) {\r\n                attributes.rr_dataURL = canvasDataURL;\r\n            }\r\n        }\r\n    }\r\n    if (tagName === 'img' && inlineImages) {\r\n        if (!canvasService) {\r\n            canvasService = doc.createElement('canvas');\r\n            canvasCtx = canvasService.getContext('2d');\r\n        }\r\n        var image_1 = n;\r\n        var oldValue_1 = image_1.crossOrigin;\r\n        image_1.crossOrigin = 'anonymous';\r\n        var recordInlineImage = function () {\r\n            try {\r\n                canvasService.width = image_1.naturalWidth;\r\n                canvasService.height = image_1.naturalHeight;\r\n                canvasCtx.drawImage(image_1, 0, 0);\r\n                attributes.rr_dataURL = canvasService.toDataURL(dataURLOptions.type, dataURLOptions.quality);\r\n            }\r\n            catch (err) {\r\n                console.warn(\"Cannot inline img src=\".concat(image_1.currentSrc, \"! Error: \").concat(err));\r\n            }\r\n            oldValue_1\r\n                ? (attributes.crossOrigin = oldValue_1)\r\n                : image_1.removeAttribute('crossorigin');\r\n        };\r\n        if (image_1.complete && image_1.naturalWidth !== 0)\r\n            recordInlineImage();\r\n        else\r\n            image_1.onload = recordInlineImage;\r\n    }\r\n    if (tagName === 'audio' || tagName === 'video') {\r\n        attributes.rr_mediaState = n.paused\r\n            ? 'paused'\r\n            : 'played';\r\n        attributes.rr_mediaCurrentTime = n.currentTime;\r\n    }\r\n    if (!newlyAddedElement) {\r\n        if (n.scrollLeft) {\r\n            attributes.rr_scrollLeft = n.scrollLeft;\r\n        }\r\n        if (n.scrollTop) {\r\n            attributes.rr_scrollTop = n.scrollTop;\r\n        }\r\n    }\r\n    if (needBlock) {\r\n        var _d = n.getBoundingClientRect(), width = _d.width, height = _d.height;\r\n        attributes = {\r\n            \"class\": attributes[\"class\"],\r\n            rr_width: \"\".concat(width, \"px\"),\r\n            rr_height: \"\".concat(height, \"px\")\r\n        };\r\n    }\r\n    if (tagName === 'iframe' && !keepIframeSrcFn(attributes.src)) {\r\n        if (!n.contentDocument) {\r\n            attributes.rr_src = attributes.src;\r\n        }\r\n        delete attributes.src;\r\n    }\r\n    return {\r\n        type: NodeType.Element,\r\n        tagName: tagName,\r\n        attributes: attributes,\r\n        childNodes: [],\r\n        isSVG: isSVGElement(n) || undefined,\r\n        needBlock: needBlock,\r\n        rootId: rootId\r\n    };\r\n}\r\nfunction lowerIfExists(maybeAttr) {\r\n    if (maybeAttr === undefined) {\r\n        return '';\r\n    }\r\n    else {\r\n        return maybeAttr.toLowerCase();\r\n    }\r\n}\r\nfunction slimDOMExcluded(sn, slimDOMOptions) {\r\n    if (slimDOMOptions.comment && sn.type === NodeType.Comment) {\r\n        return true;\r\n    }\r\n    else if (sn.type === NodeType.Element) {\r\n        if (slimDOMOptions.script &&\r\n            (sn.tagName === 'script' ||\r\n                (sn.tagName === 'link' &&\r\n                    sn.attributes.rel === 'preload' &&\r\n                    sn.attributes.as === 'script') ||\r\n                (sn.tagName === 'link' &&\r\n                    sn.attributes.rel === 'prefetch' &&\r\n                    typeof sn.attributes.href === 'string' &&\r\n                    sn.attributes.href.endsWith('.js')))) {\r\n            return true;\r\n        }\r\n        else if (slimDOMOptions.headFavicon &&\r\n            ((sn.tagName === 'link' && sn.attributes.rel === 'shortcut icon') ||\r\n                (sn.tagName === 'meta' &&\r\n                    (lowerIfExists(sn.attributes.name).match(/^msapplication-tile(image|color)$/) ||\r\n                        lowerIfExists(sn.attributes.name) === 'application-name' ||\r\n                        lowerIfExists(sn.attributes.rel) === 'icon' ||\r\n                        lowerIfExists(sn.attributes.rel) === 'apple-touch-icon' ||\r\n                        lowerIfExists(sn.attributes.rel) === 'shortcut icon')))) {\r\n            return true;\r\n        }\r\n        else if (sn.tagName === 'meta') {\r\n            if (slimDOMOptions.headMetaDescKeywords &&\r\n                lowerIfExists(sn.attributes.name).match(/^description|keywords$/)) {\r\n                return true;\r\n            }\r\n            else if (slimDOMOptions.headMetaSocial &&\r\n                (lowerIfExists(sn.attributes.property).match(/^(og|twitter|fb):/) ||\r\n                    lowerIfExists(sn.attributes.name).match(/^(og|twitter):/) ||\r\n                    lowerIfExists(sn.attributes.name) === 'pinterest')) {\r\n                return true;\r\n            }\r\n            else if (slimDOMOptions.headMetaRobots &&\r\n                (lowerIfExists(sn.attributes.name) === 'robots' ||\r\n                    lowerIfExists(sn.attributes.name) === 'googlebot' ||\r\n                    lowerIfExists(sn.attributes.name) === 'bingbot')) {\r\n                return true;\r\n            }\r\n            else if (slimDOMOptions.headMetaHttpEquiv &&\r\n                sn.attributes['http-equiv'] !== undefined) {\r\n                return true;\r\n            }\r\n            else if (slimDOMOptions.headMetaAuthorship &&\r\n                (lowerIfExists(sn.attributes.name) === 'author' ||\r\n                    lowerIfExists(sn.attributes.name) === 'generator' ||\r\n                    lowerIfExists(sn.attributes.name) === 'framework' ||\r\n                    lowerIfExists(sn.attributes.name) === 'publisher' ||\r\n                    lowerIfExists(sn.attributes.name) === 'progid' ||\r\n                    lowerIfExists(sn.attributes.property).match(/^article:/) ||\r\n                    lowerIfExists(sn.attributes.property).match(/^product:/))) {\r\n                return true;\r\n            }\r\n            else if (slimDOMOptions.headMetaVerification &&\r\n                (lowerIfExists(sn.attributes.name) === 'google-site-verification' ||\r\n                    lowerIfExists(sn.attributes.name) === 'yandex-verification' ||\r\n                    lowerIfExists(sn.attributes.name) === 'csrf-token' ||\r\n                    lowerIfExists(sn.attributes.name) === 'p:domain_verify' ||\r\n                    lowerIfExists(sn.attributes.name) === 'verify-v1' ||\r\n                    lowerIfExists(sn.attributes.name) === 'verification' ||\r\n                    lowerIfExists(sn.attributes.name) === 'shopify-checkout-api-token')) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return false;\r\n}\r\nfunction serializeNodeWithId(n, options) {\r\n    var doc = options.doc, mirror = options.mirror, blockClass = options.blockClass, blockSelector = options.blockSelector, maskTextClass = options.maskTextClass, maskTextSelector = options.maskTextSelector, _a = options.skipChild, skipChild = _a === void 0 ? false : _a, _b = options.inlineStylesheet, inlineStylesheet = _b === void 0 ? true : _b, _c = options.maskInputOptions, maskInputOptions = _c === void 0 ? {} : _c, maskTextFn = options.maskTextFn, maskInputFn = options.maskInputFn, slimDOMOptions = options.slimDOMOptions, _d = options.dataURLOptions, dataURLOptions = _d === void 0 ? {} : _d, _e = options.inlineImages, inlineImages = _e === void 0 ? false : _e, _f = options.recordCanvas, recordCanvas = _f === void 0 ? false : _f, onSerialize = options.onSerialize, onIframeLoad = options.onIframeLoad, _g = options.iframeLoadTimeout, iframeLoadTimeout = _g === void 0 ? 5000 : _g, onStylesheetLoad = options.onStylesheetLoad, _h = options.stylesheetLoadTimeout, stylesheetLoadTimeout = _h === void 0 ? 5000 : _h, _j = options.keepIframeSrcFn, keepIframeSrcFn = _j === void 0 ? function () { return false; } : _j, _k = options.newlyAddedElement, newlyAddedElement = _k === void 0 ? false : _k;\r\n    var _l = options.preserveWhiteSpace, preserveWhiteSpace = _l === void 0 ? true : _l;\r\n    var _serializedNode = serializeNode(n, {\r\n        doc: doc,\r\n        mirror: mirror,\r\n        blockClass: blockClass,\r\n        blockSelector: blockSelector,\r\n        maskTextClass: maskTextClass,\r\n        maskTextSelector: maskTextSelector,\r\n        inlineStylesheet: inlineStylesheet,\r\n        maskInputOptions: maskInputOptions,\r\n        maskTextFn: maskTextFn,\r\n        maskInputFn: maskInputFn,\r\n        dataURLOptions: dataURLOptions,\r\n        inlineImages: inlineImages,\r\n        recordCanvas: recordCanvas,\r\n        keepIframeSrcFn: keepIframeSrcFn,\r\n        newlyAddedElement: newlyAddedElement\r\n    });\r\n    if (!_serializedNode) {\r\n        console.warn(n, 'not serialized');\r\n        return null;\r\n    }\r\n    var id;\r\n    if (mirror.hasNode(n)) {\r\n        id = mirror.getId(n);\r\n    }\r\n    else if (slimDOMExcluded(_serializedNode, slimDOMOptions) ||\r\n        (!preserveWhiteSpace &&\r\n            _serializedNode.type === NodeType.Text &&\r\n            !_serializedNode.isStyle &&\r\n            !_serializedNode.textContent.replace(/^\\s+|\\s+$/gm, '').length)) {\r\n        id = IGNORED_NODE;\r\n    }\r\n    else {\r\n        id = genId();\r\n    }\r\n    var serializedNode = Object.assign(_serializedNode, { id: id });\r\n    mirror.add(n, serializedNode);\r\n    if (id === IGNORED_NODE) {\r\n        return null;\r\n    }\r\n    if (onSerialize) {\r\n        onSerialize(n);\r\n    }\r\n    var recordChild = !skipChild;\r\n    if (serializedNode.type === NodeType.Element) {\r\n        recordChild = recordChild && !serializedNode.needBlock;\r\n        delete serializedNode.needBlock;\r\n        var shadowRoot = n.shadowRoot;\r\n        if (shadowRoot && isNativeShadowDom(shadowRoot))\r\n            serializedNode.isShadowHost = true;\r\n    }\r\n    if ((serializedNode.type === NodeType.Document ||\r\n        serializedNode.type === NodeType.Element) &&\r\n        recordChild) {\r\n        if (slimDOMOptions.headWhitespace &&\r\n            serializedNode.type === NodeType.Element &&\r\n            serializedNode.tagName === 'head') {\r\n            preserveWhiteSpace = false;\r\n        }\r\n        var bypassOptions = {\r\n            doc: doc,\r\n            mirror: mirror,\r\n            blockClass: blockClass,\r\n            blockSelector: blockSelector,\r\n            maskTextClass: maskTextClass,\r\n            maskTextSelector: maskTextSelector,\r\n            skipChild: skipChild,\r\n            inlineStylesheet: inlineStylesheet,\r\n            maskInputOptions: maskInputOptions,\r\n            maskTextFn: maskTextFn,\r\n            maskInputFn: maskInputFn,\r\n            slimDOMOptions: slimDOMOptions,\r\n            dataURLOptions: dataURLOptions,\r\n            inlineImages: inlineImages,\r\n            recordCanvas: recordCanvas,\r\n            preserveWhiteSpace: preserveWhiteSpace,\r\n            onSerialize: onSerialize,\r\n            onIframeLoad: onIframeLoad,\r\n            iframeLoadTimeout: iframeLoadTimeout,\r\n            onStylesheetLoad: onStylesheetLoad,\r\n            stylesheetLoadTimeout: stylesheetLoadTimeout,\r\n            keepIframeSrcFn: keepIframeSrcFn\r\n        };\r\n        for (var _i = 0, _m = Array.from(n.childNodes); _i < _m.length; _i++) {\r\n            var childN = _m[_i];\r\n            var serializedChildNode = serializeNodeWithId(childN, bypassOptions);\r\n            if (serializedChildNode) {\r\n                serializedNode.childNodes.push(serializedChildNode);\r\n            }\r\n        }\r\n        if (isElement(n) && n.shadowRoot) {\r\n            for (var _o = 0, _p = Array.from(n.shadowRoot.childNodes); _o < _p.length; _o++) {\r\n                var childN = _p[_o];\r\n                var serializedChildNode = serializeNodeWithId(childN, bypassOptions);\r\n                if (serializedChildNode) {\r\n                    isNativeShadowDom(n.shadowRoot) &&\r\n                        (serializedChildNode.isShadow = true);\r\n                    serializedNode.childNodes.push(serializedChildNode);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (n.parentNode &&\r\n        isShadowRoot(n.parentNode) &&\r\n        isNativeShadowDom(n.parentNode)) {\r\n        serializedNode.isShadow = true;\r\n    }\r\n    if (serializedNode.type === NodeType.Element &&\r\n        serializedNode.tagName === 'iframe') {\r\n        onceIframeLoaded(n, function () {\r\n            var iframeDoc = n.contentDocument;\r\n            if (iframeDoc && onIframeLoad) {\r\n                var serializedIframeNode = serializeNodeWithId(iframeDoc, {\r\n                    doc: iframeDoc,\r\n                    mirror: mirror,\r\n                    blockClass: blockClass,\r\n                    blockSelector: blockSelector,\r\n                    maskTextClass: maskTextClass,\r\n                    maskTextSelector: maskTextSelector,\r\n                    skipChild: false,\r\n                    inlineStylesheet: inlineStylesheet,\r\n                    maskInputOptions: maskInputOptions,\r\n                    maskTextFn: maskTextFn,\r\n                    maskInputFn: maskInputFn,\r\n                    slimDOMOptions: slimDOMOptions,\r\n                    dataURLOptions: dataURLOptions,\r\n                    inlineImages: inlineImages,\r\n                    recordCanvas: recordCanvas,\r\n                    preserveWhiteSpace: preserveWhiteSpace,\r\n                    onSerialize: onSerialize,\r\n                    onIframeLoad: onIframeLoad,\r\n                    iframeLoadTimeout: iframeLoadTimeout,\r\n                    onStylesheetLoad: onStylesheetLoad,\r\n                    stylesheetLoadTimeout: stylesheetLoadTimeout,\r\n                    keepIframeSrcFn: keepIframeSrcFn\r\n                });\r\n                if (serializedIframeNode) {\r\n                    onIframeLoad(n, serializedIframeNode);\r\n                }\r\n            }\r\n        }, iframeLoadTimeout);\r\n    }\r\n    if (serializedNode.type === NodeType.Element &&\r\n        serializedNode.tagName === 'link' &&\r\n        serializedNode.attributes.rel === 'stylesheet') {\r\n        onceStylesheetLoaded(n, function () {\r\n            if (onStylesheetLoad) {\r\n                var serializedLinkNode = serializeNodeWithId(n, {\r\n                    doc: doc,\r\n                    mirror: mirror,\r\n                    blockClass: blockClass,\r\n                    blockSelector: blockSelector,\r\n                    maskTextClass: maskTextClass,\r\n                    maskTextSelector: maskTextSelector,\r\n                    skipChild: false,\r\n                    inlineStylesheet: inlineStylesheet,\r\n                    maskInputOptions: maskInputOptions,\r\n                    maskTextFn: maskTextFn,\r\n                    maskInputFn: maskInputFn,\r\n                    slimDOMOptions: slimDOMOptions,\r\n                    dataURLOptions: dataURLOptions,\r\n                    inlineImages: inlineImages,\r\n                    recordCanvas: recordCanvas,\r\n                    preserveWhiteSpace: preserveWhiteSpace,\r\n                    onSerialize: onSerialize,\r\n                    onIframeLoad: onIframeLoad,\r\n                    iframeLoadTimeout: iframeLoadTimeout,\r\n                    onStylesheetLoad: onStylesheetLoad,\r\n                    stylesheetLoadTimeout: stylesheetLoadTimeout,\r\n                    keepIframeSrcFn: keepIframeSrcFn\r\n                });\r\n                if (serializedLinkNode) {\r\n                    onStylesheetLoad(n, serializedLinkNode);\r\n                }\r\n            }\r\n        }, stylesheetLoadTimeout);\r\n    }\r\n    return serializedNode;\r\n}\r\nfunction snapshot(n, options) {\r\n    var _a = options || {}, _b = _a.mirror, mirror = _b === void 0 ? new Mirror() : _b, _c = _a.blockClass, blockClass = _c === void 0 ? 'rr-block' : _c, _d = _a.blockSelector, blockSelector = _d === void 0 ? null : _d, _e = _a.maskTextClass, maskTextClass = _e === void 0 ? 'rr-mask' : _e, _f = _a.maskTextSelector, maskTextSelector = _f === void 0 ? null : _f, _g = _a.inlineStylesheet, inlineStylesheet = _g === void 0 ? true : _g, _h = _a.inlineImages, inlineImages = _h === void 0 ? false : _h, _j = _a.recordCanvas, recordCanvas = _j === void 0 ? false : _j, _k = _a.maskAllInputs, maskAllInputs = _k === void 0 ? false : _k, maskTextFn = _a.maskTextFn, maskInputFn = _a.maskInputFn, _l = _a.slimDOM, slimDOM = _l === void 0 ? false : _l, dataURLOptions = _a.dataURLOptions, preserveWhiteSpace = _a.preserveWhiteSpace, onSerialize = _a.onSerialize, onIframeLoad = _a.onIframeLoad, iframeLoadTimeout = _a.iframeLoadTimeout, onStylesheetLoad = _a.onStylesheetLoad, stylesheetLoadTimeout = _a.stylesheetLoadTimeout, _m = _a.keepIframeSrcFn, keepIframeSrcFn = _m === void 0 ? function () { return false; } : _m;\r\n    var maskInputOptions = maskAllInputs === true\r\n        ? {\r\n            color: true,\r\n            date: true,\r\n            'datetime-local': true,\r\n            email: true,\r\n            month: true,\r\n            number: true,\r\n            range: true,\r\n            search: true,\r\n            tel: true,\r\n            text: true,\r\n            time: true,\r\n            url: true,\r\n            week: true,\r\n            textarea: true,\r\n            select: true,\r\n            password: true\r\n        }\r\n        : maskAllInputs === false\r\n            ? {\r\n                password: true\r\n            }\r\n            : maskAllInputs;\r\n    var slimDOMOptions = slimDOM === true || slimDOM === 'all'\r\n        ?\r\n            {\r\n                script: true,\r\n                comment: true,\r\n                headFavicon: true,\r\n                headWhitespace: true,\r\n                headMetaDescKeywords: slimDOM === 'all',\r\n                headMetaSocial: true,\r\n                headMetaRobots: true,\r\n                headMetaHttpEquiv: true,\r\n                headMetaAuthorship: true,\r\n                headMetaVerification: true\r\n            }\r\n        : slimDOM === false\r\n            ? {}\r\n            : slimDOM;\r\n    return serializeNodeWithId(n, {\r\n        doc: n,\r\n        mirror: mirror,\r\n        blockClass: blockClass,\r\n        blockSelector: blockSelector,\r\n        maskTextClass: maskTextClass,\r\n        maskTextSelector: maskTextSelector,\r\n        skipChild: false,\r\n        inlineStylesheet: inlineStylesheet,\r\n        maskInputOptions: maskInputOptions,\r\n        maskTextFn: maskTextFn,\r\n        maskInputFn: maskInputFn,\r\n        slimDOMOptions: slimDOMOptions,\r\n        dataURLOptions: dataURLOptions,\r\n        inlineImages: inlineImages,\r\n        recordCanvas: recordCanvas,\r\n        preserveWhiteSpace: preserveWhiteSpace,\r\n        onSerialize: onSerialize,\r\n        onIframeLoad: onIframeLoad,\r\n        iframeLoadTimeout: iframeLoadTimeout,\r\n        onStylesheetLoad: onStylesheetLoad,\r\n        stylesheetLoadTimeout: stylesheetLoadTimeout,\r\n        keepIframeSrcFn: keepIframeSrcFn,\r\n        newlyAddedElement: false\r\n    });\r\n}\r\n\nvar commentre = /\\/\\*[^*]*\\*+([^/*][^*]*\\*+)*\\//g;\r\nfunction parse(css, options) {\r\n    if (options === void 0) { options = {}; }\r\n    var lineno = 1;\r\n    var column = 1;\r\n    function updatePosition(str) {\r\n        var lines = str.match(/\\n/g);\r\n        if (lines) {\r\n            lineno += lines.length;\r\n        }\r\n        var i = str.lastIndexOf('\\n');\r\n        column = i === -1 ? column + str.length : str.length - i;\r\n    }\r\n    function position() {\r\n        var start = { line: lineno, column: column };\r\n        return function (node) {\r\n            node.position = new Position(start);\r\n            whitespace();\r\n            return node;\r\n        };\r\n    }\r\n    var Position = (function () {\r\n        function Position(start) {\r\n            this.start = start;\r\n            this.end = { line: lineno, column: column };\r\n            this.source = options.source;\r\n        }\r\n        return Position;\r\n    }());\r\n    Position.prototype.content = css;\r\n    var errorsList = [];\r\n    function error(msg) {\r\n        var err = new Error(\"\".concat(options.source || '', \":\").concat(lineno, \":\").concat(column, \": \").concat(msg));\r\n        err.reason = msg;\r\n        err.filename = options.source;\r\n        err.line = lineno;\r\n        err.column = column;\r\n        err.source = css;\r\n        if (options.silent) {\r\n            errorsList.push(err);\r\n        }\r\n        else {\r\n            throw err;\r\n        }\r\n    }\r\n    function stylesheet() {\r\n        var rulesList = rules();\r\n        return {\r\n            type: 'stylesheet',\r\n            stylesheet: {\r\n                source: options.source,\r\n                rules: rulesList,\r\n                parsingErrors: errorsList\r\n            }\r\n        };\r\n    }\r\n    function open() {\r\n        return match(/^{\\s*/);\r\n    }\r\n    function close() {\r\n        return match(/^}/);\r\n    }\r\n    function rules() {\r\n        var node;\r\n        var rules = [];\r\n        whitespace();\r\n        comments(rules);\r\n        while (css.length && css.charAt(0) !== '}' && (node = atrule() || rule())) {\r\n            if (node !== false) {\r\n                rules.push(node);\r\n                comments(rules);\r\n            }\r\n        }\r\n        return rules;\r\n    }\r\n    function match(re) {\r\n        var m = re.exec(css);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        var str = m[0];\r\n        updatePosition(str);\r\n        css = css.slice(str.length);\r\n        return m;\r\n    }\r\n    function whitespace() {\r\n        match(/^\\s*/);\r\n    }\r\n    function comments(rules) {\r\n        if (rules === void 0) { rules = []; }\r\n        var c;\r\n        while ((c = comment())) {\r\n            if (c !== false) {\r\n                rules.push(c);\r\n            }\r\n            c = comment();\r\n        }\r\n        return rules;\r\n    }\r\n    function comment() {\r\n        var pos = position();\r\n        if ('/' !== css.charAt(0) || '*' !== css.charAt(1)) {\r\n            return;\r\n        }\r\n        var i = 2;\r\n        while ('' !== css.charAt(i) &&\r\n            ('*' !== css.charAt(i) || '/' !== css.charAt(i + 1))) {\r\n            ++i;\r\n        }\r\n        i += 2;\r\n        if ('' === css.charAt(i - 1)) {\r\n            return error('End of comment missing');\r\n        }\r\n        var str = css.slice(2, i - 2);\r\n        column += 2;\r\n        updatePosition(str);\r\n        css = css.slice(i);\r\n        column += 2;\r\n        return pos({\r\n            type: 'comment',\r\n            comment: str\r\n        });\r\n    }\r\n    function selector() {\r\n        var m = match(/^([^{]+)/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        return trim(m[0])\r\n            .replace(/\\/\\*([^*]|[\\r\\n]|(\\*+([^*/]|[\\r\\n])))*\\*\\/+/g, '')\r\n            .replace(/\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'/g, function (m) {\r\n            return m.replace(/,/g, '\\u200C');\r\n        })\r\n            .split(/\\s*(?![^(]*\\)),\\s*/)\r\n            .map(function (s) {\r\n            return s.replace(/\\u200C/g, ',');\r\n        });\r\n    }\r\n    function declaration() {\r\n        var pos = position();\r\n        var propMatch = match(/^(\\*?[-#\\/\\*\\\\\\w]+(\\[[0-9a-z_-]+\\])?)\\s*/);\r\n        if (!propMatch) {\r\n            return;\r\n        }\r\n        var prop = trim(propMatch[0]);\r\n        if (!match(/^:\\s*/)) {\r\n            return error(\"property missing ':'\");\r\n        }\r\n        var val = match(/^((?:'(?:\\\\'|.)*?'|\"(?:\\\\\"|.)*?\"|\\([^\\)]*?\\)|[^};])+)/);\r\n        var ret = pos({\r\n            type: 'declaration',\r\n            property: prop.replace(commentre, ''),\r\n            value: val ? trim(val[0]).replace(commentre, '') : ''\r\n        });\r\n        match(/^[;\\s]*/);\r\n        return ret;\r\n    }\r\n    function declarations() {\r\n        var decls = [];\r\n        if (!open()) {\r\n            return error(\"missing '{'\");\r\n        }\r\n        comments(decls);\r\n        var decl;\r\n        while ((decl = declaration())) {\r\n            if (decl !== false) {\r\n                decls.push(decl);\r\n                comments(decls);\r\n            }\r\n            decl = declaration();\r\n        }\r\n        if (!close()) {\r\n            return error(\"missing '}'\");\r\n        }\r\n        return decls;\r\n    }\r\n    function keyframe() {\r\n        var m;\r\n        var vals = [];\r\n        var pos = position();\r\n        while ((m = match(/^((\\d+\\.\\d+|\\.\\d+|\\d+)%?|[a-z]+)\\s*/))) {\r\n            vals.push(m[1]);\r\n            match(/^,\\s*/);\r\n        }\r\n        if (!vals.length) {\r\n            return;\r\n        }\r\n        return pos({\r\n            type: 'keyframe',\r\n            values: vals,\r\n            declarations: declarations()\r\n        });\r\n    }\r\n    function atkeyframes() {\r\n        var pos = position();\r\n        var m = match(/^@([-\\w]+)?keyframes\\s*/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        var vendor = m[1];\r\n        m = match(/^([-\\w]+)\\s*/);\r\n        if (!m) {\r\n            return error('@keyframes missing name');\r\n        }\r\n        var name = m[1];\r\n        if (!open()) {\r\n            return error(\"@keyframes missing '{'\");\r\n        }\r\n        var frame;\r\n        var frames = comments();\r\n        while ((frame = keyframe())) {\r\n            frames.push(frame);\r\n            frames = frames.concat(comments());\r\n        }\r\n        if (!close()) {\r\n            return error(\"@keyframes missing '}'\");\r\n        }\r\n        return pos({\r\n            type: 'keyframes',\r\n            name: name,\r\n            vendor: vendor,\r\n            keyframes: frames\r\n        });\r\n    }\r\n    function atsupports() {\r\n        var pos = position();\r\n        var m = match(/^@supports *([^{]+)/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        var supports = trim(m[1]);\r\n        if (!open()) {\r\n            return error(\"@supports missing '{'\");\r\n        }\r\n        var style = comments().concat(rules());\r\n        if (!close()) {\r\n            return error(\"@supports missing '}'\");\r\n        }\r\n        return pos({\r\n            type: 'supports',\r\n            supports: supports,\r\n            rules: style\r\n        });\r\n    }\r\n    function athost() {\r\n        var pos = position();\r\n        var m = match(/^@host\\s*/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        if (!open()) {\r\n            return error(\"@host missing '{'\");\r\n        }\r\n        var style = comments().concat(rules());\r\n        if (!close()) {\r\n            return error(\"@host missing '}'\");\r\n        }\r\n        return pos({\r\n            type: 'host',\r\n            rules: style\r\n        });\r\n    }\r\n    function atmedia() {\r\n        var pos = position();\r\n        var m = match(/^@media *([^{]+)/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        var media = trim(m[1]);\r\n        if (!open()) {\r\n            return error(\"@media missing '{'\");\r\n        }\r\n        var style = comments().concat(rules());\r\n        if (!close()) {\r\n            return error(\"@media missing '}'\");\r\n        }\r\n        return pos({\r\n            type: 'media',\r\n            media: media,\r\n            rules: style\r\n        });\r\n    }\r\n    function atcustommedia() {\r\n        var pos = position();\r\n        var m = match(/^@custom-media\\s+(--[^\\s]+)\\s*([^{;]+);/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        return pos({\r\n            type: 'custom-media',\r\n            name: trim(m[1]),\r\n            media: trim(m[2])\r\n        });\r\n    }\r\n    function atpage() {\r\n        var pos = position();\r\n        var m = match(/^@page */);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        var sel = selector() || [];\r\n        if (!open()) {\r\n            return error(\"@page missing '{'\");\r\n        }\r\n        var decls = comments();\r\n        var decl;\r\n        while ((decl = declaration())) {\r\n            decls.push(decl);\r\n            decls = decls.concat(comments());\r\n        }\r\n        if (!close()) {\r\n            return error(\"@page missing '}'\");\r\n        }\r\n        return pos({\r\n            type: 'page',\r\n            selectors: sel,\r\n            declarations: decls\r\n        });\r\n    }\r\n    function atdocument() {\r\n        var pos = position();\r\n        var m = match(/^@([-\\w]+)?document *([^{]+)/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        var vendor = trim(m[1]);\r\n        var doc = trim(m[2]);\r\n        if (!open()) {\r\n            return error(\"@document missing '{'\");\r\n        }\r\n        var style = comments().concat(rules());\r\n        if (!close()) {\r\n            return error(\"@document missing '}'\");\r\n        }\r\n        return pos({\r\n            type: 'document',\r\n            document: doc,\r\n            vendor: vendor,\r\n            rules: style\r\n        });\r\n    }\r\n    function atfontface() {\r\n        var pos = position();\r\n        var m = match(/^@font-face\\s*/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        if (!open()) {\r\n            return error(\"@font-face missing '{'\");\r\n        }\r\n        var decls = comments();\r\n        var decl;\r\n        while ((decl = declaration())) {\r\n            decls.push(decl);\r\n            decls = decls.concat(comments());\r\n        }\r\n        if (!close()) {\r\n            return error(\"@font-face missing '}'\");\r\n        }\r\n        return pos({\r\n            type: 'font-face',\r\n            declarations: decls\r\n        });\r\n    }\r\n    var atimport = _compileAtrule('import');\r\n    var atcharset = _compileAtrule('charset');\r\n    var atnamespace = _compileAtrule('namespace');\r\n    function _compileAtrule(name) {\r\n        var re = new RegExp('^@' + name + '\\\\s*([^;]+);');\r\n        return function () {\r\n            var pos = position();\r\n            var m = match(re);\r\n            if (!m) {\r\n                return;\r\n            }\r\n            var ret = { type: name };\r\n            ret[name] = m[1].trim();\r\n            return pos(ret);\r\n        };\r\n    }\r\n    function atrule() {\r\n        if (css[0] !== '@') {\r\n            return;\r\n        }\r\n        return (atkeyframes() ||\r\n            atmedia() ||\r\n            atcustommedia() ||\r\n            atsupports() ||\r\n            atimport() ||\r\n            atcharset() ||\r\n            atnamespace() ||\r\n            atdocument() ||\r\n            atpage() ||\r\n            athost() ||\r\n            atfontface());\r\n    }\r\n    function rule() {\r\n        var pos = position();\r\n        var sel = selector();\r\n        if (!sel) {\r\n            return error('selector missing');\r\n        }\r\n        comments();\r\n        return pos({\r\n            type: 'rule',\r\n            selectors: sel,\r\n            declarations: declarations()\r\n        });\r\n    }\r\n    return addParent(stylesheet());\r\n}\r\nfunction trim(str) {\r\n    return str ? str.replace(/^\\s+|\\s+$/g, '') : '';\r\n}\r\nfunction addParent(obj, parent) {\r\n    var isNode = obj && typeof obj.type === 'string';\r\n    var childParent = isNode ? obj : parent;\r\n    for (var _i = 0, _a = Object.keys(obj); _i < _a.length; _i++) {\r\n        var k = _a[_i];\r\n        var value = obj[k];\r\n        if (Array.isArray(value)) {\r\n            value.forEach(function (v) {\r\n                addParent(v, childParent);\r\n            });\r\n        }\r\n        else if (value && typeof value === 'object') {\r\n            addParent(value, childParent);\r\n        }\r\n    }\r\n    if (isNode) {\r\n        Object.defineProperty(obj, 'parent', {\r\n            configurable: true,\r\n            writable: true,\r\n            enumerable: false,\r\n            value: parent || null\r\n        });\r\n    }\r\n    return obj;\r\n}\n\nvar tagMap = {\r\n    script: 'noscript',\r\n    altglyph: 'altGlyph',\r\n    altglyphdef: 'altGlyphDef',\r\n    altglyphitem: 'altGlyphItem',\r\n    animatecolor: 'animateColor',\r\n    animatemotion: 'animateMotion',\r\n    animatetransform: 'animateTransform',\r\n    clippath: 'clipPath',\r\n    feblend: 'feBlend',\r\n    fecolormatrix: 'feColorMatrix',\r\n    fecomponenttransfer: 'feComponentTransfer',\r\n    fecomposite: 'feComposite',\r\n    feconvolvematrix: 'feConvolveMatrix',\r\n    fediffuselighting: 'feDiffuseLighting',\r\n    fedisplacementmap: 'feDisplacementMap',\r\n    fedistantlight: 'feDistantLight',\r\n    fedropshadow: 'feDropShadow',\r\n    feflood: 'feFlood',\r\n    fefunca: 'feFuncA',\r\n    fefuncb: 'feFuncB',\r\n    fefuncg: 'feFuncG',\r\n    fefuncr: 'feFuncR',\r\n    fegaussianblur: 'feGaussianBlur',\r\n    feimage: 'feImage',\r\n    femerge: 'feMerge',\r\n    femergenode: 'feMergeNode',\r\n    femorphology: 'feMorphology',\r\n    feoffset: 'feOffset',\r\n    fepointlight: 'fePointLight',\r\n    fespecularlighting: 'feSpecularLighting',\r\n    fespotlight: 'feSpotLight',\r\n    fetile: 'feTile',\r\n    feturbulence: 'feTurbulence',\r\n    foreignobject: 'foreignObject',\r\n    glyphref: 'glyphRef',\r\n    lineargradient: 'linearGradient',\r\n    radialgradient: 'radialGradient'\r\n};\r\nfunction getTagName(n) {\r\n    var tagName = tagMap[n.tagName] ? tagMap[n.tagName] : n.tagName;\r\n    if (tagName === 'link' && n.attributes._cssText) {\r\n        tagName = 'style';\r\n    }\r\n    return tagName;\r\n}\r\nfunction escapeRegExp(str) {\r\n    return str.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\r\n}\r\nvar HOVER_SELECTOR = /([^\\\\]):hover/;\r\nvar HOVER_SELECTOR_GLOBAL = new RegExp(HOVER_SELECTOR.source, 'g');\r\nfunction addHoverClass(cssText, cache) {\r\n    var cachedStyle = cache === null || cache === void 0 ? void 0 : cache.stylesWithHoverClass.get(cssText);\r\n    if (cachedStyle)\r\n        return cachedStyle;\r\n    var ast = parse(cssText, {\r\n        silent: true\r\n    });\r\n    if (!ast.stylesheet) {\r\n        return cssText;\r\n    }\r\n    var selectors = [];\r\n    ast.stylesheet.rules.forEach(function (rule) {\r\n        if ('selectors' in rule) {\r\n            (rule.selectors || []).forEach(function (selector) {\r\n                if (HOVER_SELECTOR.test(selector)) {\r\n                    selectors.push(selector);\r\n                }\r\n            });\r\n        }\r\n    });\r\n    if (selectors.length === 0) {\r\n        return cssText;\r\n    }\r\n    var selectorMatcher = new RegExp(selectors\r\n        .filter(function (selector, index) { return selectors.indexOf(selector) === index; })\r\n        .sort(function (a, b) { return b.length - a.length; })\r\n        .map(function (selector) {\r\n        return escapeRegExp(selector);\r\n    })\r\n        .join('|'), 'g');\r\n    var result = cssText.replace(selectorMatcher, function (selector) {\r\n        var newSelector = selector.replace(HOVER_SELECTOR_GLOBAL, '$1.\\\\:hover');\r\n        return \"\".concat(selector, \", \").concat(newSelector);\r\n    });\r\n    cache === null || cache === void 0 ? void 0 : cache.stylesWithHoverClass.set(cssText, result);\r\n    return result;\r\n}\r\nfunction createCache() {\r\n    var stylesWithHoverClass = new Map();\r\n    return {\r\n        stylesWithHoverClass: stylesWithHoverClass\r\n    };\r\n}\r\nfunction buildNode(n, options) {\r\n    var doc = options.doc, hackCss = options.hackCss, cache = options.cache;\r\n    switch (n.type) {\r\n        case NodeType.Document:\r\n            return doc.implementation.createDocument(null, '', null);\r\n        case NodeType.DocumentType:\r\n            return doc.implementation.createDocumentType(n.name || 'html', n.publicId, n.systemId);\r\n        case NodeType.Element: {\r\n            var tagName = getTagName(n);\r\n            var node_1;\r\n            if (n.isSVG) {\r\n                node_1 = doc.createElementNS('http://www.w3.org/2000/svg', tagName);\r\n            }\r\n            else {\r\n                node_1 = doc.createElement(tagName);\r\n            }\r\n            var specialAttributes = {};\r\n            for (var name_1 in n.attributes) {\r\n                if (!Object.prototype.hasOwnProperty.call(n.attributes, name_1)) {\r\n                    continue;\r\n                }\r\n                var value = n.attributes[name_1];\r\n                if (tagName === 'option' &&\r\n                    name_1 === 'selected' &&\r\n                    value === false) {\r\n                    continue;\r\n                }\r\n                if (value === true)\r\n                    value = '';\r\n                if (name_1.startsWith('rr_')) {\r\n                    specialAttributes[name_1] = value;\r\n                    continue;\r\n                }\r\n                var isTextarea = tagName === 'textarea' && name_1 === 'value';\r\n                var isRemoteOrDynamicCss = tagName === 'style' && name_1 === '_cssText';\r\n                if (isRemoteOrDynamicCss && hackCss && typeof value === 'string') {\r\n                    value = addHoverClass(value, cache);\r\n                }\r\n                if ((isTextarea || isRemoteOrDynamicCss) && typeof value === 'string') {\r\n                    var child = doc.createTextNode(value);\r\n                    for (var _i = 0, _a = Array.from(node_1.childNodes); _i < _a.length; _i++) {\r\n                        var c = _a[_i];\r\n                        if (c.nodeType === node_1.TEXT_NODE) {\r\n                            node_1.removeChild(c);\r\n                        }\r\n                    }\r\n                    node_1.appendChild(child);\r\n                    continue;\r\n                }\r\n                try {\r\n                    if (n.isSVG && name_1 === 'xlink:href') {\r\n                        node_1.setAttributeNS('http://www.w3.org/1999/xlink', name_1, value.toString());\r\n                    }\r\n                    else if (name_1 === 'onload' ||\r\n                        name_1 === 'onclick' ||\r\n                        name_1.substring(0, 7) === 'onmouse') {\r\n                        node_1.setAttribute('_' + name_1, value.toString());\r\n                    }\r\n                    else if (tagName === 'meta' &&\r\n                        n.attributes['http-equiv'] === 'Content-Security-Policy' &&\r\n                        name_1 === 'content') {\r\n                        node_1.setAttribute('csp-content', value.toString());\r\n                        continue;\r\n                    }\r\n                    else if (tagName === 'link' &&\r\n                        n.attributes.rel === 'preload' &&\r\n                        n.attributes.as === 'script') {\r\n                    }\r\n                    else if (tagName === 'link' &&\r\n                        n.attributes.rel === 'prefetch' &&\r\n                        typeof n.attributes.href === 'string' &&\r\n                        n.attributes.href.endsWith('.js')) {\r\n                    }\r\n                    else if (tagName === 'img' &&\r\n                        n.attributes.srcset &&\r\n                        n.attributes.rr_dataURL) {\r\n                        node_1.setAttribute('rrweb-original-srcset', n.attributes.srcset);\r\n                    }\r\n                    else {\r\n                        node_1.setAttribute(name_1, value.toString());\r\n                    }\r\n                }\r\n                catch (error) {\r\n                }\r\n            }\r\n            var _loop_1 = function (name_2) {\r\n                var value = specialAttributes[name_2];\r\n                if (tagName === 'canvas' && name_2 === 'rr_dataURL') {\r\n                    var image_1 = document.createElement('img');\r\n                    image_1.onload = function () {\r\n                        var ctx = node_1.getContext('2d');\r\n                        if (ctx) {\r\n                            ctx.drawImage(image_1, 0, 0, image_1.width, image_1.height);\r\n                        }\r\n                    };\r\n                    image_1.src = value.toString();\r\n                    if (node_1.RRNodeType)\r\n                        node_1.rr_dataURL = value.toString();\r\n                }\r\n                else if (tagName === 'img' && name_2 === 'rr_dataURL') {\r\n                    var image = node_1;\r\n                    if (!image.currentSrc.startsWith('data:')) {\r\n                        image.setAttribute('rrweb-original-src', n.attributes.src);\r\n                        image.src = value.toString();\r\n                    }\r\n                }\r\n                if (name_2 === 'rr_width') {\r\n                    node_1.style.width = value.toString();\r\n                }\r\n                else if (name_2 === 'rr_height') {\r\n                    node_1.style.height = value.toString();\r\n                }\r\n                else if (name_2 === 'rr_mediaCurrentTime' &&\r\n                    typeof value === 'number') {\r\n                    node_1.currentTime = value;\r\n                }\r\n                else if (name_2 === 'rr_mediaState') {\r\n                    switch (value) {\r\n                        case 'played':\r\n                            node_1\r\n                                .play()[\"catch\"](function (e) { return console.warn('media playback error', e); });\r\n                            break;\r\n                        case 'paused':\r\n                            node_1.pause();\r\n                            break;\r\n                    }\r\n                }\r\n            };\r\n            for (var name_2 in specialAttributes) {\r\n                _loop_1(name_2);\r\n            }\r\n            if (n.isShadowHost) {\r\n                if (!node_1.shadowRoot) {\r\n                    node_1.attachShadow({ mode: 'open' });\r\n                }\r\n                else {\r\n                    while (node_1.shadowRoot.firstChild) {\r\n                        node_1.shadowRoot.removeChild(node_1.shadowRoot.firstChild);\r\n                    }\r\n                }\r\n            }\r\n            return node_1;\r\n        }\r\n        case NodeType.Text:\r\n            return doc.createTextNode(n.isStyle && hackCss\r\n                ? addHoverClass(n.textContent, cache)\r\n                : n.textContent);\r\n        case NodeType.CDATA:\r\n            return doc.createCDATASection(n.textContent);\r\n        case NodeType.Comment:\r\n            return doc.createComment(n.textContent);\r\n        default:\r\n            return null;\r\n    }\r\n}\r\nfunction buildNodeWithSN(n, options) {\r\n    var doc = options.doc, mirror = options.mirror, _a = options.skipChild, skipChild = _a === void 0 ? false : _a, _b = options.hackCss, hackCss = _b === void 0 ? true : _b, afterAppend = options.afterAppend, cache = options.cache;\r\n    var node = buildNode(n, { doc: doc, hackCss: hackCss, cache: cache });\r\n    if (!node) {\r\n        return null;\r\n    }\r\n    if (n.rootId && mirror.getNode(n.rootId) !== doc) {\r\n        mirror.replace(n.rootId, doc);\r\n    }\r\n    if (n.type === NodeType.Document) {\r\n        doc.close();\r\n        doc.open();\r\n        if (n.compatMode === 'BackCompat' &&\r\n            n.childNodes &&\r\n            n.childNodes[0].type !== NodeType.DocumentType) {\r\n            if (n.childNodes[0].type === NodeType.Element &&\r\n                'xmlns' in n.childNodes[0].attributes &&\r\n                n.childNodes[0].attributes.xmlns === 'http://www.w3.org/1999/xhtml') {\r\n                doc.write('<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"\">');\r\n            }\r\n            else {\r\n                doc.write('<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\" \"\">');\r\n            }\r\n        }\r\n        node = doc;\r\n    }\r\n    mirror.add(node, n);\r\n    if ((n.type === NodeType.Document || n.type === NodeType.Element) &&\r\n        !skipChild) {\r\n        for (var _i = 0, _c = n.childNodes; _i < _c.length; _i++) {\r\n            var childN = _c[_i];\r\n            var childNode = buildNodeWithSN(childN, {\r\n                doc: doc,\r\n                mirror: mirror,\r\n                skipChild: false,\r\n                hackCss: hackCss,\r\n                afterAppend: afterAppend,\r\n                cache: cache\r\n            });\r\n            if (!childNode) {\r\n                console.warn('Failed to rebuild', childN);\r\n                continue;\r\n            }\r\n            if (childN.isShadow && isElement(node) && node.shadowRoot) {\r\n                node.shadowRoot.appendChild(childNode);\r\n            }\r\n            else {\r\n                node.appendChild(childNode);\r\n            }\r\n            if (afterAppend) {\r\n                afterAppend(childNode, childN.id);\r\n            }\r\n        }\r\n    }\r\n    return node;\r\n}\r\nfunction visit(mirror, onVisit) {\r\n    function walk(node) {\r\n        onVisit(node);\r\n    }\r\n    for (var _i = 0, _a = mirror.getIds(); _i < _a.length; _i++) {\r\n        var id = _a[_i];\r\n        if (mirror.has(id)) {\r\n            walk(mirror.getNode(id));\r\n        }\r\n    }\r\n}\r\nfunction handleScroll(node, mirror) {\r\n    var n = mirror.getMeta(node);\r\n    if ((n === null || n === void 0 ? void 0 : n.type) !== NodeType.Element) {\r\n        return;\r\n    }\r\n    var el = node;\r\n    for (var name_3 in n.attributes) {\r\n        if (!(Object.prototype.hasOwnProperty.call(n.attributes, name_3) &&\r\n            name_3.startsWith('rr_'))) {\r\n            continue;\r\n        }\r\n        var value = n.attributes[name_3];\r\n        if (name_3 === 'rr_scrollLeft') {\r\n            el.scrollLeft = value;\r\n        }\r\n        if (name_3 === 'rr_scrollTop') {\r\n            el.scrollTop = value;\r\n        }\r\n    }\r\n}\r\nfunction rebuild(n, options) {\r\n    var doc = options.doc, onVisit = options.onVisit, _a = options.hackCss, hackCss = _a === void 0 ? true : _a, afterAppend = options.afterAppend, cache = options.cache, _b = options.mirror, mirror = _b === void 0 ? new Mirror() : _b;\r\n    var node = buildNodeWithSN(n, {\r\n        doc: doc,\r\n        mirror: mirror,\r\n        skipChild: false,\r\n        hackCss: hackCss,\r\n        afterAppend: afterAppend,\r\n        cache: cache\r\n    });\r\n    visit(mirror, function (visitedNode) {\r\n        if (onVisit) {\r\n            onVisit(visitedNode);\r\n        }\r\n        handleScroll(visitedNode, mirror);\r\n    });\r\n    return node;\r\n}\n\nexport { IGNORED_NODE, Mirror, NodeType, addHoverClass, buildNodeWithSN, classMatchesRegex, createCache, createMirror, genId, getCssRuleString, getCssRulesString, is2DCanvasBlank, isCSSImportRule, isElement, isNativeShadowDom, isShadowRoot, maskInputValue, needMaskingText, rebuild, serializeNodeWithId, snapshot, transformAttribute };\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { classMatchesRegex, IGNORED_NODE, isShadowRoot } from '../../rrweb-snapshot/es/rrweb-snapshot.js';\n\nfunction on(type, fn, target = document) {\r\n    const options = { capture: true, passive: true };\r\n    target.addEventListener(type, fn, options);\r\n    return () => target.removeEventListener(type, fn, options);\r\n}\r\nconst DEPARTED_MIRROR_ACCESS_WARNING = 'Please stop import mirror directly. Instead of that,' +\r\n    '\\r\\n' +\r\n    'now you can use replayer.getMirror() to access the mirror instance of a replayer,' +\r\n    '\\r\\n' +\r\n    'or you can use record.mirror to access the mirror instance during recording.';\r\nlet _mirror = {\r\n    map: {},\r\n    getId() {\r\n        console.error(DEPARTED_MIRROR_ACCESS_WARNING);\r\n        return -1;\r\n    },\r\n    getNode() {\r\n        console.error(DEPARTED_MIRROR_ACCESS_WARNING);\r\n        return null;\r\n    },\r\n    removeNodeFromMap() {\r\n        console.error(DEPARTED_MIRROR_ACCESS_WARNING);\r\n    },\r\n    has() {\r\n        console.error(DEPARTED_MIRROR_ACCESS_WARNING);\r\n        return false;\r\n    },\r\n    reset() {\r\n        console.error(DEPARTED_MIRROR_ACCESS_WARNING);\r\n    },\r\n};\r\nif (typeof window !== 'undefined' && window.Proxy && window.Reflect) {\r\n    _mirror = new Proxy(_mirror, {\r\n        get(target, prop, receiver) {\r\n            if (prop === 'map') {\r\n                console.error(DEPARTED_MIRROR_ACCESS_WARNING);\r\n            }\r\n            return Reflect.get(target, prop, receiver);\r\n        },\r\n    });\r\n}\r\nfunction throttle(func, wait, options = {}) {\r\n    let timeout = null;\r\n    let previous = 0;\r\n    return function (...args) {\r\n        const now = Date.now();\r\n        if (!previous && options.leading === false) {\r\n            previous = now;\r\n        }\r\n        const remaining = wait - (now - previous);\r\n        const context = this;\r\n        if (remaining <= 0 || remaining > wait) {\r\n            if (timeout) {\r\n                clearTimeout(timeout);\r\n                timeout = null;\r\n            }\r\n            previous = now;\r\n            func.apply(context, args);\r\n        }\r\n        else if (!timeout && options.trailing !== false) {\r\n            timeout = setTimeout(() => {\r\n                previous = options.leading === false ? 0 : Date.now();\r\n                timeout = null;\r\n                func.apply(context, args);\r\n            }, remaining);\r\n        }\r\n    };\r\n}\r\nfunction hookSetter(target, key, d, isRevoked, win = window) {\r\n    const original = win.Object.getOwnPropertyDescriptor(target, key);\r\n    win.Object.defineProperty(target, key, isRevoked\r\n        ? d\r\n        : {\r\n            set(value) {\r\n                setTimeout(() => {\r\n                    d.set.call(this, value);\r\n                }, 0);\r\n                if (original && original.set) {\r\n                    original.set.call(this, value);\r\n                }\r\n            },\r\n        });\r\n    return () => hookSetter(target, key, original || {}, true);\r\n}\r\nfunction patch(source, name, replacement) {\r\n    try {\r\n        if (!(name in source)) {\r\n            return () => {\r\n            };\r\n        }\r\n        const original = source[name];\r\n        const wrapped = replacement(original);\r\n        if (typeof wrapped === 'function') {\r\n            wrapped.prototype = wrapped.prototype || {};\r\n            Object.defineProperties(wrapped, {\r\n                __rrweb_original__: {\r\n                    enumerable: false,\r\n                    value: original,\r\n                },\r\n            });\r\n        }\r\n        source[name] = wrapped;\r\n        return () => {\r\n            source[name] = original;\r\n        };\r\n    }\r\n    catch (_a) {\r\n        return () => {\r\n        };\r\n    }\r\n}\r\nfunction getWindowHeight() {\r\n    return (window.innerHeight ||\r\n        (document.documentElement && document.documentElement.clientHeight) ||\r\n        (document.body && document.body.clientHeight));\r\n}\r\nfunction getWindowWidth() {\r\n    return (window.innerWidth ||\r\n        (document.documentElement && document.documentElement.clientWidth) ||\r\n        (document.body && document.body.clientWidth));\r\n}\r\nfunction isBlocked(node, blockClass, blockSelector, checkAncestors) {\r\n    if (!node) {\r\n        return false;\r\n    }\r\n    const el = node.nodeType === node.ELEMENT_NODE\r\n        ? node\r\n        : node.parentElement;\r\n    if (!el)\r\n        return false;\r\n    if (typeof blockClass === 'string') {\r\n        if (el.classList.contains(blockClass))\r\n            return true;\r\n        if (checkAncestors && el.closest('.' + blockClass) !== null)\r\n            return true;\r\n    }\r\n    else {\r\n        if (classMatchesRegex(el, blockClass, checkAncestors))\r\n            return true;\r\n    }\r\n    if (blockSelector) {\r\n        if (node.matches(blockSelector))\r\n            return true;\r\n        if (checkAncestors && el.closest(blockSelector) !== null)\r\n            return true;\r\n    }\r\n    return false;\r\n}\r\nfunction isSerialized(n, mirror) {\r\n    return mirror.getId(n) !== -1;\r\n}\r\nfunction isIgnored(n, mirror) {\r\n    return mirror.getId(n) === IGNORED_NODE;\r\n}\r\nfunction isAncestorRemoved(target, mirror) {\r\n    if (isShadowRoot(target)) {\r\n        return false;\r\n    }\r\n    const id = mirror.getId(target);\r\n    if (!mirror.has(id)) {\r\n        return true;\r\n    }\r\n    if (target.parentNode &&\r\n        target.parentNode.nodeType === target.DOCUMENT_NODE) {\r\n        return false;\r\n    }\r\n    if (!target.parentNode) {\r\n        return true;\r\n    }\r\n    return isAncestorRemoved(target.parentNode, mirror);\r\n}\r\nfunction isTouchEvent(event) {\r\n    return Boolean(event.changedTouches);\r\n}\r\nfunction polyfill(win = window) {\r\n    if ('NodeList' in win && !win.NodeList.prototype.forEach) {\r\n        win.NodeList.prototype.forEach = Array.prototype\r\n            .forEach;\r\n    }\r\n    if ('DOMTokenList' in win && !win.DOMTokenList.prototype.forEach) {\r\n        win.DOMTokenList.prototype.forEach = Array.prototype\r\n            .forEach;\r\n    }\r\n    if (!Node.prototype.contains) {\r\n        Node.prototype.contains = (...args) => {\r\n            let node = args[0];\r\n            if (!(0 in args)) {\r\n                throw new TypeError('1 argument is required');\r\n            }\r\n            do {\r\n                if (this === node) {\r\n                    return true;\r\n                }\r\n            } while ((node = node && node.parentNode));\r\n            return false;\r\n        };\r\n    }\r\n}\r\nfunction queueToResolveTrees(queue) {\r\n    const queueNodeMap = {};\r\n    const putIntoMap = (m, parent) => {\r\n        const nodeInTree = {\r\n            value: m,\r\n            parent,\r\n            children: [],\r\n        };\r\n        queueNodeMap[m.node.id] = nodeInTree;\r\n        return nodeInTree;\r\n    };\r\n    const queueNodeTrees = [];\r\n    for (const mutation of queue) {\r\n        const { nextId, parentId } = mutation;\r\n        if (nextId && nextId in queueNodeMap) {\r\n            const nextInTree = queueNodeMap[nextId];\r\n            if (nextInTree.parent) {\r\n                const idx = nextInTree.parent.children.indexOf(nextInTree);\r\n                nextInTree.parent.children.splice(idx, 0, putIntoMap(mutation, nextInTree.parent));\r\n            }\r\n            else {\r\n                const idx = queueNodeTrees.indexOf(nextInTree);\r\n                queueNodeTrees.splice(idx, 0, putIntoMap(mutation, null));\r\n            }\r\n            continue;\r\n        }\r\n        if (parentId in queueNodeMap) {\r\n            const parentInTree = queueNodeMap[parentId];\r\n            parentInTree.children.push(putIntoMap(mutation, parentInTree));\r\n            continue;\r\n        }\r\n        queueNodeTrees.push(putIntoMap(mutation, null));\r\n    }\r\n    return queueNodeTrees;\r\n}\r\nfunction iterateResolveTree(tree, cb) {\r\n    cb(tree.value);\r\n    for (let i = tree.children.length - 1; i >= 0; i--) {\r\n        iterateResolveTree(tree.children[i], cb);\r\n    }\r\n}\r\nfunction isSerializedIframe(n, mirror) {\r\n    return Boolean(n.nodeName === 'IFRAME' && mirror.getMeta(n));\r\n}\r\nfunction isSerializedStylesheet(n, mirror) {\r\n    return Boolean(n.nodeName === 'LINK' &&\r\n        n.nodeType === n.ELEMENT_NODE &&\r\n        n.getAttribute &&\r\n        n.getAttribute('rel') === 'stylesheet' &&\r\n        mirror.getMeta(n));\r\n}\r\nfunction getBaseDimension(node, rootIframe) {\r\n    var _a, _b;\r\n    const frameElement = (_b = (_a = node.ownerDocument) === null || _a === void 0 ? void 0 : _a.defaultView) === null || _b === void 0 ? void 0 : _b.frameElement;\r\n    if (!frameElement || frameElement === rootIframe) {\r\n        return {\r\n            x: 0,\r\n            y: 0,\r\n            relativeScale: 1,\r\n            absoluteScale: 1,\r\n        };\r\n    }\r\n    const frameDimension = frameElement.getBoundingClientRect();\r\n    const frameBaseDimension = getBaseDimension(frameElement, rootIframe);\r\n    const relativeScale = frameDimension.height / frameElement.clientHeight;\r\n    return {\r\n        x: frameDimension.x * frameBaseDimension.relativeScale +\r\n            frameBaseDimension.x,\r\n        y: frameDimension.y * frameBaseDimension.relativeScale +\r\n            frameBaseDimension.y,\r\n        relativeScale,\r\n        absoluteScale: frameBaseDimension.absoluteScale * relativeScale,\r\n    };\r\n}\r\nfunction hasShadowRoot(n) {\r\n    return Boolean(n === null || n === void 0 ? void 0 : n.shadowRoot);\r\n}\r\nfunction getNestedRule(rules, position) {\r\n    const rule = rules[position[0]];\r\n    if (position.length === 1) {\r\n        return rule;\r\n    }\r\n    else {\r\n        return getNestedRule(rule.cssRules[position[1]].cssRules, position.slice(2));\r\n    }\r\n}\r\nfunction getPositionsAndIndex(nestedIndex) {\r\n    const positions = [...nestedIndex];\r\n    const index = positions.pop();\r\n    return { positions, index };\r\n}\r\nfunction uniqueTextMutations(mutations) {\r\n    const idSet = new Set();\r\n    const uniqueMutations = [];\r\n    for (let i = mutations.length; i--;) {\r\n        const mutation = mutations[i];\r\n        if (!idSet.has(mutation.id)) {\r\n            uniqueMutations.push(mutation);\r\n            idSet.add(mutation.id);\r\n        }\r\n    }\r\n    return uniqueMutations;\r\n}\r\nclass StyleSheetMirror {\r\n    constructor() {\r\n        this.id = 1;\r\n        this.styleIDMap = new WeakMap();\r\n        this.idStyleMap = new Map();\r\n    }\r\n    getId(stylesheet) {\r\n        var _a;\r\n        return (_a = this.styleIDMap.get(stylesheet)) !== null && _a !== void 0 ? _a : -1;\r\n    }\r\n    has(stylesheet) {\r\n        return this.styleIDMap.has(stylesheet);\r\n    }\r\n    add(stylesheet, id) {\r\n        if (this.has(stylesheet))\r\n            return this.getId(stylesheet);\r\n        let newId;\r\n        if (id === undefined) {\r\n            newId = this.id++;\r\n        }\r\n        else\r\n            newId = id;\r\n        this.styleIDMap.set(stylesheet, newId);\r\n        this.idStyleMap.set(newId, stylesheet);\r\n        return newId;\r\n    }\r\n    getStyle(id) {\r\n        return this.idStyleMap.get(id) || null;\r\n    }\r\n    reset() {\r\n        this.styleIDMap = new WeakMap();\r\n        this.idStyleMap = new Map();\r\n        this.id = 1;\r\n    }\r\n    generateId() {\r\n        return this.id++;\r\n    }\r\n}\n\nexport { StyleSheetMirror, _mirror, getBaseDimension, getNestedRule, getPositionsAndIndex, getWindowHeight, getWindowWidth, hasShadowRoot, hookSetter, isAncestorRemoved, isBlocked, isIgnored, isSerialized, isSerializedIframe, isSerializedStylesheet, isTouchEvent, iterateResolveTree, on, patch, polyfill, queueToResolveTrees, throttle, uniqueTextMutations };\n","var EventType = /* @__PURE__ */ ((EventType2) => {\n  EventType2[EventType2[\"DomContentLoaded\"] = 0] = \"DomContentLoaded\";\n  EventType2[EventType2[\"Load\"] = 1] = \"Load\";\n  EventType2[EventType2[\"FullSnapshot\"] = 2] = \"FullSnapshot\";\n  EventType2[EventType2[\"IncrementalSnapshot\"] = 3] = \"IncrementalSnapshot\";\n  EventType2[EventType2[\"Meta\"] = 4] = \"Meta\";\n  EventType2[EventType2[\"Custom\"] = 5] = \"Custom\";\n  EventType2[EventType2[\"Plugin\"] = 6] = \"Plugin\";\n  return EventType2;\n})(EventType || {});\nvar IncrementalSource = /* @__PURE__ */ ((IncrementalSource2) => {\n  IncrementalSource2[IncrementalSource2[\"Mutation\"] = 0] = \"Mutation\";\n  IncrementalSource2[IncrementalSource2[\"MouseMove\"] = 1] = \"MouseMove\";\n  IncrementalSource2[IncrementalSource2[\"MouseInteraction\"] = 2] = \"MouseInteraction\";\n  IncrementalSource2[IncrementalSource2[\"Scroll\"] = 3] = \"Scroll\";\n  IncrementalSource2[IncrementalSource2[\"ViewportResize\"] = 4] = \"ViewportResize\";\n  IncrementalSource2[IncrementalSource2[\"Input\"] = 5] = \"Input\";\n  IncrementalSource2[IncrementalSource2[\"TouchMove\"] = 6] = \"TouchMove\";\n  IncrementalSource2[IncrementalSource2[\"MediaInteraction\"] = 7] = \"MediaInteraction\";\n  IncrementalSource2[IncrementalSource2[\"StyleSheetRule\"] = 8] = \"StyleSheetRule\";\n  IncrementalSource2[IncrementalSource2[\"CanvasMutation\"] = 9] = \"CanvasMutation\";\n  IncrementalSource2[IncrementalSource2[\"Font\"] = 10] = \"Font\";\n  IncrementalSource2[IncrementalSource2[\"Log\"] = 11] = \"Log\";\n  IncrementalSource2[IncrementalSource2[\"Drag\"] = 12] = \"Drag\";\n  IncrementalSource2[IncrementalSource2[\"StyleDeclaration\"] = 13] = \"StyleDeclaration\";\n  IncrementalSource2[IncrementalSource2[\"Selection\"] = 14] = \"Selection\";\n  IncrementalSource2[IncrementalSource2[\"AdoptedStyleSheet\"] = 15] = \"AdoptedStyleSheet\";\n  return IncrementalSource2;\n})(IncrementalSource || {});\nvar MouseInteractions = /* @__PURE__ */ ((MouseInteractions2) => {\n  MouseInteractions2[MouseInteractions2[\"MouseUp\"] = 0] = \"MouseUp\";\n  MouseInteractions2[MouseInteractions2[\"MouseDown\"] = 1] = \"MouseDown\";\n  MouseInteractions2[MouseInteractions2[\"Click\"] = 2] = \"Click\";\n  MouseInteractions2[MouseInteractions2[\"ContextMenu\"] = 3] = \"ContextMenu\";\n  MouseInteractions2[MouseInteractions2[\"DblClick\"] = 4] = \"DblClick\";\n  MouseInteractions2[MouseInteractions2[\"Focus\"] = 5] = \"Focus\";\n  MouseInteractions2[MouseInteractions2[\"Blur\"] = 6] = \"Blur\";\n  MouseInteractions2[MouseInteractions2[\"TouchStart\"] = 7] = \"TouchStart\";\n  MouseInteractions2[MouseInteractions2[\"TouchMove_Departed\"] = 8] = \"TouchMove_Departed\";\n  MouseInteractions2[MouseInteractions2[\"TouchEnd\"] = 9] = \"TouchEnd\";\n  MouseInteractions2[MouseInteractions2[\"TouchCancel\"] = 10] = \"TouchCancel\";\n  return MouseInteractions2;\n})(MouseInteractions || {});\nvar CanvasContext = /* @__PURE__ */ ((CanvasContext2) => {\n  CanvasContext2[CanvasContext2[\"2D\"] = 0] = \"2D\";\n  CanvasContext2[CanvasContext2[\"WebGL\"] = 1] = \"WebGL\";\n  CanvasContext2[CanvasContext2[\"WebGL2\"] = 2] = \"WebGL2\";\n  return CanvasContext2;\n})(CanvasContext || {});\nvar ReplayerEvents = /* @__PURE__ */ ((ReplayerEvents2) => {\n  ReplayerEvents2[\"Start\"] = \"start\";\n  ReplayerEvents2[\"Pause\"] = \"pause\";\n  ReplayerEvents2[\"Resume\"] = \"resume\";\n  ReplayerEvents2[\"Resize\"] = \"resize\";\n  ReplayerEvents2[\"Finish\"] = \"finish\";\n  ReplayerEvents2[\"FullsnapshotRebuilded\"] = \"fullsnapshot-rebuilded\";\n  ReplayerEvents2[\"LoadStylesheetStart\"] = \"load-stylesheet-start\";\n  ReplayerEvents2[\"LoadStylesheetEnd\"] = \"load-stylesheet-end\";\n  ReplayerEvents2[\"SkipStart\"] = \"skip-start\";\n  ReplayerEvents2[\"SkipEnd\"] = \"skip-end\";\n  ReplayerEvents2[\"MouseInteraction\"] = \"mouse-interaction\";\n  ReplayerEvents2[\"EventCast\"] = \"event-cast\";\n  ReplayerEvents2[\"CustomEvent\"] = \"custom-event\";\n  ReplayerEvents2[\"Flush\"] = \"flush\";\n  ReplayerEvents2[\"StateChange\"] = \"state-change\";\n  ReplayerEvents2[\"PlayBack\"] = \"play-back\";\n  ReplayerEvents2[\"Destroy\"] = \"destroy\";\n  return ReplayerEvents2;\n})(ReplayerEvents || {});\n\nexport { CanvasContext, EventType, IncrementalSource, MouseInteractions, ReplayerEvents };\n","import { isShadowRoot, isNativeShadowDom, maskInputValue, transformAttribute, needMaskingText, IGNORED_NODE, serializeNodeWithId } from '../../../rrweb-snapshot/es/rrweb-snapshot.js';\nimport { isIgnored, isBlocked, isSerialized, isAncestorRemoved, isSerializedIframe, isSerializedStylesheet, hasShadowRoot } from '../utils.js';\n\nfunction isNodeInLinkedList(n) {\r\n    return '__ln' in n;\r\n}\r\nclass DoubleLinkedList {\r\n    constructor() {\r\n        this.length = 0;\r\n        this.head = null;\r\n    }\r\n    get(position) {\r\n        if (position >= this.length) {\r\n            throw new Error('Position outside of list range');\r\n        }\r\n        let current = this.head;\r\n        for (let index = 0; index < position; index++) {\r\n            current = (current === null || current === void 0 ? void 0 : current.next) || null;\r\n        }\r\n        return current;\r\n    }\r\n    addNode(n) {\r\n        const node = {\r\n            value: n,\r\n            previous: null,\r\n            next: null,\r\n        };\r\n        n.__ln = node;\r\n        if (n.previousSibling && isNodeInLinkedList(n.previousSibling)) {\r\n            const current = n.previousSibling.__ln.next;\r\n            node.next = current;\r\n            node.previous = n.previousSibling.__ln;\r\n            n.previousSibling.__ln.next = node;\r\n            if (current) {\r\n                current.previous = node;\r\n            }\r\n        }\r\n        else if (n.nextSibling &&\r\n            isNodeInLinkedList(n.nextSibling) &&\r\n            n.nextSibling.__ln.previous) {\r\n            const current = n.nextSibling.__ln.previous;\r\n            node.previous = current;\r\n            node.next = n.nextSibling.__ln;\r\n            n.nextSibling.__ln.previous = node;\r\n            if (current) {\r\n                current.next = node;\r\n            }\r\n        }\r\n        else {\r\n            if (this.head) {\r\n                this.head.previous = node;\r\n            }\r\n            node.next = this.head;\r\n            this.head = node;\r\n        }\r\n        this.length++;\r\n    }\r\n    removeNode(n) {\r\n        const current = n.__ln;\r\n        if (!this.head) {\r\n            return;\r\n        }\r\n        if (!current.previous) {\r\n            this.head = current.next;\r\n            if (this.head) {\r\n                this.head.previous = null;\r\n            }\r\n        }\r\n        else {\r\n            current.previous.next = current.next;\r\n            if (current.next) {\r\n                current.next.previous = current.previous;\r\n            }\r\n        }\r\n        if (n.__ln) {\r\n            delete n.__ln;\r\n        }\r\n        this.length--;\r\n    }\r\n}\r\nconst moveKey = (id, parentId) => `${id}@${parentId}`;\r\nclass MutationBuffer {\r\n    constructor() {\r\n        this.frozen = false;\r\n        this.locked = false;\r\n        this.texts = [];\r\n        this.attributes = [];\r\n        this.removes = [];\r\n        this.mapRemoves = [];\r\n        this.movedMap = {};\r\n        this.addedSet = new Set();\r\n        this.movedSet = new Set();\r\n        this.droppedSet = new Set();\r\n        this.processMutations = (mutations) => {\r\n            mutations.forEach(this.processMutation);\r\n            this.emit();\r\n        };\r\n        this.emit = () => {\r\n            if (this.frozen || this.locked) {\r\n                return;\r\n            }\r\n            const adds = [];\r\n            const addList = new DoubleLinkedList();\r\n            const getNextId = (n) => {\r\n                let ns = n;\r\n                let nextId = IGNORED_NODE;\r\n                while (nextId === IGNORED_NODE) {\r\n                    ns = ns && ns.nextSibling;\r\n                    nextId = ns && this.mirror.getId(ns);\r\n                }\r\n                return nextId;\r\n            };\r\n            const pushAdd = (n) => {\r\n                var _a, _b, _c, _d;\r\n                let shadowHost = null;\r\n                if (((_b = (_a = n.getRootNode) === null || _a === void 0 ? void 0 : _a.call(n)) === null || _b === void 0 ? void 0 : _b.nodeType) === Node.DOCUMENT_FRAGMENT_NODE &&\r\n                    n.getRootNode().host)\r\n                    shadowHost = n.getRootNode().host;\r\n                let rootShadowHost = shadowHost;\r\n                while (((_d = (_c = rootShadowHost === null || rootShadowHost === void 0 ? void 0 : rootShadowHost.getRootNode) === null || _c === void 0 ? void 0 : _c.call(rootShadowHost)) === null || _d === void 0 ? void 0 : _d.nodeType) ===\r\n                    Node.DOCUMENT_FRAGMENT_NODE &&\r\n                    rootShadowHost.getRootNode().host)\r\n                    rootShadowHost = rootShadowHost.getRootNode().host;\r\n                const notInDoc = !this.doc.contains(n) &&\r\n                    (!rootShadowHost || !this.doc.contains(rootShadowHost));\r\n                if (!n.parentNode || notInDoc) {\r\n                    return;\r\n                }\r\n                const parentId = isShadowRoot(n.parentNode)\r\n                    ? this.mirror.getId(shadowHost)\r\n                    : this.mirror.getId(n.parentNode);\r\n                const nextId = getNextId(n);\r\n                if (parentId === -1 || nextId === -1) {\r\n                    return addList.addNode(n);\r\n                }\r\n                const sn = serializeNodeWithId(n, {\r\n                    doc: this.doc,\r\n                    mirror: this.mirror,\r\n                    blockClass: this.blockClass,\r\n                    blockSelector: this.blockSelector,\r\n                    maskTextClass: this.maskTextClass,\r\n                    maskTextSelector: this.maskTextSelector,\r\n                    skipChild: true,\r\n                    newlyAddedElement: true,\r\n                    inlineStylesheet: this.inlineStylesheet,\r\n                    maskInputOptions: this.maskInputOptions,\r\n                    maskTextFn: this.maskTextFn,\r\n                    maskInputFn: this.maskInputFn,\r\n                    slimDOMOptions: this.slimDOMOptions,\r\n                    dataURLOptions: this.dataURLOptions,\r\n                    recordCanvas: this.recordCanvas,\r\n                    inlineImages: this.inlineImages,\r\n                    onSerialize: (currentN) => {\r\n                        if (isSerializedIframe(currentN, this.mirror)) {\r\n                            this.iframeManager.addIframe(currentN);\r\n                        }\r\n                        if (isSerializedStylesheet(currentN, this.mirror)) {\r\n                            this.stylesheetManager.trackLinkElement(currentN);\r\n                        }\r\n                        if (hasShadowRoot(n)) {\r\n                            this.shadowDomManager.addShadowRoot(n.shadowRoot, this.doc);\r\n                        }\r\n                    },\r\n                    onIframeLoad: (iframe, childSn) => {\r\n                        this.iframeManager.attachIframe(iframe, childSn);\r\n                        this.shadowDomManager.observeAttachShadow(iframe);\r\n                    },\r\n                    onStylesheetLoad: (link, childSn) => {\r\n                        this.stylesheetManager.attachLinkElement(link, childSn);\r\n                    },\r\n                });\r\n                if (sn) {\r\n                    adds.push({\r\n                        parentId,\r\n                        nextId,\r\n                        node: sn,\r\n                    });\r\n                }\r\n            };\r\n            while (this.mapRemoves.length) {\r\n                this.mirror.removeNodeFromMap(this.mapRemoves.shift());\r\n            }\r\n            for (const n of Array.from(this.movedSet.values())) {\r\n                if (isParentRemoved(this.removes, n, this.mirror) &&\r\n                    !this.movedSet.has(n.parentNode)) {\r\n                    continue;\r\n                }\r\n                pushAdd(n);\r\n            }\r\n            for (const n of Array.from(this.addedSet.values())) {\r\n                if (!isAncestorInSet(this.droppedSet, n) &&\r\n                    !isParentRemoved(this.removes, n, this.mirror)) {\r\n                    pushAdd(n);\r\n                }\r\n                else if (isAncestorInSet(this.movedSet, n)) {\r\n                    pushAdd(n);\r\n                }\r\n                else {\r\n                    this.droppedSet.add(n);\r\n                }\r\n            }\r\n            let candidate = null;\r\n            while (addList.length) {\r\n                let node = null;\r\n                if (candidate) {\r\n                    const parentId = this.mirror.getId(candidate.value.parentNode);\r\n                    const nextId = getNextId(candidate.value);\r\n                    if (parentId !== -1 && nextId !== -1) {\r\n                        node = candidate;\r\n                    }\r\n                }\r\n                if (!node) {\r\n                    for (let index = addList.length - 1; index >= 0; index--) {\r\n                        const _node = addList.get(index);\r\n                        if (_node) {\r\n                            const parentId = this.mirror.getId(_node.value.parentNode);\r\n                            const nextId = getNextId(_node.value);\r\n                            if (nextId === -1)\r\n                                continue;\r\n                            else if (parentId !== -1) {\r\n                                node = _node;\r\n                                break;\r\n                            }\r\n                            else {\r\n                                const unhandledNode = _node.value;\r\n                                if (unhandledNode.parentNode &&\r\n                                    unhandledNode.parentNode.nodeType ===\r\n                                        Node.DOCUMENT_FRAGMENT_NODE) {\r\n                                    const shadowHost = unhandledNode.parentNode\r\n                                        .host;\r\n                                    const parentId = this.mirror.getId(shadowHost);\r\n                                    if (parentId !== -1) {\r\n                                        node = _node;\r\n                                        break;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                if (!node) {\r\n                    while (addList.head) {\r\n                        addList.removeNode(addList.head.value);\r\n                    }\r\n                    break;\r\n                }\r\n                candidate = node.previous;\r\n                addList.removeNode(node.value);\r\n                pushAdd(node.value);\r\n            }\r\n            const payload = {\r\n                texts: this.texts\r\n                    .map((text) => ({\r\n                    id: this.mirror.getId(text.node),\r\n                    value: text.value,\r\n                }))\r\n                    .filter((text) => this.mirror.has(text.id)),\r\n                attributes: this.attributes\r\n                    .map((attribute) => ({\r\n                    id: this.mirror.getId(attribute.node),\r\n                    attributes: attribute.attributes,\r\n                }))\r\n                    .filter((attribute) => this.mirror.has(attribute.id)),\r\n                removes: this.removes,\r\n                adds,\r\n            };\r\n            if (!payload.texts.length &&\r\n                !payload.attributes.length &&\r\n                !payload.removes.length &&\r\n                !payload.adds.length) {\r\n                return;\r\n            }\r\n            this.texts = [];\r\n            this.attributes = [];\r\n            this.removes = [];\r\n            this.addedSet = new Set();\r\n            this.movedSet = new Set();\r\n            this.droppedSet = new Set();\r\n            this.movedMap = {};\r\n            this.mutationCb(payload);\r\n        };\r\n        this.processMutation = (m) => {\r\n            if (isIgnored(m.target, this.mirror)) {\r\n                return;\r\n            }\r\n            switch (m.type) {\r\n                case 'characterData': {\r\n                    const value = m.target.textContent;\r\n                    if (!isBlocked(m.target, this.blockClass, this.blockSelector, false) &&\r\n                        value !== m.oldValue) {\r\n                        this.texts.push({\r\n                            value: needMaskingText(m.target, this.maskTextClass, this.maskTextSelector) && value\r\n                                ? this.maskTextFn\r\n                                    ? this.maskTextFn(value)\r\n                                    : value.replace(/[\\S]/g, '*')\r\n                                : value,\r\n                            node: m.target,\r\n                        });\r\n                    }\r\n                    break;\r\n                }\r\n                case 'attributes': {\r\n                    const target = m.target;\r\n                    let value = m.target.getAttribute(m.attributeName);\r\n                    if (m.attributeName === 'value') {\r\n                        value = maskInputValue({\r\n                            maskInputOptions: this.maskInputOptions,\r\n                            tagName: m.target.tagName,\r\n                            type: m.target.getAttribute('type'),\r\n                            value,\r\n                            maskInputFn: this.maskInputFn,\r\n                        });\r\n                    }\r\n                    if (isBlocked(m.target, this.blockClass, this.blockSelector, false) ||\r\n                        value === m.oldValue) {\r\n                        return;\r\n                    }\r\n                    let item = this.attributes.find((a) => a.node === m.target);\r\n                    if (target.tagName === 'IFRAME' &&\r\n                        m.attributeName === 'src' &&\r\n                        !this.keepIframeSrcFn(value)) {\r\n                        if (!target.contentDocument) {\r\n                            m.attributeName = 'rr_src';\r\n                        }\r\n                        else {\r\n                            return;\r\n                        }\r\n                    }\r\n                    if (!item) {\r\n                        item = {\r\n                            node: m.target,\r\n                            attributes: {},\r\n                        };\r\n                        this.attributes.push(item);\r\n                    }\r\n                    if (m.attributeName === 'style') {\r\n                        const old = this.doc.createElement('span');\r\n                        if (m.oldValue) {\r\n                            old.setAttribute('style', m.oldValue);\r\n                        }\r\n                        if (item.attributes.style === undefined ||\r\n                            item.attributes.style === null) {\r\n                            item.attributes.style = {};\r\n                        }\r\n                        const styleObj = item.attributes.style;\r\n                        for (const pname of Array.from(target.style)) {\r\n                            const newValue = target.style.getPropertyValue(pname);\r\n                            const newPriority = target.style.getPropertyPriority(pname);\r\n                            if (newValue !== old.style.getPropertyValue(pname) ||\r\n                                newPriority !== old.style.getPropertyPriority(pname)) {\r\n                                if (newPriority === '') {\r\n                                    styleObj[pname] = newValue;\r\n                                }\r\n                                else {\r\n                                    styleObj[pname] = [newValue, newPriority];\r\n                                }\r\n                            }\r\n                        }\r\n                        for (const pname of Array.from(old.style)) {\r\n                            if (target.style.getPropertyValue(pname) === '') {\r\n                                styleObj[pname] = false;\r\n                            }\r\n                        }\r\n                    }\r\n                    else {\r\n                        item.attributes[m.attributeName] = transformAttribute(this.doc, target.tagName, m.attributeName, value);\r\n                    }\r\n                    break;\r\n                }\r\n                case 'childList': {\r\n                    if (isBlocked(m.target, this.blockClass, this.blockSelector, true))\r\n                        return;\r\n                    m.addedNodes.forEach((n) => this.genAdds(n, m.target));\r\n                    m.removedNodes.forEach((n) => {\r\n                        const nodeId = this.mirror.getId(n);\r\n                        const parentId = isShadowRoot(m.target)\r\n                            ? this.mirror.getId(m.target.host)\r\n                            : this.mirror.getId(m.target);\r\n                        if (isBlocked(m.target, this.blockClass, this.blockSelector, false) ||\r\n                            isIgnored(n, this.mirror) ||\r\n                            !isSerialized(n, this.mirror)) {\r\n                            return;\r\n                        }\r\n                        if (this.addedSet.has(n)) {\r\n                            deepDelete(this.addedSet, n);\r\n                            this.droppedSet.add(n);\r\n                        }\r\n                        else if (this.addedSet.has(m.target) && nodeId === -1) ;\r\n                        else if (isAncestorRemoved(m.target, this.mirror)) ;\r\n                        else if (this.movedSet.has(n) &&\r\n                            this.movedMap[moveKey(nodeId, parentId)]) {\r\n                            deepDelete(this.movedSet, n);\r\n                        }\r\n                        else {\r\n                            this.removes.push({\r\n                                parentId,\r\n                                id: nodeId,\r\n                                isShadow: isShadowRoot(m.target) && isNativeShadowDom(m.target)\r\n                                    ? true\r\n                                    : undefined,\r\n                            });\r\n                        }\r\n                        this.mapRemoves.push(n);\r\n                    });\r\n                    break;\r\n                }\r\n            }\r\n        };\r\n        this.genAdds = (n, target) => {\r\n            if (this.mirror.hasNode(n)) {\r\n                if (isIgnored(n, this.mirror)) {\r\n                    return;\r\n                }\r\n                this.movedSet.add(n);\r\n                let targetId = null;\r\n                if (target && this.mirror.hasNode(target)) {\r\n                    targetId = this.mirror.getId(target);\r\n                }\r\n                if (targetId && targetId !== -1) {\r\n                    this.movedMap[moveKey(this.mirror.getId(n), targetId)] = true;\r\n                }\r\n            }\r\n            else {\r\n                this.addedSet.add(n);\r\n                this.droppedSet.delete(n);\r\n            }\r\n            if (!isBlocked(n, this.blockClass, this.blockSelector, false))\r\n                n.childNodes.forEach((childN) => this.genAdds(childN));\r\n        };\r\n    }\r\n    init(options) {\r\n        [\r\n            'mutationCb',\r\n            'blockClass',\r\n            'blockSelector',\r\n            'maskTextClass',\r\n            'maskTextSelector',\r\n            'inlineStylesheet',\r\n            'maskInputOptions',\r\n            'maskTextFn',\r\n            'maskInputFn',\r\n            'keepIframeSrcFn',\r\n            'recordCanvas',\r\n            'inlineImages',\r\n            'slimDOMOptions',\r\n            'dataURLOptions',\r\n            'doc',\r\n            'mirror',\r\n            'iframeManager',\r\n            'stylesheetManager',\r\n            'shadowDomManager',\r\n            'canvasManager',\r\n        ].forEach((key) => {\r\n            this[key] = options[key];\r\n        });\r\n    }\r\n    freeze() {\r\n        this.frozen = true;\r\n        this.canvasManager.freeze();\r\n    }\r\n    unfreeze() {\r\n        this.frozen = false;\r\n        this.canvasManager.unfreeze();\r\n        this.emit();\r\n    }\r\n    isFrozen() {\r\n        return this.frozen;\r\n    }\r\n    lock() {\r\n        this.locked = true;\r\n        this.canvasManager.lock();\r\n    }\r\n    unlock() {\r\n        this.locked = false;\r\n        this.canvasManager.unlock();\r\n        this.emit();\r\n    }\r\n    reset() {\r\n        this.shadowDomManager.reset();\r\n        this.canvasManager.reset();\r\n    }\r\n}\r\nfunction deepDelete(addsSet, n) {\r\n    addsSet.delete(n);\r\n    n.childNodes.forEach((childN) => deepDelete(addsSet, childN));\r\n}\r\nfunction isParentRemoved(removes, n, mirror) {\r\n    if (removes.length === 0)\r\n        return false;\r\n    return _isParentRemoved(removes, n, mirror);\r\n}\r\nfunction _isParentRemoved(removes, n, mirror) {\r\n    const { parentNode } = n;\r\n    if (!parentNode) {\r\n        return false;\r\n    }\r\n    const parentId = mirror.getId(parentNode);\r\n    if (removes.some((r) => r.id === parentId)) {\r\n        return true;\r\n    }\r\n    return _isParentRemoved(removes, parentNode, mirror);\r\n}\r\nfunction isAncestorInSet(set, n) {\r\n    if (set.size === 0)\r\n        return false;\r\n    return _isAncestorInSet(set, n);\r\n}\r\nfunction _isAncestorInSet(set, n) {\r\n    const { parentNode } = n;\r\n    if (!parentNode) {\r\n        return false;\r\n    }\r\n    if (set.has(parentNode)) {\r\n        return true;\r\n    }\r\n    return _isAncestorInSet(set, parentNode);\r\n}\n\nexport { MutationBuffer as default };\n","import { maskInputValue } from '../../../rrweb-snapshot/es/rrweb-snapshot.js';\nimport { on, throttle, isBlocked, getWindowHeight, getWindowWidth, hookSetter, patch, isTouchEvent } from '../utils.js';\nimport { MouseInteractions, IncrementalSource } from '../../../types/dist/types.js';\nimport MutationBuffer from './mutation.js';\n\nconst mutationBuffers = [];\r\nconst isCSSGroupingRuleSupported = typeof CSSGroupingRule !== 'undefined';\r\nconst isCSSMediaRuleSupported = typeof CSSMediaRule !== 'undefined';\r\nconst isCSSSupportsRuleSupported = typeof CSSSupportsRule !== 'undefined';\r\nconst isCSSConditionRuleSupported = typeof CSSConditionRule !== 'undefined';\r\nfunction getEventTarget(event) {\r\n    try {\r\n        if ('composedPath' in event) {\r\n            const path = event.composedPath();\r\n            if (path.length) {\r\n                return path[0];\r\n            }\r\n        }\r\n        else if ('path' in event && event.path.length) {\r\n            return event.path[0];\r\n        }\r\n        return event.target;\r\n    }\r\n    catch (_a) {\r\n        return event.target;\r\n    }\r\n}\r\nfunction initMutationObserver(options, rootEl) {\r\n    var _a, _b;\r\n    const mutationBuffer = new MutationBuffer();\r\n    mutationBuffers.push(mutationBuffer);\r\n    mutationBuffer.init(options);\r\n    let mutationObserverCtor = window.MutationObserver ||\r\n        window.__rrMutationObserver;\r\n    const angularZoneSymbol = (_b = (_a = window === null || window === void 0 ? void 0 : window.Zone) === null || _a === void 0 ? void 0 : _a.__symbol__) === null || _b === void 0 ? void 0 : _b.call(_a, 'MutationObserver');\r\n    if (angularZoneSymbol &&\r\n        window[angularZoneSymbol]) {\r\n        mutationObserverCtor = window[angularZoneSymbol];\r\n    }\r\n    const observer = new mutationObserverCtor(mutationBuffer.processMutations.bind(mutationBuffer));\r\n    observer.observe(rootEl, {\r\n        attributes: true,\r\n        attributeOldValue: true,\r\n        characterData: true,\r\n        characterDataOldValue: true,\r\n        childList: true,\r\n        subtree: true,\r\n    });\r\n    return observer;\r\n}\r\nfunction initMoveObserver({ mousemoveCb, sampling, doc, mirror, }) {\r\n    if (sampling.mousemove === false) {\r\n        return () => {\r\n        };\r\n    }\r\n    const threshold = typeof sampling.mousemove === 'number' ? sampling.mousemove : 50;\r\n    const callbackThreshold = typeof sampling.mousemoveCallback === 'number'\r\n        ? sampling.mousemoveCallback\r\n        : 500;\r\n    let positions = [];\r\n    let timeBaseline;\r\n    const wrappedCb = throttle((source) => {\r\n        const totalOffset = Date.now() - timeBaseline;\r\n        mousemoveCb(positions.map((p) => {\r\n            p.timeOffset -= totalOffset;\r\n            return p;\r\n        }), source);\r\n        positions = [];\r\n        timeBaseline = null;\r\n    }, callbackThreshold);\r\n    const updatePosition = throttle((evt) => {\r\n        const target = getEventTarget(evt);\r\n        const { clientX, clientY } = isTouchEvent(evt)\r\n            ? evt.changedTouches[0]\r\n            : evt;\r\n        if (!timeBaseline) {\r\n            timeBaseline = Date.now();\r\n        }\r\n        positions.push({\r\n            x: clientX,\r\n            y: clientY,\r\n            id: mirror.getId(target),\r\n            timeOffset: Date.now() - timeBaseline,\r\n        });\r\n        wrappedCb(typeof DragEvent !== 'undefined' && evt instanceof DragEvent\r\n            ? IncrementalSource.Drag\r\n            : evt instanceof MouseEvent\r\n                ? IncrementalSource.MouseMove\r\n                : IncrementalSource.TouchMove);\r\n    }, threshold, {\r\n        trailing: false,\r\n    });\r\n    const handlers = [\r\n        on('mousemove', updatePosition, doc),\r\n        on('touchmove', updatePosition, doc),\r\n        on('drag', updatePosition, doc),\r\n    ];\r\n    return () => {\r\n        handlers.forEach((h) => h());\r\n    };\r\n}\r\nfunction initMouseInteractionObserver({ mouseInteractionCb, doc, mirror, blockClass, blockSelector, sampling, }) {\r\n    if (sampling.mouseInteraction === false) {\r\n        return () => {\r\n        };\r\n    }\r\n    const disableMap = sampling.mouseInteraction === true ||\r\n        sampling.mouseInteraction === undefined\r\n        ? {}\r\n        : sampling.mouseInteraction;\r\n    const handlers = [];\r\n    const getHandler = (eventKey) => {\r\n        return (event) => {\r\n            const target = getEventTarget(event);\r\n            if (isBlocked(target, blockClass, blockSelector, true)) {\r\n                return;\r\n            }\r\n            const e = isTouchEvent(event) ? event.changedTouches[0] : event;\r\n            if (!e) {\r\n                return;\r\n            }\r\n            const id = mirror.getId(target);\r\n            const { clientX, clientY } = e;\r\n            mouseInteractionCb({\r\n                type: MouseInteractions[eventKey],\r\n                id,\r\n                x: clientX,\r\n                y: clientY,\r\n            });\r\n        };\r\n    };\r\n    Object.keys(MouseInteractions)\r\n        .filter((key) => Number.isNaN(Number(key)) &&\r\n        !key.endsWith('_Departed') &&\r\n        disableMap[key] !== false)\r\n        .forEach((eventKey) => {\r\n        const eventName = eventKey.toLowerCase();\r\n        const handler = getHandler(eventKey);\r\n        handlers.push(on(eventName, handler, doc));\r\n    });\r\n    return () => {\r\n        handlers.forEach((h) => h());\r\n    };\r\n}\r\nfunction initScrollObserver({ scrollCb, doc, mirror, blockClass, blockSelector, sampling, }) {\r\n    const updatePosition = throttle((evt) => {\r\n        const target = getEventTarget(evt);\r\n        if (!target || isBlocked(target, blockClass, blockSelector, true)) {\r\n            return;\r\n        }\r\n        const id = mirror.getId(target);\r\n        if (target === doc) {\r\n            const scrollEl = (doc.scrollingElement || doc.documentElement);\r\n            scrollCb({\r\n                id,\r\n                x: scrollEl.scrollLeft,\r\n                y: scrollEl.scrollTop,\r\n            });\r\n        }\r\n        else {\r\n            scrollCb({\r\n                id,\r\n                x: target.scrollLeft,\r\n                y: target.scrollTop,\r\n            });\r\n        }\r\n    }, sampling.scroll || 100);\r\n    return on('scroll', updatePosition, doc);\r\n}\r\nfunction initViewportResizeObserver({ viewportResizeCb, }) {\r\n    let lastH = -1;\r\n    let lastW = -1;\r\n    const updateDimension = throttle(() => {\r\n        const height = getWindowHeight();\r\n        const width = getWindowWidth();\r\n        if (lastH !== height || lastW !== width) {\r\n            viewportResizeCb({\r\n                width: Number(width),\r\n                height: Number(height),\r\n            });\r\n            lastH = height;\r\n            lastW = width;\r\n        }\r\n    }, 200);\r\n    return on('resize', updateDimension, window);\r\n}\r\nfunction wrapEventWithUserTriggeredFlag(v, enable) {\r\n    const value = Object.assign({}, v);\r\n    if (!enable)\r\n        delete value.userTriggered;\r\n    return value;\r\n}\r\nconst INPUT_TAGS = ['INPUT', 'TEXTAREA', 'SELECT'];\r\nconst lastInputValueMap = new WeakMap();\r\nfunction initInputObserver({ inputCb, doc, mirror, blockClass, blockSelector, ignoreClass, maskInputOptions, maskInputFn, sampling, userTriggeredOnInput, }) {\r\n    function eventHandler(event) {\r\n        let target = getEventTarget(event);\r\n        const userTriggered = event.isTrusted;\r\n        if (target && target.tagName === 'OPTION')\r\n            target = target.parentElement;\r\n        if (!target ||\r\n            !target.tagName ||\r\n            INPUT_TAGS.indexOf(target.tagName) < 0 ||\r\n            isBlocked(target, blockClass, blockSelector, true)) {\r\n            return;\r\n        }\r\n        const type = target.type;\r\n        if (target.classList.contains(ignoreClass)) {\r\n            return;\r\n        }\r\n        let text = target.value;\r\n        let isChecked = false;\r\n        if (type === 'radio' || type === 'checkbox') {\r\n            isChecked = target.checked;\r\n        }\r\n        else if (maskInputOptions[target.tagName.toLowerCase()] ||\r\n            maskInputOptions[type]) {\r\n            text = maskInputValue({\r\n                maskInputOptions,\r\n                tagName: target.tagName,\r\n                type,\r\n                value: text,\r\n                maskInputFn,\r\n            });\r\n        }\r\n        cbWithDedup(target, wrapEventWithUserTriggeredFlag({ text, isChecked, userTriggered }, userTriggeredOnInput));\r\n        const name = target.name;\r\n        if (type === 'radio' && name && isChecked) {\r\n            doc\r\n                .querySelectorAll(`input[type=\"radio\"][name=\"${name}\"]`)\r\n                .forEach((el) => {\r\n                if (el !== target) {\r\n                    cbWithDedup(el, wrapEventWithUserTriggeredFlag({\r\n                        text: el.value,\r\n                        isChecked: !isChecked,\r\n                        userTriggered: false,\r\n                    }, userTriggeredOnInput));\r\n                }\r\n            });\r\n        }\r\n    }\r\n    function cbWithDedup(target, v) {\r\n        const lastInputValue = lastInputValueMap.get(target);\r\n        if (!lastInputValue ||\r\n            lastInputValue.text !== v.text ||\r\n            lastInputValue.isChecked !== v.isChecked) {\r\n            lastInputValueMap.set(target, v);\r\n            const id = mirror.getId(target);\r\n            inputCb(Object.assign(Object.assign({}, v), { id }));\r\n        }\r\n    }\r\n    const events = sampling.input === 'last' ? ['change'] : ['input', 'change'];\r\n    const handlers = events.map((eventName) => on(eventName, eventHandler, doc));\r\n    const currentWindow = doc.defaultView;\r\n    if (!currentWindow) {\r\n        return () => {\r\n            handlers.forEach((h) => h());\r\n        };\r\n    }\r\n    const propertyDescriptor = currentWindow.Object.getOwnPropertyDescriptor(currentWindow.HTMLInputElement.prototype, 'value');\r\n    const hookProperties = [\r\n        [currentWindow.HTMLInputElement.prototype, 'value'],\r\n        [currentWindow.HTMLInputElement.prototype, 'checked'],\r\n        [currentWindow.HTMLSelectElement.prototype, 'value'],\r\n        [currentWindow.HTMLTextAreaElement.prototype, 'value'],\r\n        [currentWindow.HTMLSelectElement.prototype, 'selectedIndex'],\r\n        [currentWindow.HTMLOptionElement.prototype, 'selected'],\r\n    ];\r\n    if (propertyDescriptor && propertyDescriptor.set) {\r\n        handlers.push(...hookProperties.map((p) => hookSetter(p[0], p[1], {\r\n            set() {\r\n                eventHandler({ target: this });\r\n            },\r\n        }, false, currentWindow)));\r\n    }\r\n    return () => {\r\n        handlers.forEach((h) => h());\r\n    };\r\n}\r\nfunction getNestedCSSRulePositions(rule) {\r\n    const positions = [];\r\n    function recurse(childRule, pos) {\r\n        if ((isCSSGroupingRuleSupported &&\r\n            childRule.parentRule instanceof CSSGroupingRule) ||\r\n            (isCSSMediaRuleSupported &&\r\n                childRule.parentRule instanceof CSSMediaRule) ||\r\n            (isCSSSupportsRuleSupported &&\r\n                childRule.parentRule instanceof CSSSupportsRule) ||\r\n            (isCSSConditionRuleSupported &&\r\n                childRule.parentRule instanceof CSSConditionRule)) {\r\n            const rules = Array.from(childRule.parentRule.cssRules);\r\n            const index = rules.indexOf(childRule);\r\n            pos.unshift(index);\r\n        }\r\n        else if (childRule.parentStyleSheet) {\r\n            const rules = Array.from(childRule.parentStyleSheet.cssRules);\r\n            const index = rules.indexOf(childRule);\r\n            pos.unshift(index);\r\n        }\r\n        return pos;\r\n    }\r\n    return recurse(rule, positions);\r\n}\r\nfunction getIdAndStyleId(sheet, mirror, styleMirror) {\r\n    let id, styleId;\r\n    if (!sheet)\r\n        return {};\r\n    if (sheet.ownerNode)\r\n        id = mirror.getId(sheet.ownerNode);\r\n    else\r\n        styleId = styleMirror.getId(sheet);\r\n    return {\r\n        styleId,\r\n        id,\r\n    };\r\n}\r\nfunction initStyleSheetObserver({ styleSheetRuleCb, mirror, stylesheetManager }, { win }) {\r\n    const insertRule = win.CSSStyleSheet.prototype.insertRule;\r\n    win.CSSStyleSheet.prototype.insertRule = function (rule, index) {\r\n        const { id, styleId } = getIdAndStyleId(this, mirror, stylesheetManager.styleMirror);\r\n        if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n            styleSheetRuleCb({\r\n                id,\r\n                styleId,\r\n                adds: [{ rule, index }],\r\n            });\r\n        }\r\n        return insertRule.apply(this, [rule, index]);\r\n    };\r\n    const deleteRule = win.CSSStyleSheet.prototype.deleteRule;\r\n    win.CSSStyleSheet.prototype.deleteRule = function (index) {\r\n        const { id, styleId } = getIdAndStyleId(this, mirror, stylesheetManager.styleMirror);\r\n        if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n            styleSheetRuleCb({\r\n                id,\r\n                styleId,\r\n                removes: [{ index }],\r\n            });\r\n        }\r\n        return deleteRule.apply(this, [index]);\r\n    };\r\n    let replace;\r\n    if (win.CSSStyleSheet.prototype.replace) {\r\n        replace = win.CSSStyleSheet.prototype.replace;\r\n        win.CSSStyleSheet.prototype.replace = function (text) {\r\n            const { id, styleId } = getIdAndStyleId(this, mirror, stylesheetManager.styleMirror);\r\n            if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n                styleSheetRuleCb({\r\n                    id,\r\n                    styleId,\r\n                    replace: text,\r\n                });\r\n            }\r\n            return replace.apply(this, [text]);\r\n        };\r\n    }\r\n    let replaceSync;\r\n    if (win.CSSStyleSheet.prototype.replaceSync) {\r\n        replaceSync = win.CSSStyleSheet.prototype.replaceSync;\r\n        win.CSSStyleSheet.prototype.replaceSync = function (text) {\r\n            const { id, styleId } = getIdAndStyleId(this, mirror, stylesheetManager.styleMirror);\r\n            if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n                styleSheetRuleCb({\r\n                    id,\r\n                    styleId,\r\n                    replaceSync: text,\r\n                });\r\n            }\r\n            return replaceSync.apply(this, [text]);\r\n        };\r\n    }\r\n    const supportedNestedCSSRuleTypes = {};\r\n    if (isCSSGroupingRuleSupported) {\r\n        supportedNestedCSSRuleTypes.CSSGroupingRule = win.CSSGroupingRule;\r\n    }\r\n    else {\r\n        if (isCSSMediaRuleSupported) {\r\n            supportedNestedCSSRuleTypes.CSSMediaRule = win.CSSMediaRule;\r\n        }\r\n        if (isCSSConditionRuleSupported) {\r\n            supportedNestedCSSRuleTypes.CSSConditionRule = win.CSSConditionRule;\r\n        }\r\n        if (isCSSSupportsRuleSupported) {\r\n            supportedNestedCSSRuleTypes.CSSSupportsRule = win.CSSSupportsRule;\r\n        }\r\n    }\r\n    const unmodifiedFunctions = {};\r\n    Object.entries(supportedNestedCSSRuleTypes).forEach(([typeKey, type]) => {\r\n        unmodifiedFunctions[typeKey] = {\r\n            insertRule: type.prototype.insertRule,\r\n            deleteRule: type.prototype.deleteRule,\r\n        };\r\n        type.prototype.insertRule = function (rule, index) {\r\n            const { id, styleId } = getIdAndStyleId(this.parentStyleSheet, mirror, stylesheetManager.styleMirror);\r\n            if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n                styleSheetRuleCb({\r\n                    id,\r\n                    styleId,\r\n                    adds: [\r\n                        {\r\n                            rule,\r\n                            index: [\r\n                                ...getNestedCSSRulePositions(this),\r\n                                index || 0,\r\n                            ],\r\n                        },\r\n                    ],\r\n                });\r\n            }\r\n            return unmodifiedFunctions[typeKey].insertRule.apply(this, [rule, index]);\r\n        };\r\n        type.prototype.deleteRule = function (index) {\r\n            const { id, styleId } = getIdAndStyleId(this.parentStyleSheet, mirror, stylesheetManager.styleMirror);\r\n            if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n                styleSheetRuleCb({\r\n                    id,\r\n                    styleId,\r\n                    removes: [\r\n                        { index: [...getNestedCSSRulePositions(this), index] },\r\n                    ],\r\n                });\r\n            }\r\n            return unmodifiedFunctions[typeKey].deleteRule.apply(this, [index]);\r\n        };\r\n    });\r\n    return () => {\r\n        win.CSSStyleSheet.prototype.insertRule = insertRule;\r\n        win.CSSStyleSheet.prototype.deleteRule = deleteRule;\r\n        replace && (win.CSSStyleSheet.prototype.replace = replace);\r\n        replaceSync && (win.CSSStyleSheet.prototype.replaceSync = replaceSync);\r\n        Object.entries(supportedNestedCSSRuleTypes).forEach(([typeKey, type]) => {\r\n            type.prototype.insertRule = unmodifiedFunctions[typeKey].insertRule;\r\n            type.prototype.deleteRule = unmodifiedFunctions[typeKey].deleteRule;\r\n        });\r\n    };\r\n}\r\nfunction initAdoptedStyleSheetObserver({ mirror, stylesheetManager, }, host) {\r\n    var _a, _b, _c;\r\n    let hostId = null;\r\n    if (host.nodeName === '#document')\r\n        hostId = mirror.getId(host);\r\n    else\r\n        hostId = mirror.getId(host.host);\r\n    const patchTarget = host.nodeName === '#document'\r\n        ? (_a = host.defaultView) === null || _a === void 0 ? void 0 : _a.Document\r\n        : (_c = (_b = host.ownerDocument) === null || _b === void 0 ? void 0 : _b.defaultView) === null || _c === void 0 ? void 0 : _c.ShadowRoot;\r\n    const originalPropertyDescriptor = Object.getOwnPropertyDescriptor(patchTarget === null || patchTarget === void 0 ? void 0 : patchTarget.prototype, 'adoptedStyleSheets');\r\n    if (hostId === null ||\r\n        hostId === -1 ||\r\n        !patchTarget ||\r\n        !originalPropertyDescriptor)\r\n        return () => {\r\n        };\r\n    Object.defineProperty(host, 'adoptedStyleSheets', {\r\n        configurable: originalPropertyDescriptor.configurable,\r\n        enumerable: originalPropertyDescriptor.enumerable,\r\n        get() {\r\n            var _a;\r\n            return (_a = originalPropertyDescriptor.get) === null || _a === void 0 ? void 0 : _a.call(this);\r\n        },\r\n        set(sheets) {\r\n            var _a;\r\n            const result = (_a = originalPropertyDescriptor.set) === null || _a === void 0 ? void 0 : _a.call(this, sheets);\r\n            if (hostId !== null && hostId !== -1) {\r\n                try {\r\n                    stylesheetManager.adoptStyleSheets(sheets, hostId);\r\n                }\r\n                catch (e) {\r\n                }\r\n            }\r\n            return result;\r\n        },\r\n    });\r\n    return () => {\r\n        Object.defineProperty(host, 'adoptedStyleSheets', {\r\n            configurable: originalPropertyDescriptor.configurable,\r\n            enumerable: originalPropertyDescriptor.enumerable,\r\n            get: originalPropertyDescriptor.get,\r\n            set: originalPropertyDescriptor.set,\r\n        });\r\n    };\r\n}\r\nfunction initStyleDeclarationObserver({ styleDeclarationCb, mirror, ignoreCSSAttributes, stylesheetManager, }, { win }) {\r\n    const setProperty = win.CSSStyleDeclaration.prototype.setProperty;\r\n    win.CSSStyleDeclaration.prototype.setProperty = function (property, value, priority) {\r\n        var _a;\r\n        if (ignoreCSSAttributes.has(property)) {\r\n            return setProperty.apply(this, [property, value, priority]);\r\n        }\r\n        const { id, styleId } = getIdAndStyleId((_a = this.parentRule) === null || _a === void 0 ? void 0 : _a.parentStyleSheet, mirror, stylesheetManager.styleMirror);\r\n        if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n            styleDeclarationCb({\r\n                id,\r\n                styleId,\r\n                set: {\r\n                    property,\r\n                    value,\r\n                    priority,\r\n                },\r\n                index: getNestedCSSRulePositions(this.parentRule),\r\n            });\r\n        }\r\n        return setProperty.apply(this, [property, value, priority]);\r\n    };\r\n    const removeProperty = win.CSSStyleDeclaration.prototype.removeProperty;\r\n    win.CSSStyleDeclaration.prototype.removeProperty = function (property) {\r\n        var _a;\r\n        if (ignoreCSSAttributes.has(property)) {\r\n            return removeProperty.apply(this, [property]);\r\n        }\r\n        const { id, styleId } = getIdAndStyleId((_a = this.parentRule) === null || _a === void 0 ? void 0 : _a.parentStyleSheet, mirror, stylesheetManager.styleMirror);\r\n        if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n            styleDeclarationCb({\r\n                id,\r\n                styleId,\r\n                remove: {\r\n                    property,\r\n                },\r\n                index: getNestedCSSRulePositions(this.parentRule),\r\n            });\r\n        }\r\n        return removeProperty.apply(this, [property]);\r\n    };\r\n    return () => {\r\n        win.CSSStyleDeclaration.prototype.setProperty = setProperty;\r\n        win.CSSStyleDeclaration.prototype.removeProperty = removeProperty;\r\n    };\r\n}\r\nfunction initMediaInteractionObserver({ mediaInteractionCb, blockClass, blockSelector, mirror, sampling, }) {\r\n    const handler = (type) => throttle((event) => {\r\n        const target = getEventTarget(event);\r\n        if (!target ||\r\n            isBlocked(target, blockClass, blockSelector, true)) {\r\n            return;\r\n        }\r\n        const { currentTime, volume, muted, playbackRate, } = target;\r\n        mediaInteractionCb({\r\n            type,\r\n            id: mirror.getId(target),\r\n            currentTime,\r\n            volume,\r\n            muted,\r\n            playbackRate,\r\n        });\r\n    }, sampling.media || 500);\r\n    const handlers = [\r\n        on('play', handler(0)),\r\n        on('pause', handler(1)),\r\n        on('seeked', handler(2)),\r\n        on('volumechange', handler(3)),\r\n        on('ratechange', handler(4)),\r\n    ];\r\n    return () => {\r\n        handlers.forEach((h) => h());\r\n    };\r\n}\r\nfunction initFontObserver({ fontCb, doc }) {\r\n    const win = doc.defaultView;\r\n    if (!win) {\r\n        return () => {\r\n        };\r\n    }\r\n    const handlers = [];\r\n    const fontMap = new WeakMap();\r\n    const originalFontFace = win.FontFace;\r\n    win.FontFace = function FontFace(family, source, descriptors) {\r\n        const fontFace = new originalFontFace(family, source, descriptors);\r\n        fontMap.set(fontFace, {\r\n            family,\r\n            buffer: typeof source !== 'string',\r\n            descriptors,\r\n            fontSource: typeof source === 'string'\r\n                ? source\r\n                : JSON.stringify(Array.from(new Uint8Array(source))),\r\n        });\r\n        return fontFace;\r\n    };\r\n    const restoreHandler = patch(doc.fonts, 'add', function (original) {\r\n        return function (fontFace) {\r\n            setTimeout(() => {\r\n                const p = fontMap.get(fontFace);\r\n                if (p) {\r\n                    fontCb(p);\r\n                    fontMap.delete(fontFace);\r\n                }\r\n            }, 0);\r\n            return original.apply(this, [fontFace]);\r\n        };\r\n    });\r\n    handlers.push(() => {\r\n        win.FontFace = originalFontFace;\r\n    });\r\n    handlers.push(restoreHandler);\r\n    return () => {\r\n        handlers.forEach((h) => h());\r\n    };\r\n}\r\nfunction initSelectionObserver(param) {\r\n    const { doc, mirror, blockClass, blockSelector, selectionCb } = param;\r\n    let collapsed = true;\r\n    const updateSelection = () => {\r\n        const selection = doc.getSelection();\r\n        if (!selection || (collapsed && (selection === null || selection === void 0 ? void 0 : selection.isCollapsed)))\r\n            return;\r\n        collapsed = selection.isCollapsed || false;\r\n        const ranges = [];\r\n        const count = selection.rangeCount || 0;\r\n        for (let i = 0; i < count; i++) {\r\n            const range = selection.getRangeAt(i);\r\n            const { startContainer, startOffset, endContainer, endOffset } = range;\r\n            const blocked = isBlocked(startContainer, blockClass, blockSelector, true) ||\r\n                isBlocked(endContainer, blockClass, blockSelector, true);\r\n            if (blocked)\r\n                continue;\r\n            ranges.push({\r\n                start: mirror.getId(startContainer),\r\n                startOffset,\r\n                end: mirror.getId(endContainer),\r\n                endOffset,\r\n            });\r\n        }\r\n        selectionCb({ ranges });\r\n    };\r\n    updateSelection();\r\n    return on('selectionchange', updateSelection);\r\n}\r\nfunction mergeHooks(o, hooks) {\r\n    const { mutationCb, mousemoveCb, mouseInteractionCb, scrollCb, viewportResizeCb, inputCb, mediaInteractionCb, styleSheetRuleCb, styleDeclarationCb, canvasMutationCb, fontCb, selectionCb, } = o;\r\n    o.mutationCb = (...p) => {\r\n        if (hooks.mutation) {\r\n            hooks.mutation(...p);\r\n        }\r\n        mutationCb(...p);\r\n    };\r\n    o.mousemoveCb = (...p) => {\r\n        if (hooks.mousemove) {\r\n            hooks.mousemove(...p);\r\n        }\r\n        mousemoveCb(...p);\r\n    };\r\n    o.mouseInteractionCb = (...p) => {\r\n        if (hooks.mouseInteraction) {\r\n            hooks.mouseInteraction(...p);\r\n        }\r\n        mouseInteractionCb(...p);\r\n    };\r\n    o.scrollCb = (...p) => {\r\n        if (hooks.scroll) {\r\n            hooks.scroll(...p);\r\n        }\r\n        scrollCb(...p);\r\n    };\r\n    o.viewportResizeCb = (...p) => {\r\n        if (hooks.viewportResize) {\r\n            hooks.viewportResize(...p);\r\n        }\r\n        viewportResizeCb(...p);\r\n    };\r\n    o.inputCb = (...p) => {\r\n        if (hooks.input) {\r\n            hooks.input(...p);\r\n        }\r\n        inputCb(...p);\r\n    };\r\n    o.mediaInteractionCb = (...p) => {\r\n        if (hooks.mediaInteaction) {\r\n            hooks.mediaInteaction(...p);\r\n        }\r\n        mediaInteractionCb(...p);\r\n    };\r\n    o.styleSheetRuleCb = (...p) => {\r\n        if (hooks.styleSheetRule) {\r\n            hooks.styleSheetRule(...p);\r\n        }\r\n        styleSheetRuleCb(...p);\r\n    };\r\n    o.styleDeclarationCb = (...p) => {\r\n        if (hooks.styleDeclaration) {\r\n            hooks.styleDeclaration(...p);\r\n        }\r\n        styleDeclarationCb(...p);\r\n    };\r\n    o.canvasMutationCb = (...p) => {\r\n        if (hooks.canvasMutation) {\r\n            hooks.canvasMutation(...p);\r\n        }\r\n        canvasMutationCb(...p);\r\n    };\r\n    o.fontCb = (...p) => {\r\n        if (hooks.font) {\r\n            hooks.font(...p);\r\n        }\r\n        fontCb(...p);\r\n    };\r\n    o.selectionCb = (...p) => {\r\n        if (hooks.selection) {\r\n            hooks.selection(...p);\r\n        }\r\n        selectionCb(...p);\r\n    };\r\n}\r\nfunction initObservers(o, hooks = {}) {\r\n    const currentWindow = o.doc.defaultView;\r\n    if (!currentWindow) {\r\n        return () => {\r\n        };\r\n    }\r\n    mergeHooks(o, hooks);\r\n    const mutationObserver = initMutationObserver(o, o.doc);\r\n    const mousemoveHandler = initMoveObserver(o);\r\n    const mouseInteractionHandler = initMouseInteractionObserver(o);\r\n    const scrollHandler = initScrollObserver(o);\r\n    const viewportResizeHandler = initViewportResizeObserver(o);\r\n    const inputHandler = initInputObserver(o);\r\n    const mediaInteractionHandler = initMediaInteractionObserver(o);\r\n    const styleSheetObserver = initStyleSheetObserver(o, { win: currentWindow });\r\n    const adoptedStyleSheetObserver = initAdoptedStyleSheetObserver(o, o.doc);\r\n    const styleDeclarationObserver = initStyleDeclarationObserver(o, {\r\n        win: currentWindow,\r\n    });\r\n    const fontObserver = o.collectFonts\r\n        ? initFontObserver(o)\r\n        : () => {\r\n        };\r\n    const selectionObserver = initSelectionObserver(o);\r\n    const pluginHandlers = [];\r\n    for (const plugin of o.plugins) {\r\n        pluginHandlers.push(plugin.observer(plugin.callback, currentWindow, plugin.options));\r\n    }\r\n    return () => {\r\n        mutationBuffers.forEach((b) => b.reset());\r\n        mutationObserver.disconnect();\r\n        mousemoveHandler();\r\n        mouseInteractionHandler();\r\n        scrollHandler();\r\n        viewportResizeHandler();\r\n        inputHandler();\r\n        mediaInteractionHandler();\r\n        styleSheetObserver();\r\n        adoptedStyleSheetObserver();\r\n        styleDeclarationObserver();\r\n        fontObserver();\r\n        selectionObserver();\r\n        pluginHandlers.forEach((h) => h());\r\n    };\r\n}\n\nexport { INPUT_TAGS, initAdoptedStyleSheetObserver, initMutationObserver, initObservers, initScrollObserver, mutationBuffers };\n","class CrossOriginIframeMirror {\r\n    constructor(generateIdFn) {\r\n        this.generateIdFn = generateIdFn;\r\n        this.iframeIdToRemoteIdMap = new WeakMap();\r\n        this.iframeRemoteIdToIdMap = new WeakMap();\r\n    }\r\n    getId(iframe, remoteId, idToRemoteMap, remoteToIdMap) {\r\n        const idToRemoteIdMap = idToRemoteMap || this.getIdToRemoteIdMap(iframe);\r\n        const remoteIdToIdMap = remoteToIdMap || this.getRemoteIdToIdMap(iframe);\r\n        let id = idToRemoteIdMap.get(remoteId);\r\n        if (!id) {\r\n            id = this.generateIdFn();\r\n            idToRemoteIdMap.set(remoteId, id);\r\n            remoteIdToIdMap.set(id, remoteId);\r\n        }\r\n        return id;\r\n    }\r\n    getIds(iframe, remoteId) {\r\n        const idToRemoteIdMap = this.getIdToRemoteIdMap(iframe);\r\n        const remoteIdToIdMap = this.getRemoteIdToIdMap(iframe);\r\n        return remoteId.map((id) => this.getId(iframe, id, idToRemoteIdMap, remoteIdToIdMap));\r\n    }\r\n    getRemoteId(iframe, id, map) {\r\n        const remoteIdToIdMap = map || this.getRemoteIdToIdMap(iframe);\r\n        if (typeof id !== 'number')\r\n            return id;\r\n        const remoteId = remoteIdToIdMap.get(id);\r\n        if (!remoteId)\r\n            return -1;\r\n        return remoteId;\r\n    }\r\n    getRemoteIds(iframe, ids) {\r\n        const remoteIdToIdMap = this.getRemoteIdToIdMap(iframe);\r\n        return ids.map((id) => this.getRemoteId(iframe, id, remoteIdToIdMap));\r\n    }\r\n    reset(iframe) {\r\n        if (!iframe) {\r\n            this.iframeIdToRemoteIdMap = new WeakMap();\r\n            this.iframeRemoteIdToIdMap = new WeakMap();\r\n            return;\r\n        }\r\n        this.iframeIdToRemoteIdMap.delete(iframe);\r\n        this.iframeRemoteIdToIdMap.delete(iframe);\r\n    }\r\n    getIdToRemoteIdMap(iframe) {\r\n        let idToRemoteIdMap = this.iframeIdToRemoteIdMap.get(iframe);\r\n        if (!idToRemoteIdMap) {\r\n            idToRemoteIdMap = new Map();\r\n            this.iframeIdToRemoteIdMap.set(iframe, idToRemoteIdMap);\r\n        }\r\n        return idToRemoteIdMap;\r\n    }\r\n    getRemoteIdToIdMap(iframe) {\r\n        let remoteIdToIdMap = this.iframeRemoteIdToIdMap.get(iframe);\r\n        if (!remoteIdToIdMap) {\r\n            remoteIdToIdMap = new Map();\r\n            this.iframeRemoteIdToIdMap.set(iframe, remoteIdToIdMap);\r\n        }\r\n        return remoteIdToIdMap;\r\n    }\r\n}\n\nexport { CrossOriginIframeMirror as default };\n","import { genId } from '../../../rrweb-snapshot/es/rrweb-snapshot.js';\nimport CrossOriginIframeMirror from './cross-origin-iframe-mirror.js';\nimport { EventType, IncrementalSource } from '../../../types/dist/types.js';\n\nclass IframeManager {\r\n    constructor(options) {\r\n        this.iframes = new WeakMap();\r\n        this.crossOriginIframeMap = new WeakMap();\r\n        this.crossOriginIframeMirror = new CrossOriginIframeMirror(genId);\r\n        this.mutationCb = options.mutationCb;\r\n        this.wrappedEmit = options.wrappedEmit;\r\n        this.stylesheetManager = options.stylesheetManager;\r\n        this.recordCrossOriginIframes = options.recordCrossOriginIframes;\r\n        this.crossOriginIframeStyleMirror = new CrossOriginIframeMirror(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror));\r\n        this.mirror = options.mirror;\r\n        if (this.recordCrossOriginIframes) {\r\n            window.addEventListener('message', this.handleMessage.bind(this));\r\n        }\r\n    }\r\n    addIframe(iframeEl) {\r\n        this.iframes.set(iframeEl, true);\r\n        if (iframeEl.contentWindow)\r\n            this.crossOriginIframeMap.set(iframeEl.contentWindow, iframeEl);\r\n    }\r\n    addLoadListener(cb) {\r\n        this.loadListener = cb;\r\n    }\r\n    attachIframe(iframeEl, childSn) {\r\n        var _a;\r\n        this.mutationCb({\r\n            adds: [\r\n                {\r\n                    parentId: this.mirror.getId(iframeEl),\r\n                    nextId: null,\r\n                    node: childSn,\r\n                },\r\n            ],\r\n            removes: [],\r\n            texts: [],\r\n            attributes: [],\r\n            isAttachIframe: true,\r\n        });\r\n        (_a = this.loadListener) === null || _a === void 0 ? void 0 : _a.call(this, iframeEl);\r\n        if (iframeEl.contentDocument &&\r\n            iframeEl.contentDocument.adoptedStyleSheets &&\r\n            iframeEl.contentDocument.adoptedStyleSheets.length > 0)\r\n            this.stylesheetManager.adoptStyleSheets(iframeEl.contentDocument.adoptedStyleSheets, this.mirror.getId(iframeEl.contentDocument));\r\n    }\r\n    handleMessage(message) {\r\n        if (message.data.type === 'rrweb') {\r\n            const iframeSourceWindow = message.source;\r\n            if (!iframeSourceWindow)\r\n                return;\r\n            const iframeEl = this.crossOriginIframeMap.get(message.source);\r\n            if (!iframeEl)\r\n                return;\r\n            const transformedEvent = this.transformCrossOriginEvent(iframeEl, message.data.event);\r\n            if (transformedEvent)\r\n                this.wrappedEmit(transformedEvent, message.data.isCheckout);\r\n        }\r\n    }\r\n    transformCrossOriginEvent(iframeEl, e) {\r\n        var _a;\r\n        switch (e.type) {\r\n            case EventType.FullSnapshot: {\r\n                this.crossOriginIframeMirror.reset(iframeEl);\r\n                this.crossOriginIframeStyleMirror.reset(iframeEl);\r\n                this.replaceIdOnNode(e.data.node, iframeEl);\r\n                return {\r\n                    timestamp: e.timestamp,\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: {\r\n                        source: IncrementalSource.Mutation,\r\n                        adds: [\r\n                            {\r\n                                parentId: this.mirror.getId(iframeEl),\r\n                                nextId: null,\r\n                                node: e.data.node,\r\n                            },\r\n                        ],\r\n                        removes: [],\r\n                        texts: [],\r\n                        attributes: [],\r\n                        isAttachIframe: true,\r\n                    },\r\n                };\r\n            }\r\n            case EventType.Meta:\r\n            case EventType.Load:\r\n            case EventType.DomContentLoaded: {\r\n                return false;\r\n            }\r\n            case EventType.Plugin: {\r\n                return e;\r\n            }\r\n            case EventType.Custom: {\r\n                this.replaceIds(e.data.payload, iframeEl, ['id', 'parentId', 'previousId', 'nextId']);\r\n                return e;\r\n            }\r\n            case EventType.IncrementalSnapshot: {\r\n                switch (e.data.source) {\r\n                    case IncrementalSource.Mutation: {\r\n                        e.data.adds.forEach((n) => {\r\n                            this.replaceIds(n, iframeEl, [\r\n                                'parentId',\r\n                                'nextId',\r\n                                'previousId',\r\n                            ]);\r\n                            this.replaceIdOnNode(n.node, iframeEl);\r\n                        });\r\n                        e.data.removes.forEach((n) => {\r\n                            this.replaceIds(n, iframeEl, ['parentId', 'id']);\r\n                        });\r\n                        e.data.attributes.forEach((n) => {\r\n                            this.replaceIds(n, iframeEl, ['id']);\r\n                        });\r\n                        e.data.texts.forEach((n) => {\r\n                            this.replaceIds(n, iframeEl, ['id']);\r\n                        });\r\n                        return e;\r\n                    }\r\n                    case IncrementalSource.Drag:\r\n                    case IncrementalSource.TouchMove:\r\n                    case IncrementalSource.MouseMove: {\r\n                        e.data.positions.forEach((p) => {\r\n                            this.replaceIds(p, iframeEl, ['id']);\r\n                        });\r\n                        return e;\r\n                    }\r\n                    case IncrementalSource.ViewportResize: {\r\n                        return false;\r\n                    }\r\n                    case IncrementalSource.MediaInteraction:\r\n                    case IncrementalSource.MouseInteraction:\r\n                    case IncrementalSource.Scroll:\r\n                    case IncrementalSource.CanvasMutation:\r\n                    case IncrementalSource.Input: {\r\n                        this.replaceIds(e.data, iframeEl, ['id']);\r\n                        return e;\r\n                    }\r\n                    case IncrementalSource.StyleSheetRule:\r\n                    case IncrementalSource.StyleDeclaration: {\r\n                        this.replaceIds(e.data, iframeEl, ['id']);\r\n                        this.replaceStyleIds(e.data, iframeEl, ['styleId']);\r\n                        return e;\r\n                    }\r\n                    case IncrementalSource.Font: {\r\n                        return e;\r\n                    }\r\n                    case IncrementalSource.Selection: {\r\n                        e.data.ranges.forEach((range) => {\r\n                            this.replaceIds(range, iframeEl, ['start', 'end']);\r\n                        });\r\n                        return e;\r\n                    }\r\n                    case IncrementalSource.AdoptedStyleSheet: {\r\n                        this.replaceIds(e.data, iframeEl, ['id']);\r\n                        this.replaceStyleIds(e.data, iframeEl, ['styleIds']);\r\n                        (_a = e.data.styles) === null || _a === void 0 ? void 0 : _a.forEach((style) => {\r\n                            this.replaceStyleIds(style, iframeEl, ['styleId']);\r\n                        });\r\n                        return e;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    replace(iframeMirror, obj, iframeEl, keys) {\r\n        for (const key of keys) {\r\n            if (!Array.isArray(obj[key]) && typeof obj[key] !== 'number')\r\n                continue;\r\n            if (Array.isArray(obj[key])) {\r\n                obj[key] = iframeMirror.getIds(iframeEl, obj[key]);\r\n            }\r\n            else {\r\n                obj[key] = iframeMirror.getId(iframeEl, obj[key]);\r\n            }\r\n        }\r\n        return obj;\r\n    }\r\n    replaceIds(obj, iframeEl, keys) {\r\n        return this.replace(this.crossOriginIframeMirror, obj, iframeEl, keys);\r\n    }\r\n    replaceStyleIds(obj, iframeEl, keys) {\r\n        return this.replace(this.crossOriginIframeStyleMirror, obj, iframeEl, keys);\r\n    }\r\n    replaceIdOnNode(node, iframeEl) {\r\n        this.replaceIds(node, iframeEl, ['id']);\r\n        if ('childNodes' in node) {\r\n            node.childNodes.forEach((child) => {\r\n                this.replaceIdOnNode(child, iframeEl);\r\n            });\r\n        }\r\n    }\r\n}\n\nexport { IframeManager };\n","import { initMutationObserver, initScrollObserver, initAdoptedStyleSheetObserver } from './observer.js';\nimport { patch } from '../utils.js';\nimport { isNativeShadowDom } from '../../../rrweb-snapshot/es/rrweb-snapshot.js';\n\nclass ShadowDomManager {\r\n    constructor(options) {\r\n        this.shadowDoms = new WeakSet();\r\n        this.restorePatches = [];\r\n        this.mutationCb = options.mutationCb;\r\n        this.scrollCb = options.scrollCb;\r\n        this.bypassOptions = options.bypassOptions;\r\n        this.mirror = options.mirror;\r\n        const manager = this;\r\n        this.restorePatches.push(patch(Element.prototype, 'attachShadow', function (original) {\r\n            return function (option) {\r\n                const shadowRoot = original.call(this, option);\r\n                if (this.shadowRoot)\r\n                    manager.addShadowRoot(this.shadowRoot, this.ownerDocument);\r\n                return shadowRoot;\r\n            };\r\n        }));\r\n    }\r\n    addShadowRoot(shadowRoot, doc) {\r\n        if (!isNativeShadowDom(shadowRoot))\r\n            return;\r\n        if (this.shadowDoms.has(shadowRoot))\r\n            return;\r\n        this.shadowDoms.add(shadowRoot);\r\n        initMutationObserver(Object.assign(Object.assign({}, this.bypassOptions), { doc, mutationCb: this.mutationCb, mirror: this.mirror, shadowDomManager: this }), shadowRoot);\r\n        initScrollObserver(Object.assign(Object.assign({}, this.bypassOptions), { scrollCb: this.scrollCb, doc: shadowRoot, mirror: this.mirror }));\r\n        setTimeout(() => {\r\n            if (shadowRoot.adoptedStyleSheets &&\r\n                shadowRoot.adoptedStyleSheets.length > 0)\r\n                this.bypassOptions.stylesheetManager.adoptStyleSheets(shadowRoot.adoptedStyleSheets, this.mirror.getId(shadowRoot.host));\r\n            initAdoptedStyleSheetObserver({\r\n                mirror: this.mirror,\r\n                stylesheetManager: this.bypassOptions.stylesheetManager,\r\n            }, shadowRoot);\r\n        }, 0);\r\n    }\r\n    observeAttachShadow(iframeElement) {\r\n        if (iframeElement.contentWindow) {\r\n            const manager = this;\r\n            this.restorePatches.push(patch(iframeElement.contentWindow.HTMLElement.prototype, 'attachShadow', function (original) {\r\n                return function (option) {\r\n                    const shadowRoot = original.call(this, option);\r\n                    if (this.shadowRoot)\r\n                        manager.addShadowRoot(this.shadowRoot, iframeElement.contentDocument);\r\n                    return shadowRoot;\r\n                };\r\n            }));\r\n        }\r\n    }\r\n    reset() {\r\n        this.restorePatches.forEach((restorePatch) => restorePatch());\r\n        this.shadowDoms = new WeakSet();\r\n    }\r\n}\n\nexport { ShadowDomManager };\n","/*\n * base64-arraybuffer 1.0.1 <https://github.com/niklasvh/base64-arraybuffer>\n * Copyright (c) 2021 Niklas von Hertzen <https://hertzen.com>\n * Released under MIT License\n */\nvar chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n// Use a lookup table to find the index.\nvar lookup = typeof Uint8Array === 'undefined' ? [] : new Uint8Array(256);\nfor (var i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n}\nvar encode = function (arraybuffer) {\n    var bytes = new Uint8Array(arraybuffer), i, len = bytes.length, base64 = '';\n    for (i = 0; i < len; i += 3) {\n        base64 += chars[bytes[i] >> 2];\n        base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n        base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n        base64 += chars[bytes[i + 2] & 63];\n    }\n    if (len % 3 === 2) {\n        base64 = base64.substring(0, base64.length - 1) + '=';\n    }\n    else if (len % 3 === 1) {\n        base64 = base64.substring(0, base64.length - 2) + '==';\n    }\n    return base64;\n};\nvar decode = function (base64) {\n    var bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;\n    if (base64[base64.length - 1] === '=') {\n        bufferLength--;\n        if (base64[base64.length - 2] === '=') {\n            bufferLength--;\n        }\n    }\n    var arraybuffer = new ArrayBuffer(bufferLength), bytes = new Uint8Array(arraybuffer);\n    for (i = 0; i < len; i += 4) {\n        encoded1 = lookup[base64.charCodeAt(i)];\n        encoded2 = lookup[base64.charCodeAt(i + 1)];\n        encoded3 = lookup[base64.charCodeAt(i + 2)];\n        encoded4 = lookup[base64.charCodeAt(i + 3)];\n        bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n        bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n        bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n    return arraybuffer;\n};\n\nexport { decode, encode };\n","import { encode } from './../../../../../../ext/base64-arraybuffer/dist/base64-arraybuffer.es5.js';\n\nconst canvasVarMap = new Map();\r\nfunction variableListFor(ctx, ctor) {\r\n    let contextMap = canvasVarMap.get(ctx);\r\n    if (!contextMap) {\r\n        contextMap = new Map();\r\n        canvasVarMap.set(ctx, contextMap);\r\n    }\r\n    if (!contextMap.has(ctor)) {\r\n        contextMap.set(ctor, []);\r\n    }\r\n    return contextMap.get(ctor);\r\n}\r\nconst saveWebGLVar = (value, win, ctx) => {\r\n    if (!value ||\r\n        !(isInstanceOfWebGLObject(value, win) || typeof value === 'object'))\r\n        return;\r\n    const name = value.constructor.name;\r\n    const list = variableListFor(ctx, name);\r\n    let index = list.indexOf(value);\r\n    if (index === -1) {\r\n        index = list.length;\r\n        list.push(value);\r\n    }\r\n    return index;\r\n};\r\nfunction serializeArg(value, win, ctx) {\r\n    if (value instanceof Array) {\r\n        return value.map((arg) => serializeArg(arg, win, ctx));\r\n    }\r\n    else if (value === null) {\r\n        return value;\r\n    }\r\n    else if (value instanceof Float32Array ||\r\n        value instanceof Float64Array ||\r\n        value instanceof Int32Array ||\r\n        value instanceof Uint32Array ||\r\n        value instanceof Uint8Array ||\r\n        value instanceof Uint16Array ||\r\n        value instanceof Int16Array ||\r\n        value instanceof Int8Array ||\r\n        value instanceof Uint8ClampedArray) {\r\n        const name = value.constructor.name;\r\n        return {\r\n            rr_type: name,\r\n            args: [Object.values(value)],\r\n        };\r\n    }\r\n    else if (value instanceof ArrayBuffer) {\r\n        const name = value.constructor.name;\r\n        const base64 = encode(value);\r\n        return {\r\n            rr_type: name,\r\n            base64,\r\n        };\r\n    }\r\n    else if (value instanceof DataView) {\r\n        const name = value.constructor.name;\r\n        return {\r\n            rr_type: name,\r\n            args: [\r\n                serializeArg(value.buffer, win, ctx),\r\n                value.byteOffset,\r\n                value.byteLength,\r\n            ],\r\n        };\r\n    }\r\n    else if (value instanceof HTMLImageElement) {\r\n        const name = value.constructor.name;\r\n        const { src } = value;\r\n        return {\r\n            rr_type: name,\r\n            src,\r\n        };\r\n    }\r\n    else if (value instanceof HTMLCanvasElement) {\r\n        const name = 'HTMLImageElement';\r\n        const src = value.toDataURL();\r\n        return {\r\n            rr_type: name,\r\n            src,\r\n        };\r\n    }\r\n    else if (value instanceof ImageData) {\r\n        const name = value.constructor.name;\r\n        return {\r\n            rr_type: name,\r\n            args: [serializeArg(value.data, win, ctx), value.width, value.height],\r\n        };\r\n    }\r\n    else if (isInstanceOfWebGLObject(value, win) || typeof value === 'object') {\r\n        const name = value.constructor.name;\r\n        const index = saveWebGLVar(value, win, ctx);\r\n        return {\r\n            rr_type: name,\r\n            index: index,\r\n        };\r\n    }\r\n    return value;\r\n}\r\nconst serializeArgs = (args, win, ctx) => {\r\n    return [...args].map((arg) => serializeArg(arg, win, ctx));\r\n};\r\nconst isInstanceOfWebGLObject = (value, win) => {\r\n    const webGLConstructorNames = [\r\n        'WebGLActiveInfo',\r\n        'WebGLBuffer',\r\n        'WebGLFramebuffer',\r\n        'WebGLProgram',\r\n        'WebGLRenderbuffer',\r\n        'WebGLShader',\r\n        'WebGLShaderPrecisionFormat',\r\n        'WebGLTexture',\r\n        'WebGLUniformLocation',\r\n        'WebGLVertexArrayObject',\r\n        'WebGLVertexArrayObjectOES',\r\n    ];\r\n    const supportedWebGLConstructorNames = webGLConstructorNames.filter((name) => typeof win[name] === 'function');\r\n    return Boolean(supportedWebGLConstructorNames.find((name) => value instanceof win[name]));\r\n};\n\nexport { isInstanceOfWebGLObject, saveWebGLVar, serializeArg, serializeArgs, variableListFor };\n","import { patch, isBlocked } from '../../../utils.js';\n\nfunction initCanvasContextObserver(win, blockClass, blockSelector) {\r\n    const handlers = [];\r\n    try {\r\n        const restoreHandler = patch(win.HTMLCanvasElement.prototype, 'getContext', function (original) {\r\n            return function (contextType, ...args) {\r\n                if (!isBlocked(this, blockClass, blockSelector, true)) {\r\n                    if (!('__context' in this))\r\n                        this.__context = contextType;\r\n                }\r\n                return original.apply(this, [contextType, ...args]);\r\n            };\r\n        });\r\n        handlers.push(restoreHandler);\r\n    }\r\n    catch (_a) {\r\n        console.error('failed to patch HTMLCanvasElement.prototype.getContext');\r\n    }\r\n    return () => {\r\n        handlers.forEach((h) => h());\r\n    };\r\n}\n\nexport { initCanvasContextObserver as default };\n","import { CanvasContext } from '../../../../../types/dist/types.js';\nimport { patch, isBlocked, hookSetter } from '../../../utils.js';\nimport { saveWebGLVar, serializeArgs } from './serialize-args.js';\n\nfunction patchGLPrototype(prototype, type, cb, blockClass, blockSelector, mirror, win) {\r\n    const handlers = [];\r\n    const props = Object.getOwnPropertyNames(prototype);\r\n    for (const prop of props) {\r\n        if ([\r\n            'isContextLost',\r\n            'canvas',\r\n            'drawingBufferWidth',\r\n            'drawingBufferHeight',\r\n        ].includes(prop)) {\r\n            continue;\r\n        }\r\n        try {\r\n            if (typeof prototype[prop] !== 'function') {\r\n                continue;\r\n            }\r\n            const restoreHandler = patch(prototype, prop, function (original) {\r\n                return function (...args) {\r\n                    const result = original.apply(this, args);\r\n                    saveWebGLVar(result, win, this);\r\n                    if (!isBlocked(this.canvas, blockClass, blockSelector, true)) {\r\n                        const recordArgs = serializeArgs([...args], win, this);\r\n                        const mutation = {\r\n                            type,\r\n                            property: prop,\r\n                            args: recordArgs,\r\n                        };\r\n                        cb(this.canvas, mutation);\r\n                    }\r\n                    return result;\r\n                };\r\n            });\r\n            handlers.push(restoreHandler);\r\n        }\r\n        catch (_a) {\r\n            const hookHandler = hookSetter(prototype, prop, {\r\n                set(v) {\r\n                    cb(this.canvas, {\r\n                        type,\r\n                        property: prop,\r\n                        args: [v],\r\n                        setter: true,\r\n                    });\r\n                },\r\n            });\r\n            handlers.push(hookHandler);\r\n        }\r\n    }\r\n    return handlers;\r\n}\r\nfunction initCanvasWebGLMutationObserver(cb, win, blockClass, blockSelector, mirror) {\r\n    const handlers = [];\r\n    handlers.push(...patchGLPrototype(win.WebGLRenderingContext.prototype, CanvasContext.WebGL, cb, blockClass, blockSelector, mirror, win));\r\n    if (typeof win.WebGL2RenderingContext !== 'undefined') {\r\n        handlers.push(...patchGLPrototype(win.WebGL2RenderingContext.prototype, CanvasContext.WebGL2, cb, blockClass, blockSelector, mirror, win));\r\n    }\r\n    return () => {\r\n        handlers.forEach((h) => h());\r\n    };\r\n}\n\nexport { initCanvasWebGLMutationObserver as default };\n","var WorkerClass = null;\n\ntry {\n    var WorkerThreads =\n        typeof module !== 'undefined' && typeof module.require === 'function' && module.require('worker_threads') ||\n        typeof __non_webpack_require__ === 'function' && __non_webpack_require__('worker_threads') ||\n        typeof require === 'function' && require('worker_threads');\n    WorkerClass = WorkerThreads.Worker;\n} catch(e) {} // eslint-disable-line\n\nexport { WorkerClass };\n","var kIsNodeJS = Object.prototype.toString.call(typeof process !== 'undefined' ? process : 0) === '[object process]';\n\nfunction isNodeJS() {\n    return kIsNodeJS;\n}\n\nexport { isNodeJS };\n","import { createBase64WorkerFactory as createBase64WorkerFactory$1 } from './_rollup-plugin-web-worker-loader__helper__node__createBase64WorkerFactory.js';\nimport { createBase64WorkerFactory as createBase64WorkerFactory$2 } from './_rollup-plugin-web-worker-loader__helper__browser__createBase64WorkerFactory.js';\nimport { isNodeJS } from './_rollup-plugin-web-worker-loader__helper__auto__isNodeJS.js';\n\nfunction createBase64WorkerFactory(base64, sourcemapArg, enableUnicodeArg) {\n    if (isNodeJS()) {\n        return createBase64WorkerFactory$1(base64, sourcemapArg, enableUnicodeArg);\n    }\n    return createBase64WorkerFactory$2(base64, sourcemapArg, enableUnicodeArg);\n}\n\nexport { createBase64WorkerFactory };\n","import { createBase64WorkerFactory } from './_rollup-plugin-web-worker-loader__helper__auto__createBase64WorkerFactory.js';\n\nvar WorkerFactory = createBase64WorkerFactory('Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICAgJ3VzZSBzdHJpY3QnOwoKICAgIC8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KICAgIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLg0KDQogICAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55DQogICAgcHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLg0KDQogICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEgNCiAgICBSRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkNCiAgICBBTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsDQogICAgSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NDQogICAgTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1INCiAgICBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SDQogICAgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4NCiAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqLw0KDQogICAgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikgew0KICAgICAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH0NCiAgICAgICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvclsidGhyb3ciXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfQ0KICAgICAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpOw0KICAgICAgICB9KTsNCiAgICB9CgogICAgLyoKICAgICAqIGJhc2U2NC1hcnJheWJ1ZmZlciAxLjAuMSA8aHR0cHM6Ly9naXRodWIuY29tL25pa2xhc3ZoL2Jhc2U2NC1hcnJheWJ1ZmZlcj4KICAgICAqIENvcHlyaWdodCAoYykgMjAyMSBOaWtsYXMgdm9uIEhlcnR6ZW4gPGh0dHBzOi8vaGVydHplbi5jb20+CiAgICAgKiBSZWxlYXNlZCB1bmRlciBNSVQgTGljZW5zZQogICAgICovCiAgICB2YXIgY2hhcnMgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyc7CiAgICAvLyBVc2UgYSBsb29rdXAgdGFibGUgdG8gZmluZCB0aGUgaW5kZXguCiAgICB2YXIgbG9va3VwID0gdHlwZW9mIFVpbnQ4QXJyYXkgPT09ICd1bmRlZmluZWQnID8gW10gOiBuZXcgVWludDhBcnJheSgyNTYpOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFycy5sZW5ndGg7IGkrKykgewogICAgICAgIGxvb2t1cFtjaGFycy5jaGFyQ29kZUF0KGkpXSA9IGk7CiAgICB9CiAgICB2YXIgZW5jb2RlID0gZnVuY3Rpb24gKGFycmF5YnVmZmVyKSB7CiAgICAgICAgdmFyIGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlidWZmZXIpLCBpLCBsZW4gPSBieXRlcy5sZW5ndGgsIGJhc2U2NCA9ICcnOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkgKz0gMykgewogICAgICAgICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaV0gPj4gMl07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1soKGJ5dGVzW2ldICYgMykgPDwgNCkgfCAoYnl0ZXNbaSArIDFdID4+IDQpXTsKICAgICAgICAgICAgYmFzZTY0ICs9IGNoYXJzWygoYnl0ZXNbaSArIDFdICYgMTUpIDw8IDIpIHwgKGJ5dGVzW2kgKyAyXSA+PiA2KV07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1tieXRlc1tpICsgMl0gJiA2M107CiAgICAgICAgfQogICAgICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgJz0nOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgJz09JzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGJhc2U2NDsKICAgIH07CgogICAgY29uc3QgbGFzdEJsb2JNYXAgPSBuZXcgTWFwKCk7DQogICAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gbmV3IE1hcCgpOw0KICAgIGZ1bmN0aW9uIGdldFRyYW5zcGFyZW50QmxvYkZvcih3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucykgew0KICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkgew0KICAgICAgICAgICAgY29uc3QgaWQgPSBgJHt3aWR0aH0tJHtoZWlnaHR9YDsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgaWYgKHRyYW5zcGFyZW50QmxvYk1hcC5oYXMoaWQpKQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNwYXJlbnRCbG9iTWFwLmdldChpZCk7DQogICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsNCiAgICAgICAgICAgICAgICBvZmZzY3JlZW4uZ2V0Q29udGV4dCgnMmQnKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0geWllbGQgYmxvYi5hcnJheUJ1ZmZlcigpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7DQogICAgICAgICAgICAgICAgdHJhbnNwYXJlbnRCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICByZXR1cm4gYmFzZTY0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQogICAgY29uc3Qgd29ya2VyID0gc2VsZjsNCiAgICB3b3JrZXIub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgY29uc3QgeyBpZCwgYml0bWFwLCB3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucyB9ID0gZS5kYXRhOw0KICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zKTsNCiAgICAgICAgICAgICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGN0eCA9IG9mZnNjcmVlbi5nZXRDb250ZXh0KCcyZCcpOw0KICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoYml0bWFwLCAwLCAwKTsNCiAgICAgICAgICAgICAgICBiaXRtYXAuY2xvc2UoKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBibG9iLnR5cGU7DQogICAgICAgICAgICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSB5aWVsZCBibG9iLmFycmF5QnVmZmVyKCk7DQogICAgICAgICAgICAgICAgY29uc3QgYmFzZTY0ID0gZW5jb2RlKGFycmF5QnVmZmVyKTsNCiAgICAgICAgICAgICAgICBpZiAoIWxhc3RCbG9iTWFwLmhhcyhpZCkgJiYgKHlpZWxkIHRyYW5zcGFyZW50QmFzZTY0KSA9PT0gYmFzZTY0KSB7DQogICAgICAgICAgICAgICAgICAgIGxhc3RCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7DQogICAgICAgICAgICAgICAgd29ya2VyLnBvc3RNZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgaWQsDQogICAgICAgICAgICAgICAgICAgIHR5cGUsDQogICAgICAgICAgICAgICAgICAgIGJhc2U2NCwNCiAgICAgICAgICAgICAgICAgICAgd2lkdGgsDQogICAgICAgICAgICAgICAgICAgIGhlaWdodCwNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfTsKCn0pKCk7Cgo=', null, false);\n/* eslint-enable */\n\nexport { WorkerFactory as default };\n","import { WorkerClass } from './_rollup-plugin-web-worker-loader__helper__node__WorkerClass.js';\n\nfunction decodeBase64(base64, enableUnicode) {\n    return Buffer.from(base64, 'base64').toString(enableUnicode ? 'utf16' : 'utf8');\n}\n\nfunction createBase64WorkerFactory(base64, sourcemapArg, enableUnicodeArg) {\n    var sourcemap = sourcemapArg === undefined ? null : sourcemapArg;\n    var enableUnicode = enableUnicodeArg === undefined ? false : enableUnicodeArg;\n    var source = decodeBase64(base64, enableUnicode);\n    var start = source.indexOf('\\n', 10) + 1;\n    var body = source.substring(start) + (sourcemap ? '\\/\\/# sourceMappingURL=' + sourcemap : '');\n    return function WorkerFactory(options) {\n        return new WorkerClass(body, Object.assign({}, options, { eval: true }));\n    };\n}\n\nexport { createBase64WorkerFactory };\n","function decodeBase64(base64, enableUnicode) {\n    var binaryString = atob(base64);\n    if (enableUnicode) {\n        var binaryView = new Uint8Array(binaryString.length);\n        for (var i = 0, n = binaryString.length; i < n; ++i) {\n            binaryView[i] = binaryString.charCodeAt(i);\n        }\n        return String.fromCharCode.apply(null, new Uint16Array(binaryView.buffer));\n    }\n    return binaryString;\n}\n\nfunction createURL(base64, sourcemapArg, enableUnicodeArg) {\n    var sourcemap = sourcemapArg === undefined ? null : sourcemapArg;\n    var enableUnicode = enableUnicodeArg === undefined ? false : enableUnicodeArg;\n    var source = decodeBase64(base64, enableUnicode);\n    var start = source.indexOf('\\n', 10) + 1;\n    var body = source.substring(start) + (sourcemap ? '\\/\\/# sourceMappingURL=' + sourcemap : '');\n    var blob = new Blob([body], { type: 'application/javascript' });\n    return URL.createObjectURL(blob);\n}\n\nfunction createBase64WorkerFactory(base64, sourcemapArg, enableUnicodeArg) {\n    var url;\n    return function WorkerFactory(options) {\n        url = url || createURL(base64, sourcemapArg, enableUnicodeArg);\n        return new Worker(url, options);\n    };\n}\n\nexport { createBase64WorkerFactory };\n","import { __rest, __awaiter } from './../../../../../../ext/tslib/tslib.es6.js';\nimport { isBlocked } from '../../../utils.js';\nimport { CanvasContext } from '../../../../../types/dist/types.js';\nimport initCanvas2DMutationObserver from './2d.js';\nimport initCanvasContextObserver from './canvas.js';\nimport initCanvasWebGLMutationObserver from './webgl.js';\nimport WorkerFactory from '../../../../../../_virtual/image-bitmap-data-url-worker.js';\n\nclass CanvasManager {\r\n    constructor(options) {\r\n        this.pendingCanvasMutations = new Map();\r\n        this.rafStamps = { latestId: 0, invokeId: null };\r\n        this.frozen = false;\r\n        this.locked = false;\r\n        this.processMutation = (target, mutation) => {\r\n            const newFrame = this.rafStamps.invokeId &&\r\n                this.rafStamps.latestId !== this.rafStamps.invokeId;\r\n            if (newFrame || !this.rafStamps.invokeId)\r\n                this.rafStamps.invokeId = this.rafStamps.latestId;\r\n            if (!this.pendingCanvasMutations.has(target)) {\r\n                this.pendingCanvasMutations.set(target, []);\r\n            }\r\n            this.pendingCanvasMutations.get(target).push(mutation);\r\n        };\r\n        const { sampling = 'all', win, blockClass, blockSelector, recordCanvas, dataURLOptions, } = options;\r\n        this.mutationCb = options.mutationCb;\r\n        this.mirror = options.mirror;\r\n        if (recordCanvas && sampling === 'all')\r\n            this.initCanvasMutationObserver(win, blockClass, blockSelector);\r\n        if (recordCanvas && typeof sampling === 'number')\r\n            this.initCanvasFPSObserver(sampling, win, blockClass, blockSelector, {\r\n                dataURLOptions,\r\n            });\r\n    }\r\n    reset() {\r\n        this.pendingCanvasMutations.clear();\r\n        this.resetObservers && this.resetObservers();\r\n    }\r\n    freeze() {\r\n        this.frozen = true;\r\n    }\r\n    unfreeze() {\r\n        this.frozen = false;\r\n    }\r\n    lock() {\r\n        this.locked = true;\r\n    }\r\n    unlock() {\r\n        this.locked = false;\r\n    }\r\n    initCanvasFPSObserver(fps, win, blockClass, blockSelector, options) {\r\n        const canvasContextReset = initCanvasContextObserver(win, blockClass, blockSelector);\r\n        const snapshotInProgressMap = new Map();\r\n        const worker = new WorkerFactory();\r\n        worker.onmessage = (e) => {\r\n            const { id } = e.data;\r\n            snapshotInProgressMap.set(id, false);\r\n            if (!('base64' in e.data))\r\n                return;\r\n            const { base64, type, width, height } = e.data;\r\n            this.mutationCb({\r\n                id,\r\n                type: CanvasContext['2D'],\r\n                commands: [\r\n                    {\r\n                        property: 'clearRect',\r\n                        args: [0, 0, width, height],\r\n                    },\r\n                    {\r\n                        property: 'drawImage',\r\n                        args: [\r\n                            {\r\n                                rr_type: 'ImageBitmap',\r\n                                args: [\r\n                                    {\r\n                                        rr_type: 'Blob',\r\n                                        data: [{ rr_type: 'ArrayBuffer', base64 }],\r\n                                        type,\r\n                                    },\r\n                                ],\r\n                            },\r\n                            0,\r\n                            0,\r\n                        ],\r\n                    },\r\n                ],\r\n            });\r\n        };\r\n        const timeBetweenSnapshots = 1000 / fps;\r\n        let lastSnapshotTime = 0;\r\n        let rafId;\r\n        const getCanvas = () => {\r\n            const matchedCanvas = [];\r\n            win.document.querySelectorAll('canvas').forEach((canvas) => {\r\n                if (!isBlocked(canvas, blockClass, blockSelector, true)) {\r\n                    matchedCanvas.push(canvas);\r\n                }\r\n            });\r\n            return matchedCanvas;\r\n        };\r\n        const takeCanvasSnapshots = (timestamp) => {\r\n            if (lastSnapshotTime &&\r\n                timestamp - lastSnapshotTime < timeBetweenSnapshots) {\r\n                rafId = requestAnimationFrame(takeCanvasSnapshots);\r\n                return;\r\n            }\r\n            lastSnapshotTime = timestamp;\r\n            getCanvas()\r\n                .forEach((canvas) => __awaiter(this, void 0, void 0, function* () {\r\n                var _a;\r\n                const id = this.mirror.getId(canvas);\r\n                if (snapshotInProgressMap.get(id))\r\n                    return;\r\n                snapshotInProgressMap.set(id, true);\r\n                if (['webgl', 'webgl2'].includes(canvas.__context)) {\r\n                    const context = canvas.getContext(canvas.__context);\r\n                    if (((_a = context === null || context === void 0 ? void 0 : context.getContextAttributes()) === null || _a === void 0 ? void 0 : _a.preserveDrawingBuffer) === false) {\r\n                        context === null || context === void 0 ? void 0 : context.clear(context.COLOR_BUFFER_BIT);\r\n                    }\r\n                }\r\n                const bitmap = yield createImageBitmap(canvas);\r\n                worker.postMessage({\r\n                    id,\r\n                    bitmap,\r\n                    width: canvas.width,\r\n                    height: canvas.height,\r\n                    dataURLOptions: options.dataURLOptions,\r\n                }, [bitmap]);\r\n            }));\r\n            rafId = requestAnimationFrame(takeCanvasSnapshots);\r\n        };\r\n        rafId = requestAnimationFrame(takeCanvasSnapshots);\r\n        this.resetObservers = () => {\r\n            canvasContextReset();\r\n            cancelAnimationFrame(rafId);\r\n        };\r\n    }\r\n    initCanvasMutationObserver(win, blockClass, blockSelector) {\r\n        this.startRAFTimestamping();\r\n        this.startPendingCanvasMutationFlusher();\r\n        const canvasContextReset = initCanvasContextObserver(win, blockClass, blockSelector);\r\n        const canvas2DReset = initCanvas2DMutationObserver(this.processMutation.bind(this), win, blockClass, blockSelector);\r\n        const canvasWebGL1and2Reset = initCanvasWebGLMutationObserver(this.processMutation.bind(this), win, blockClass, blockSelector, this.mirror);\r\n        this.resetObservers = () => {\r\n            canvasContextReset();\r\n            canvas2DReset();\r\n            canvasWebGL1and2Reset();\r\n        };\r\n    }\r\n    startPendingCanvasMutationFlusher() {\r\n        requestAnimationFrame(() => this.flushPendingCanvasMutations());\r\n    }\r\n    startRAFTimestamping() {\r\n        const setLatestRAFTimestamp = (timestamp) => {\r\n            this.rafStamps.latestId = timestamp;\r\n            requestAnimationFrame(setLatestRAFTimestamp);\r\n        };\r\n        requestAnimationFrame(setLatestRAFTimestamp);\r\n    }\r\n    flushPendingCanvasMutations() {\r\n        this.pendingCanvasMutations.forEach((values, canvas) => {\r\n            const id = this.mirror.getId(canvas);\r\n            this.flushPendingCanvasMutationFor(canvas, id);\r\n        });\r\n        requestAnimationFrame(() => this.flushPendingCanvasMutations());\r\n    }\r\n    flushPendingCanvasMutationFor(canvas, id) {\r\n        if (this.frozen || this.locked) {\r\n            return;\r\n        }\r\n        const valuesWithType = this.pendingCanvasMutations.get(canvas);\r\n        if (!valuesWithType || id === -1)\r\n            return;\r\n        const values = valuesWithType.map((value) => {\r\n            const rest = __rest(value, [\"type\"]);\r\n            return rest;\r\n        });\r\n        const { type } = valuesWithType[0];\r\n        this.mutationCb({ id, type, commands: values });\r\n        this.pendingCanvasMutations.delete(canvas);\r\n    }\r\n}\n\nexport { CanvasManager };\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\n\nexport { __awaiter, __rest };\n","import { CanvasContext } from '../../../../../types/dist/types.js';\nimport { patch, isBlocked, hookSetter } from '../../../utils.js';\nimport { serializeArgs } from './serialize-args.js';\n\nfunction initCanvas2DMutationObserver(cb, win, blockClass, blockSelector) {\r\n    const handlers = [];\r\n    const props2D = Object.getOwnPropertyNames(win.CanvasRenderingContext2D.prototype);\r\n    for (const prop of props2D) {\r\n        try {\r\n            if (typeof win.CanvasRenderingContext2D.prototype[prop] !== 'function') {\r\n                continue;\r\n            }\r\n            const restoreHandler = patch(win.CanvasRenderingContext2D.prototype, prop, function (original) {\r\n                return function (...args) {\r\n                    if (!isBlocked(this.canvas, blockClass, blockSelector, true)) {\r\n                        setTimeout(() => {\r\n                            const recordArgs = serializeArgs([...args], win, this);\r\n                            cb(this.canvas, {\r\n                                type: CanvasContext['2D'],\r\n                                property: prop,\r\n                                args: recordArgs,\r\n                            });\r\n                        }, 0);\r\n                    }\r\n                    return original.apply(this, args);\r\n                };\r\n            });\r\n            handlers.push(restoreHandler);\r\n        }\r\n        catch (_a) {\r\n            const hookHandler = hookSetter(win.CanvasRenderingContext2D.prototype, prop, {\r\n                set(v) {\r\n                    cb(this.canvas, {\r\n                        type: CanvasContext['2D'],\r\n                        property: prop,\r\n                        args: [v],\r\n                        setter: true,\r\n                    });\r\n                },\r\n            });\r\n            handlers.push(hookHandler);\r\n        }\r\n    }\r\n    return () => {\r\n        handlers.forEach((h) => h());\r\n    };\r\n}\n\nexport { initCanvas2DMutationObserver as default };\n","import { getCssRuleString } from '../../../rrweb-snapshot/es/rrweb-snapshot.js';\nimport { StyleSheetMirror } from '../utils.js';\n\nclass StylesheetManager {\r\n    constructor(options) {\r\n        this.trackedLinkElements = new WeakSet();\r\n        this.styleMirror = new StyleSheetMirror();\r\n        this.mutationCb = options.mutationCb;\r\n        this.adoptedStyleSheetCb = options.adoptedStyleSheetCb;\r\n    }\r\n    attachLinkElement(linkEl, childSn) {\r\n        if ('_cssText' in childSn.attributes)\r\n            this.mutationCb({\r\n                adds: [],\r\n                removes: [],\r\n                texts: [],\r\n                attributes: [\r\n                    {\r\n                        id: childSn.id,\r\n                        attributes: childSn\r\n                            .attributes,\r\n                    },\r\n                ],\r\n            });\r\n        this.trackLinkElement(linkEl);\r\n    }\r\n    trackLinkElement(linkEl) {\r\n        if (this.trackedLinkElements.has(linkEl))\r\n            return;\r\n        this.trackedLinkElements.add(linkEl);\r\n        this.trackStylesheetInLinkElement(linkEl);\r\n    }\r\n    adoptStyleSheets(sheets, hostId) {\r\n        if (sheets.length === 0)\r\n            return;\r\n        const adoptedStyleSheetData = {\r\n            id: hostId,\r\n            styleIds: [],\r\n        };\r\n        const styles = [];\r\n        for (const sheet of sheets) {\r\n            let styleId;\r\n            if (!this.styleMirror.has(sheet)) {\r\n                styleId = this.styleMirror.add(sheet);\r\n                const rules = Array.from(sheet.rules || CSSRule);\r\n                styles.push({\r\n                    styleId,\r\n                    rules: rules.map((r, index) => {\r\n                        return {\r\n                            rule: getCssRuleString(r),\r\n                            index,\r\n                        };\r\n                    }),\r\n                });\r\n            }\r\n            else\r\n                styleId = this.styleMirror.getId(sheet);\r\n            adoptedStyleSheetData.styleIds.push(styleId);\r\n        }\r\n        if (styles.length > 0)\r\n            adoptedStyleSheetData.styles = styles;\r\n        this.adoptedStyleSheetCb(adoptedStyleSheetData);\r\n    }\r\n    reset() {\r\n        this.styleMirror.reset();\r\n        this.trackedLinkElements = new WeakSet();\r\n    }\r\n    trackStylesheetInLinkElement(linkEl) {\r\n    }\r\n}\n\nexport { StylesheetManager };\n","import { createMirror, snapshot } from '../../../rrweb-snapshot/es/rrweb-snapshot.js';\nimport { initObservers, mutationBuffers } from './observer.js';\nimport { polyfill, on, getWindowWidth, getWindowHeight, isSerializedIframe, isSerializedStylesheet, hasShadowRoot } from '../utils.js';\nimport { EventType, IncrementalSource } from '../../../types/dist/types.js';\nimport { IframeManager } from './iframe-manager.js';\nimport { ShadowDomManager } from './shadow-dom-manager.js';\nimport { CanvasManager } from './observers/canvas/canvas-manager.js';\nimport { StylesheetManager } from './stylesheet-manager.js';\n\nfunction wrapEvent(e) {\r\n    return Object.assign(Object.assign({}, e), { timestamp: Date.now() });\r\n}\r\nlet wrappedEmit;\r\nlet takeFullSnapshot;\r\nlet canvasManager;\r\nlet recording = false;\r\nconst mirror = createMirror();\r\nfunction record(options = {}) {\r\n    const { emit, checkoutEveryNms, checkoutEveryNth, blockClass = 'rr-block', blockSelector = null, ignoreClass = 'rr-ignore', maskTextClass = 'rr-mask', maskTextSelector = null, inlineStylesheet = true, maskAllInputs, maskInputOptions: _maskInputOptions, slimDOMOptions: _slimDOMOptions, maskInputFn, maskTextFn, hooks, packFn, sampling = {}, dataURLOptions = {}, mousemoveWait, recordCanvas = false, recordCrossOriginIframes = false, userTriggeredOnInput = false, collectFonts = false, inlineImages = false, plugins, keepIframeSrcFn = () => false, ignoreCSSAttributes = new Set([]), } = options;\r\n    const inEmittingFrame = recordCrossOriginIframes\r\n        ? window.parent === window\r\n        : true;\r\n    let passEmitsToParent = false;\r\n    if (!inEmittingFrame) {\r\n        try {\r\n            window.parent.document;\r\n            passEmitsToParent = false;\r\n        }\r\n        catch (e) {\r\n            passEmitsToParent = true;\r\n        }\r\n    }\r\n    if (inEmittingFrame && !emit) {\r\n        throw new Error('emit function is required');\r\n    }\r\n    if (mousemoveWait !== undefined && sampling.mousemove === undefined) {\r\n        sampling.mousemove = mousemoveWait;\r\n    }\r\n    mirror.reset();\r\n    const maskInputOptions = maskAllInputs === true\r\n        ? {\r\n            color: true,\r\n            date: true,\r\n            'datetime-local': true,\r\n            email: true,\r\n            month: true,\r\n            number: true,\r\n            range: true,\r\n            search: true,\r\n            tel: true,\r\n            text: true,\r\n            time: true,\r\n            url: true,\r\n            week: true,\r\n            textarea: true,\r\n            select: true,\r\n            password: true,\r\n        }\r\n        : _maskInputOptions !== undefined\r\n            ? _maskInputOptions\r\n            : { password: true };\r\n    const slimDOMOptions = _slimDOMOptions === true || _slimDOMOptions === 'all'\r\n        ? {\r\n            script: true,\r\n            comment: true,\r\n            headFavicon: true,\r\n            headWhitespace: true,\r\n            headMetaSocial: true,\r\n            headMetaRobots: true,\r\n            headMetaHttpEquiv: true,\r\n            headMetaVerification: true,\r\n            headMetaAuthorship: _slimDOMOptions === 'all',\r\n            headMetaDescKeywords: _slimDOMOptions === 'all',\r\n        }\r\n        : _slimDOMOptions\r\n            ? _slimDOMOptions\r\n            : {};\r\n    polyfill();\r\n    let lastFullSnapshotEvent;\r\n    let incrementalSnapshotCount = 0;\r\n    const eventProcessor = (e) => {\r\n        for (const plugin of plugins || []) {\r\n            if (plugin.eventProcessor) {\r\n                e = plugin.eventProcessor(e);\r\n            }\r\n        }\r\n        if (packFn) {\r\n            e = packFn(e);\r\n        }\r\n        return e;\r\n    };\r\n    wrappedEmit = (e, isCheckout) => {\r\n        var _a;\r\n        if (((_a = mutationBuffers[0]) === null || _a === void 0 ? void 0 : _a.isFrozen()) &&\r\n            e.type !== EventType.FullSnapshot &&\r\n            !(e.type === EventType.IncrementalSnapshot &&\r\n                e.data.source === IncrementalSource.Mutation)) {\r\n            mutationBuffers.forEach((buf) => buf.unfreeze());\r\n        }\r\n        if (inEmittingFrame) {\r\n            emit === null || emit === void 0 ? void 0 : emit(eventProcessor(e), isCheckout);\r\n        }\r\n        else if (passEmitsToParent) {\r\n            const message = {\r\n                type: 'rrweb',\r\n                event: eventProcessor(e),\r\n                isCheckout,\r\n            };\r\n            window.parent.postMessage(message, '*');\r\n        }\r\n        if (e.type === EventType.FullSnapshot) {\r\n            lastFullSnapshotEvent = e;\r\n            incrementalSnapshotCount = 0;\r\n        }\r\n        else if (e.type === EventType.IncrementalSnapshot) {\r\n            if (e.data.source === IncrementalSource.Mutation &&\r\n                e.data.isAttachIframe) {\r\n                return;\r\n            }\r\n            incrementalSnapshotCount++;\r\n            const exceedCount = checkoutEveryNth && incrementalSnapshotCount >= checkoutEveryNth;\r\n            const exceedTime = checkoutEveryNms &&\r\n                e.timestamp - lastFullSnapshotEvent.timestamp > checkoutEveryNms;\r\n            if (exceedCount || exceedTime) {\r\n                takeFullSnapshot(true);\r\n            }\r\n        }\r\n    };\r\n    const wrappedMutationEmit = (m) => {\r\n        wrappedEmit(wrapEvent({\r\n            type: EventType.IncrementalSnapshot,\r\n            data: Object.assign({ source: IncrementalSource.Mutation }, m),\r\n        }));\r\n    };\r\n    const wrappedScrollEmit = (p) => wrappedEmit(wrapEvent({\r\n        type: EventType.IncrementalSnapshot,\r\n        data: Object.assign({ source: IncrementalSource.Scroll }, p),\r\n    }));\r\n    const wrappedCanvasMutationEmit = (p) => wrappedEmit(wrapEvent({\r\n        type: EventType.IncrementalSnapshot,\r\n        data: Object.assign({ source: IncrementalSource.CanvasMutation }, p),\r\n    }));\r\n    const wrappedAdoptedStyleSheetEmit = (a) => wrappedEmit(wrapEvent({\r\n        type: EventType.IncrementalSnapshot,\r\n        data: Object.assign({ source: IncrementalSource.AdoptedStyleSheet }, a),\r\n    }));\r\n    const stylesheetManager = new StylesheetManager({\r\n        mutationCb: wrappedMutationEmit,\r\n        adoptedStyleSheetCb: wrappedAdoptedStyleSheetEmit,\r\n    });\r\n    const iframeManager = new IframeManager({\r\n        mirror,\r\n        mutationCb: wrappedMutationEmit,\r\n        stylesheetManager: stylesheetManager,\r\n        recordCrossOriginIframes,\r\n        wrappedEmit,\r\n    });\r\n    for (const plugin of plugins || []) {\r\n        if (plugin.getMirror)\r\n            plugin.getMirror({\r\n                nodeMirror: mirror,\r\n                crossOriginIframeMirror: iframeManager.crossOriginIframeMirror,\r\n                crossOriginIframeStyleMirror: iframeManager.crossOriginIframeStyleMirror,\r\n            });\r\n    }\r\n    canvasManager = new CanvasManager({\r\n        recordCanvas,\r\n        mutationCb: wrappedCanvasMutationEmit,\r\n        win: window,\r\n        blockClass,\r\n        blockSelector,\r\n        mirror,\r\n        sampling: sampling.canvas,\r\n        dataURLOptions,\r\n    });\r\n    const shadowDomManager = new ShadowDomManager({\r\n        mutationCb: wrappedMutationEmit,\r\n        scrollCb: wrappedScrollEmit,\r\n        bypassOptions: {\r\n            blockClass,\r\n            blockSelector,\r\n            maskTextClass,\r\n            maskTextSelector,\r\n            inlineStylesheet,\r\n            maskInputOptions,\r\n            dataURLOptions,\r\n            maskTextFn,\r\n            maskInputFn,\r\n            recordCanvas,\r\n            inlineImages,\r\n            sampling,\r\n            slimDOMOptions,\r\n            iframeManager,\r\n            stylesheetManager,\r\n            canvasManager,\r\n            keepIframeSrcFn,\r\n        },\r\n        mirror,\r\n    });\r\n    takeFullSnapshot = (isCheckout = false) => {\r\n        var _a, _b, _c, _d, _e, _f;\r\n        wrappedEmit(wrapEvent({\r\n            type: EventType.Meta,\r\n            data: {\r\n                href: window.location.href,\r\n                width: getWindowWidth(),\r\n                height: getWindowHeight(),\r\n            },\r\n        }), isCheckout);\r\n        stylesheetManager.reset();\r\n        mutationBuffers.forEach((buf) => buf.lock());\r\n        const node = snapshot(document, {\r\n            mirror,\r\n            blockClass,\r\n            blockSelector,\r\n            maskTextClass,\r\n            maskTextSelector,\r\n            inlineStylesheet,\r\n            maskAllInputs: maskInputOptions,\r\n            maskTextFn,\r\n            slimDOM: slimDOMOptions,\r\n            dataURLOptions,\r\n            recordCanvas,\r\n            inlineImages,\r\n            onSerialize: (n) => {\r\n                if (isSerializedIframe(n, mirror)) {\r\n                    iframeManager.addIframe(n);\r\n                }\r\n                if (isSerializedStylesheet(n, mirror)) {\r\n                    stylesheetManager.trackLinkElement(n);\r\n                }\r\n                if (hasShadowRoot(n)) {\r\n                    shadowDomManager.addShadowRoot(n.shadowRoot, document);\r\n                }\r\n            },\r\n            onIframeLoad: (iframe, childSn) => {\r\n                iframeManager.attachIframe(iframe, childSn);\r\n                shadowDomManager.observeAttachShadow(iframe);\r\n            },\r\n            onStylesheetLoad: (linkEl, childSn) => {\r\n                stylesheetManager.attachLinkElement(linkEl, childSn);\r\n            },\r\n            keepIframeSrcFn,\r\n        });\r\n        if (!node) {\r\n            return console.warn('Failed to snapshot the document');\r\n        }\r\n        wrappedEmit(wrapEvent({\r\n            type: EventType.FullSnapshot,\r\n            data: {\r\n                node,\r\n                initialOffset: {\r\n                    left: window.pageXOffset !== undefined\r\n                        ? window.pageXOffset\r\n                        : (document === null || document === void 0 ? void 0 : document.documentElement.scrollLeft) ||\r\n                            ((_b = (_a = document === null || document === void 0 ? void 0 : document.body) === null || _a === void 0 ? void 0 : _a.parentElement) === null || _b === void 0 ? void 0 : _b.scrollLeft) ||\r\n                            ((_c = document === null || document === void 0 ? void 0 : document.body) === null || _c === void 0 ? void 0 : _c.scrollLeft) ||\r\n                            0,\r\n                    top: window.pageYOffset !== undefined\r\n                        ? window.pageYOffset\r\n                        : (document === null || document === void 0 ? void 0 : document.documentElement.scrollTop) ||\r\n                            ((_e = (_d = document === null || document === void 0 ? void 0 : document.body) === null || _d === void 0 ? void 0 : _d.parentElement) === null || _e === void 0 ? void 0 : _e.scrollTop) ||\r\n                            ((_f = document === null || document === void 0 ? void 0 : document.body) === null || _f === void 0 ? void 0 : _f.scrollTop) ||\r\n                            0,\r\n                },\r\n            },\r\n        }));\r\n        mutationBuffers.forEach((buf) => buf.unlock());\r\n        if (document.adoptedStyleSheets && document.adoptedStyleSheets.length > 0)\r\n            stylesheetManager.adoptStyleSheets(document.adoptedStyleSheets, mirror.getId(document));\r\n    };\r\n    try {\r\n        const handlers = [];\r\n        handlers.push(on('DOMContentLoaded', () => {\r\n            wrappedEmit(wrapEvent({\r\n                type: EventType.DomContentLoaded,\r\n                data: {},\r\n            }));\r\n        }));\r\n        const observe = (doc) => {\r\n            var _a;\r\n            return initObservers({\r\n                mutationCb: wrappedMutationEmit,\r\n                mousemoveCb: (positions, source) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: {\r\n                        source,\r\n                        positions,\r\n                    },\r\n                })),\r\n                mouseInteractionCb: (d) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: Object.assign({ source: IncrementalSource.MouseInteraction }, d),\r\n                })),\r\n                scrollCb: wrappedScrollEmit,\r\n                viewportResizeCb: (d) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: Object.assign({ source: IncrementalSource.ViewportResize }, d),\r\n                })),\r\n                inputCb: (v) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: Object.assign({ source: IncrementalSource.Input }, v),\r\n                })),\r\n                mediaInteractionCb: (p) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: Object.assign({ source: IncrementalSource.MediaInteraction }, p),\r\n                })),\r\n                styleSheetRuleCb: (r) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: Object.assign({ source: IncrementalSource.StyleSheetRule }, r),\r\n                })),\r\n                styleDeclarationCb: (r) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: Object.assign({ source: IncrementalSource.StyleDeclaration }, r),\r\n                })),\r\n                canvasMutationCb: wrappedCanvasMutationEmit,\r\n                fontCb: (p) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: Object.assign({ source: IncrementalSource.Font }, p),\r\n                })),\r\n                selectionCb: (p) => {\r\n                    wrappedEmit(wrapEvent({\r\n                        type: EventType.IncrementalSnapshot,\r\n                        data: Object.assign({ source: IncrementalSource.Selection }, p),\r\n                    }));\r\n                },\r\n                blockClass,\r\n                ignoreClass,\r\n                maskTextClass,\r\n                maskTextSelector,\r\n                maskInputOptions,\r\n                inlineStylesheet,\r\n                sampling,\r\n                recordCanvas,\r\n                inlineImages,\r\n                userTriggeredOnInput,\r\n                collectFonts,\r\n                doc,\r\n                maskInputFn,\r\n                maskTextFn,\r\n                keepIframeSrcFn,\r\n                blockSelector,\r\n                slimDOMOptions,\r\n                dataURLOptions,\r\n                mirror,\r\n                iframeManager,\r\n                stylesheetManager,\r\n                shadowDomManager,\r\n                canvasManager,\r\n                ignoreCSSAttributes,\r\n                plugins: ((_a = plugins === null || plugins === void 0 ? void 0 : plugins.filter((p) => p.observer)) === null || _a === void 0 ? void 0 : _a.map((p) => ({\r\n                    observer: p.observer,\r\n                    options: p.options,\r\n                    callback: (payload) => wrappedEmit(wrapEvent({\r\n                        type: EventType.Plugin,\r\n                        data: {\r\n                            plugin: p.name,\r\n                            payload,\r\n                        },\r\n                    })),\r\n                }))) || [],\r\n            }, hooks);\r\n        };\r\n        iframeManager.addLoadListener((iframeEl) => {\r\n            handlers.push(observe(iframeEl.contentDocument));\r\n        });\r\n        const init = () => {\r\n            takeFullSnapshot();\r\n            handlers.push(observe(document));\r\n            recording = true;\r\n        };\r\n        if (document.readyState === 'interactive' ||\r\n            document.readyState === 'complete') {\r\n            init();\r\n        }\r\n        else {\r\n            handlers.push(on('load', () => {\r\n                wrappedEmit(wrapEvent({\r\n                    type: EventType.Load,\r\n                    data: {},\r\n                }));\r\n                init();\r\n            }, window));\r\n        }\r\n        return () => {\r\n            handlers.forEach((h) => h());\r\n            recording = false;\r\n        };\r\n    }\r\n    catch (error) {\r\n        console.warn(error);\r\n    }\r\n}\r\nrecord.addCustomEvent = (tag, payload) => {\r\n    if (!recording) {\r\n        throw new Error('please add custom event after start recording');\r\n    }\r\n    wrappedEmit(wrapEvent({\r\n        type: EventType.Custom,\r\n        data: {\r\n            tag,\r\n            payload,\r\n        },\r\n    }));\r\n};\r\nrecord.freezePage = () => {\r\n    mutationBuffers.forEach((buf) => buf.freeze());\r\n};\r\nrecord.takeFullSnapshot = (isCheckout) => {\r\n    if (!recording) {\r\n        throw new Error('please take full snapshot after start recording');\r\n    }\r\n    takeFullSnapshot(isCheckout);\r\n};\r\nrecord.mirror = mirror;\n\nexport { record as default };\n","// src/utils/bufferUtils.ts\nvar encoder = new TextEncoder();\nfunction encodeBuffer(text) {\n  return encoder.encode(text);\n}\nfunction decodeBuffer(buffer, encoding) {\n  const decoder = new TextDecoder(encoding);\n  return decoder.decode(buffer);\n}\nfunction toArrayBuffer(array) {\n  return array.buffer.slice(\n    array.byteOffset,\n    array.byteOffset + array.byteLength\n  );\n}\n\nexport {\n  encodeBuffer,\n  decodeBuffer,\n  toArrayBuffer\n};\n//# sourceMappingURL=chunk-6HYIRFX2.mjs.map","// src/glossary.ts\nvar IS_PATCHED_MODULE = Symbol(\"isPatchedModule\");\n\n// src/utils/isPropertyAccessible.ts\nfunction isPropertyAccessible(obj, key) {\n  try {\n    obj[key];\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\n// src/utils/responseUtils.ts\nvar RESPONSE_STATUS_CODES_WITHOUT_BODY = /* @__PURE__ */ new Set([\n  101,\n  103,\n  204,\n  205,\n  304\n]);\nfunction isResponseWithoutBody(status) {\n  return RESPONSE_STATUS_CODES_WITHOUT_BODY.has(status);\n}\nfunction createServerErrorResponse(body) {\n  return new Response(\n    JSON.stringify(\n      body instanceof Error ? {\n        name: body.name,\n        message: body.message,\n        stack: body.stack\n      } : body\n    ),\n    {\n      status: 500,\n      statusText: \"Unhandled Exception\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    }\n  );\n}\nfunction isResponseError(response) {\n  return isPropertyAccessible(response, \"type\") && response.type === \"error\";\n}\n\nexport {\n  IS_PATCHED_MODULE,\n  isResponseWithoutBody,\n  createServerErrorResponse,\n  isResponseError\n};\n//# sourceMappingURL=chunk-OMISYKWR.mjs.map","// src/index.ts\nfunction isNodeProcess() {\n  if (typeof navigator !== \"undefined\" && navigator.product === \"ReactNative\") {\n    return true;\n  }\n  if (typeof process !== \"undefined\") {\n    const type = process.type;\n    if (type === \"renderer\" || type === \"worker\") {\n      return false;\n    }\n    return !!(process.versions && process.versions.node);\n  }\n  return false;\n}\nexport {\n  isNodeProcess\n};\n//# sourceMappingURL=index.mjs.map","// src/format.ts\nvar POSITIONALS_EXP = /(%?)(%([sdijo]))/g;\nfunction serializePositional(positional, flag) {\n  switch (flag) {\n    case \"s\":\n      return positional;\n    case \"d\":\n    case \"i\":\n      return Number(positional);\n    case \"j\":\n      return JSON.stringify(positional);\n    case \"o\": {\n      if (typeof positional === \"string\") {\n        return positional;\n      }\n      const json = JSON.stringify(positional);\n      if (json === \"{}\" || json === \"[]\" || /^\\[object .+?\\]$/.test(json)) {\n        return positional;\n      }\n      return json;\n    }\n  }\n}\nfunction format(message, ...positionals) {\n  if (positionals.length === 0) {\n    return message;\n  }\n  let positionalIndex = 0;\n  let formattedMessage = message.replace(\n    POSITIONALS_EXP,\n    (match, isEscaped, _, flag) => {\n      const positional = positionals[positionalIndex];\n      const value = serializePositional(positional, flag);\n      if (!isEscaped) {\n        positionalIndex++;\n        return value;\n      }\n      return match;\n    }\n  );\n  if (positionalIndex < positionals.length) {\n    formattedMessage += ` ${positionals.slice(positionalIndex).join(\" \")}`;\n  }\n  formattedMessage = formattedMessage.replace(/%{2,2}/g, \"%\");\n  return formattedMessage;\n}\n\n// src/invariant.ts\nvar STACK_FRAMES_TO_IGNORE = 2;\nfunction cleanErrorStack(error) {\n  if (!error.stack) {\n    return;\n  }\n  const nextStack = error.stack.split(\"\\n\");\n  nextStack.splice(1, STACK_FRAMES_TO_IGNORE);\n  error.stack = nextStack.join(\"\\n\");\n}\nvar InvariantError = class extends Error {\n  constructor(message, ...positionals) {\n    super(message);\n    this.message = message;\n    this.name = \"Invariant Violation\";\n    this.message = format(message, ...positionals);\n    cleanErrorStack(this);\n  }\n};\nvar invariant = (predicate, message, ...positionals) => {\n  if (!predicate) {\n    throw new InvariantError(message, ...positionals);\n  }\n};\ninvariant.as = (ErrorConstructor, predicate, message, ...positionals) => {\n  if (!predicate) {\n    const formatMessage = positionals.length === 0 ? message : format(message, positionals);\n    let error;\n    try {\n      error = Reflect.construct(ErrorConstructor, [formatMessage]);\n    } catch (err) {\n      error = ErrorConstructor(formatMessage);\n    }\n    throw error;\n  }\n};\nexport {\n  InvariantError,\n  format,\n  invariant\n};\n//# sourceMappingURL=index.mjs.map","var __defProp = Object.defineProperty;\nvar __export = (target, all) => {\n  for (var name in all)\n    __defProp(target, name, { get: all[name], enumerable: true });\n};\n\n// src/index.ts\nimport { isNodeProcess } from \"is-node-process\";\nimport { format } from \"outvariant\";\n\n// src/colors.ts\nvar colors_exports = {};\n__export(colors_exports, {\n  blue: () => blue,\n  gray: () => gray,\n  green: () => green,\n  red: () => red,\n  yellow: () => yellow\n});\nfunction yellow(text) {\n  return `\\x1B[33m${text}\\x1B[0m`;\n}\nfunction blue(text) {\n  return `\\x1B[34m${text}\\x1B[0m`;\n}\nfunction gray(text) {\n  return `\\x1B[90m${text}\\x1B[0m`;\n}\nfunction red(text) {\n  return `\\x1B[31m${text}\\x1B[0m`;\n}\nfunction green(text) {\n  return `\\x1B[32m${text}\\x1B[0m`;\n}\n\n// src/index.ts\nvar IS_NODE = isNodeProcess();\nvar Logger = class {\n  constructor(name) {\n    this.name = name;\n    this.prefix = `[${this.name}]`;\n    const LOGGER_NAME = getVariable(\"DEBUG\");\n    const LOGGER_LEVEL = getVariable(\"LOG_LEVEL\");\n    const isLoggingEnabled = LOGGER_NAME === \"1\" || LOGGER_NAME === \"true\" || typeof LOGGER_NAME !== \"undefined\" && this.name.startsWith(LOGGER_NAME);\n    if (isLoggingEnabled) {\n      this.debug = isDefinedAndNotEquals(LOGGER_LEVEL, \"debug\") ? noop : this.debug;\n      this.info = isDefinedAndNotEquals(LOGGER_LEVEL, \"info\") ? noop : this.info;\n      this.success = isDefinedAndNotEquals(LOGGER_LEVEL, \"success\") ? noop : this.success;\n      this.warning = isDefinedAndNotEquals(LOGGER_LEVEL, \"warning\") ? noop : this.warning;\n      this.error = isDefinedAndNotEquals(LOGGER_LEVEL, \"error\") ? noop : this.error;\n    } else {\n      this.info = noop;\n      this.success = noop;\n      this.warning = noop;\n      this.error = noop;\n      this.only = noop;\n    }\n  }\n  prefix;\n  extend(domain) {\n    return new Logger(`${this.name}:${domain}`);\n  }\n  /**\n   * Print a debug message.\n   * @example\n   * logger.debug('no duplicates found, creating a document...')\n   */\n  debug(message, ...positionals) {\n    this.logEntry({\n      level: \"debug\",\n      message: gray(message),\n      positionals,\n      prefix: this.prefix,\n      colors: {\n        prefix: \"gray\"\n      }\n    });\n  }\n  /**\n   * Print an info message.\n   * @example\n   * logger.info('start parsing...')\n   */\n  info(message, ...positionals) {\n    this.logEntry({\n      level: \"info\",\n      message,\n      positionals,\n      prefix: this.prefix,\n      colors: {\n        prefix: \"blue\"\n      }\n    });\n    const performance2 = new PerformanceEntry();\n    return (message2, ...positionals2) => {\n      performance2.measure();\n      this.logEntry({\n        level: \"info\",\n        message: `${message2} ${gray(`${performance2.deltaTime}ms`)}`,\n        positionals: positionals2,\n        prefix: this.prefix,\n        colors: {\n          prefix: \"blue\"\n        }\n      });\n    };\n  }\n  /**\n   * Print a success message.\n   * @example\n   * logger.success('successfully created document')\n   */\n  success(message, ...positionals) {\n    this.logEntry({\n      level: \"info\",\n      message,\n      positionals,\n      prefix: `\\u2714 ${this.prefix}`,\n      colors: {\n        timestamp: \"green\",\n        prefix: \"green\"\n      }\n    });\n  }\n  /**\n   * Print a warning.\n   * @example\n   * logger.warning('found legacy document format')\n   */\n  warning(message, ...positionals) {\n    this.logEntry({\n      level: \"warning\",\n      message,\n      positionals,\n      prefix: `\\u26A0 ${this.prefix}`,\n      colors: {\n        timestamp: \"yellow\",\n        prefix: \"yellow\"\n      }\n    });\n  }\n  /**\n   * Print an error message.\n   * @example\n   * logger.error('something went wrong')\n   */\n  error(message, ...positionals) {\n    this.logEntry({\n      level: \"error\",\n      message,\n      positionals,\n      prefix: `\\u2716 ${this.prefix}`,\n      colors: {\n        timestamp: \"red\",\n        prefix: \"red\"\n      }\n    });\n  }\n  /**\n   * Execute the given callback only when the logging is enabled.\n   * This is skipped in its entirety and has no runtime cost otherwise.\n   * This executes regardless of the log level.\n   * @example\n   * logger.only(() => {\n   *   logger.info('additional info')\n   * })\n   */\n  only(callback) {\n    callback();\n  }\n  createEntry(level, message) {\n    return {\n      timestamp: /* @__PURE__ */ new Date(),\n      level,\n      message\n    };\n  }\n  logEntry(args) {\n    const {\n      level,\n      message,\n      prefix,\n      colors: customColors,\n      positionals = []\n    } = args;\n    const entry = this.createEntry(level, message);\n    const timestampColor = customColors?.timestamp || \"gray\";\n    const prefixColor = customColors?.prefix || \"gray\";\n    const colorize = {\n      timestamp: colors_exports[timestampColor],\n      prefix: colors_exports[prefixColor]\n    };\n    const write = this.getWriter(level);\n    write(\n      [colorize.timestamp(this.formatTimestamp(entry.timestamp))].concat(prefix != null ? colorize.prefix(prefix) : []).concat(serializeInput(message)).join(\" \"),\n      ...positionals.map(serializeInput)\n    );\n  }\n  formatTimestamp(timestamp) {\n    return `${timestamp.toLocaleTimeString(\n      \"en-GB\"\n    )}:${timestamp.getMilliseconds()}`;\n  }\n  getWriter(level) {\n    switch (level) {\n      case \"debug\":\n      case \"success\":\n      case \"info\": {\n        return log;\n      }\n      case \"warning\": {\n        return warn;\n      }\n      case \"error\": {\n        return error;\n      }\n    }\n  }\n};\nvar PerformanceEntry = class {\n  startTime;\n  endTime;\n  deltaTime;\n  constructor() {\n    this.startTime = performance.now();\n  }\n  measure() {\n    this.endTime = performance.now();\n    const deltaTime = this.endTime - this.startTime;\n    this.deltaTime = deltaTime.toFixed(2);\n  }\n};\nvar noop = () => void 0;\nfunction log(message, ...positionals) {\n  if (IS_NODE) {\n    process.stdout.write(format(message, ...positionals) + \"\\n\");\n    return;\n  }\n  console.log(message, ...positionals);\n}\nfunction warn(message, ...positionals) {\n  if (IS_NODE) {\n    process.stderr.write(format(message, ...positionals) + \"\\n\");\n    return;\n  }\n  console.warn(message, ...positionals);\n}\nfunction error(message, ...positionals) {\n  if (IS_NODE) {\n    process.stderr.write(format(message, ...positionals) + \"\\n\");\n    return;\n  }\n  console.error(message, ...positionals);\n}\nfunction getVariable(variableName) {\n  if (IS_NODE) {\n    return process.env[variableName];\n  }\n  return globalThis[variableName]?.toString();\n}\nfunction isDefinedAndNotEquals(value, expected) {\n  return value !== void 0 && value !== expected;\n}\nfunction serializeInput(message) {\n  if (typeof message === \"undefined\") {\n    return \"undefined\";\n  }\n  if (message === null) {\n    return \"null\";\n  }\n  if (typeof message === \"string\") {\n    return message;\n  }\n  if (typeof message === \"object\") {\n    return JSON.stringify(message);\n  }\n  return message.toString();\n}\nexport {\n  Logger\n};\n","// src/MemoryLeakError.ts\nvar MemoryLeakError = class extends Error {\n  constructor(emitter, type, count) {\n    super(\n      `Possible EventEmitter memory leak detected. ${count} ${type.toString()} listeners added. Use emitter.setMaxListeners() to increase limit`\n    );\n    this.emitter = emitter;\n    this.type = type;\n    this.count = count;\n    this.name = \"MaxListenersExceededWarning\";\n  }\n};\n\n// src/Emitter.ts\nvar _Emitter = class {\n  static listenerCount(emitter, eventName) {\n    return emitter.listenerCount(eventName);\n  }\n  constructor() {\n    this.events = /* @__PURE__ */ new Map();\n    this.maxListeners = _Emitter.defaultMaxListeners;\n    this.hasWarnedAboutPotentialMemoryLeak = false;\n  }\n  _emitInternalEvent(internalEventName, eventName, listener) {\n    this.emit(\n      internalEventName,\n      ...[eventName, listener]\n    );\n  }\n  _getListeners(eventName) {\n    return Array.prototype.concat.apply([], this.events.get(eventName)) || [];\n  }\n  _removeListener(listeners, listener) {\n    const index = listeners.indexOf(listener);\n    if (index > -1) {\n      listeners.splice(index, 1);\n    }\n    return [];\n  }\n  _wrapOnceListener(eventName, listener) {\n    const onceListener = (...data) => {\n      this.removeListener(eventName, onceListener);\n      return listener.apply(this, data);\n    };\n    Object.defineProperty(onceListener, \"name\", { value: listener.name });\n    return onceListener;\n  }\n  setMaxListeners(maxListeners) {\n    this.maxListeners = maxListeners;\n    return this;\n  }\n  /**\n   * Returns the current max listener value for the `Emitter` which is\n   * either set by `emitter.setMaxListeners(n)` or defaults to\n   * `Emitter.defaultMaxListeners`.\n   */\n  getMaxListeners() {\n    return this.maxListeners;\n  }\n  /**\n   * Returns an array listing the events for which the emitter has registered listeners.\n   * The values in the array will be strings or Symbols.\n   */\n  eventNames() {\n    return Array.from(this.events.keys());\n  }\n  /**\n   * Synchronously calls each of the listeners registered for the event named `eventName`,\n   * in the order they were registered, passing the supplied arguments to each.\n   * Returns `true` if the event has listeners, `false` otherwise.\n   *\n   * @example\n   * const emitter = new Emitter<{ hello: [string] }>()\n   * emitter.emit('hello', 'John')\n   */\n  emit(eventName, ...data) {\n    const listeners = this._getListeners(eventName);\n    listeners.forEach((listener) => {\n      listener.apply(this, data);\n    });\n    return listeners.length > 0;\n  }\n  addListener(eventName, listener) {\n    this._emitInternalEvent(\"newListener\", eventName, listener);\n    const nextListeners = this._getListeners(eventName).concat(listener);\n    this.events.set(eventName, nextListeners);\n    if (this.maxListeners > 0 && this.listenerCount(eventName) > this.maxListeners && !this.hasWarnedAboutPotentialMemoryLeak) {\n      this.hasWarnedAboutPotentialMemoryLeak = true;\n      const memoryLeakWarning = new MemoryLeakError(\n        this,\n        eventName,\n        this.listenerCount(eventName)\n      );\n      console.warn(memoryLeakWarning);\n    }\n    return this;\n  }\n  on(eventName, listener) {\n    return this.addListener(eventName, listener);\n  }\n  once(eventName, listener) {\n    return this.addListener(\n      eventName,\n      this._wrapOnceListener(eventName, listener)\n    );\n  }\n  prependListener(eventName, listener) {\n    const listeners = this._getListeners(eventName);\n    if (listeners.length > 0) {\n      const nextListeners = [listener].concat(listeners);\n      this.events.set(eventName, nextListeners);\n    } else {\n      this.events.set(eventName, listeners.concat(listener));\n    }\n    return this;\n  }\n  prependOnceListener(eventName, listener) {\n    return this.prependListener(\n      eventName,\n      this._wrapOnceListener(eventName, listener)\n    );\n  }\n  removeListener(eventName, listener) {\n    const listeners = this._getListeners(eventName);\n    if (listeners.length > 0) {\n      this._removeListener(listeners, listener);\n      this.events.set(eventName, listeners);\n      this._emitInternalEvent(\"removeListener\", eventName, listener);\n    }\n    return this;\n  }\n  /**\n   * Alias for `emitter.removeListener()`.\n   *\n   * @example\n   * emitter.off('hello', listener)\n   */\n  off(eventName, listener) {\n    return this.removeListener(eventName, listener);\n  }\n  removeAllListeners(eventName) {\n    if (eventName) {\n      this.events.delete(eventName);\n    } else {\n      this.events.clear();\n    }\n    return this;\n  }\n  /**\n   * Returns a copy of the array of listeners for the event named `eventName`.\n   */\n  listeners(eventName) {\n    return Array.from(this._getListeners(eventName));\n  }\n  /**\n   * Returns the number of listeners listening to the event named `eventName`.\n   */\n  listenerCount(eventName) {\n    return this._getListeners(eventName).length;\n  }\n  rawListeners(eventName) {\n    return this.listeners(eventName);\n  }\n};\nvar Emitter = _Emitter;\nEmitter.defaultMaxListeners = 10;\nexport {\n  Emitter,\n  MemoryLeakError\n};\n//# sourceMappingURL=index.mjs.map","// src/Interceptor.ts\nimport { Logger } from \"@open-draft/logger\";\nimport { Emitter } from \"strict-event-emitter\";\nvar INTERNAL_REQUEST_ID_HEADER_NAME = \"x-interceptors-internal-request-id\";\nfunction getGlobalSymbol(symbol) {\n  return (\n    // @ts-ignore https://github.com/Microsoft/TypeScript/issues/24587\n    globalThis[symbol] || void 0\n  );\n}\nfunction setGlobalSymbol(symbol, value) {\n  globalThis[symbol] = value;\n}\nfunction deleteGlobalSymbol(symbol) {\n  delete globalThis[symbol];\n}\nvar InterceptorReadyState = /* @__PURE__ */ ((InterceptorReadyState2) => {\n  InterceptorReadyState2[\"INACTIVE\"] = \"INACTIVE\";\n  InterceptorReadyState2[\"APPLYING\"] = \"APPLYING\";\n  InterceptorReadyState2[\"APPLIED\"] = \"APPLIED\";\n  InterceptorReadyState2[\"DISPOSING\"] = \"DISPOSING\";\n  InterceptorReadyState2[\"DISPOSED\"] = \"DISPOSED\";\n  return InterceptorReadyState2;\n})(InterceptorReadyState || {});\nvar Interceptor = class {\n  constructor(symbol) {\n    this.symbol = symbol;\n    this.readyState = \"INACTIVE\" /* INACTIVE */;\n    this.emitter = new Emitter();\n    this.subscriptions = [];\n    this.logger = new Logger(symbol.description);\n    this.emitter.setMaxListeners(0);\n    this.logger.info(\"constructing the interceptor...\");\n  }\n  /**\n   * Determine if this interceptor can be applied\n   * in the current environment.\n   */\n  checkEnvironment() {\n    return true;\n  }\n  /**\n   * Apply this interceptor to the current process.\n   * Returns an already running interceptor instance if it's present.\n   */\n  apply() {\n    const logger = this.logger.extend(\"apply\");\n    logger.info(\"applying the interceptor...\");\n    if (this.readyState === \"APPLIED\" /* APPLIED */) {\n      logger.info(\"intercepted already applied!\");\n      return;\n    }\n    const shouldApply = this.checkEnvironment();\n    if (!shouldApply) {\n      logger.info(\"the interceptor cannot be applied in this environment!\");\n      return;\n    }\n    this.readyState = \"APPLYING\" /* APPLYING */;\n    const runningInstance = this.getInstance();\n    if (runningInstance) {\n      logger.info(\"found a running instance, reusing...\");\n      this.on = (event, listener) => {\n        logger.info('proxying the \"%s\" listener', event);\n        runningInstance.emitter.addListener(event, listener);\n        this.subscriptions.push(() => {\n          runningInstance.emitter.removeListener(event, listener);\n          logger.info('removed proxied \"%s\" listener!', event);\n        });\n        return this;\n      };\n      this.readyState = \"APPLIED\" /* APPLIED */;\n      return;\n    }\n    logger.info(\"no running instance found, setting up a new instance...\");\n    this.setup();\n    this.setInstance();\n    this.readyState = \"APPLIED\" /* APPLIED */;\n  }\n  /**\n   * Setup the module augments and stubs necessary for this interceptor.\n   * This method is not run if there's a running interceptor instance\n   * to prevent instantiating an interceptor multiple times.\n   */\n  setup() {\n  }\n  /**\n   * Listen to the interceptor's public events.\n   */\n  on(event, listener) {\n    const logger = this.logger.extend(\"on\");\n    if (this.readyState === \"DISPOSING\" /* DISPOSING */ || this.readyState === \"DISPOSED\" /* DISPOSED */) {\n      logger.info(\"cannot listen to events, already disposed!\");\n      return this;\n    }\n    logger.info('adding \"%s\" event listener:', event, listener);\n    this.emitter.on(event, listener);\n    return this;\n  }\n  once(event, listener) {\n    this.emitter.once(event, listener);\n    return this;\n  }\n  off(event, listener) {\n    this.emitter.off(event, listener);\n    return this;\n  }\n  removeAllListeners(event) {\n    this.emitter.removeAllListeners(event);\n    return this;\n  }\n  /**\n   * Disposes of any side-effects this interceptor has introduced.\n   */\n  dispose() {\n    const logger = this.logger.extend(\"dispose\");\n    if (this.readyState === \"DISPOSED\" /* DISPOSED */) {\n      logger.info(\"cannot dispose, already disposed!\");\n      return;\n    }\n    logger.info(\"disposing the interceptor...\");\n    this.readyState = \"DISPOSING\" /* DISPOSING */;\n    if (!this.getInstance()) {\n      logger.info(\"no interceptors running, skipping dispose...\");\n      return;\n    }\n    this.clearInstance();\n    logger.info(\"global symbol deleted:\", getGlobalSymbol(this.symbol));\n    if (this.subscriptions.length > 0) {\n      logger.info(\"disposing of %d subscriptions...\", this.subscriptions.length);\n      for (const dispose of this.subscriptions) {\n        dispose();\n      }\n      this.subscriptions = [];\n      logger.info(\"disposed of all subscriptions!\", this.subscriptions.length);\n    }\n    this.emitter.removeAllListeners();\n    logger.info(\"destroyed the listener!\");\n    this.readyState = \"DISPOSED\" /* DISPOSED */;\n  }\n  getInstance() {\n    var _a;\n    const instance = getGlobalSymbol(this.symbol);\n    this.logger.info(\"retrieved global instance:\", (_a = instance == null ? void 0 : instance.constructor) == null ? void 0 : _a.name);\n    return instance;\n  }\n  setInstance() {\n    setGlobalSymbol(this.symbol, this);\n    this.logger.info(\"set global instance!\", this.symbol.description);\n  }\n  clearInstance() {\n    deleteGlobalSymbol(this.symbol);\n    this.logger.info(\"cleared global instance!\", this.symbol.description);\n  }\n};\n\n// src/createRequestId.ts\nfunction createRequestId() {\n  return Math.random().toString(16).slice(2);\n}\n\nexport {\n  INTERNAL_REQUEST_ID_HEADER_NAME,\n  getGlobalSymbol,\n  deleteGlobalSymbol,\n  InterceptorReadyState,\n  Interceptor,\n  createRequestId\n};\n//# sourceMappingURL=chunk-QED3Q6Z2.mjs.map","import {\n  decodeBuffer,\n  encodeBuffer\n} from \"./chunk-6HYIRFX2.mjs\";\nimport {\n  IS_PATCHED_MODULE,\n  isResponseWithoutBody\n} from \"./chunk-OMISYKWR.mjs\";\nimport {\n  INTERNAL_REQUEST_ID_HEADER_NAME,\n  Interceptor,\n  InterceptorReadyState,\n  createRequestId,\n  deleteGlobalSymbol,\n  getGlobalSymbol\n} from \"./chunk-QED3Q6Z2.mjs\";\n\n// src/BatchInterceptor.ts\nvar BatchInterceptor = class extends Interceptor {\n  constructor(options) {\n    BatchInterceptor.symbol = Symbol(options.name);\n    super(BatchInterceptor.symbol);\n    this.interceptors = options.interceptors;\n  }\n  setup() {\n    const logger = this.logger.extend(\"setup\");\n    logger.info(\"applying all %d interceptors...\", this.interceptors.length);\n    for (const interceptor of this.interceptors) {\n      logger.info('applying \"%s\" interceptor...', interceptor.constructor.name);\n      interceptor.apply();\n      logger.info(\"adding interceptor dispose subscription\");\n      this.subscriptions.push(() => interceptor.dispose());\n    }\n  }\n  on(event, listener) {\n    for (const interceptor of this.interceptors) {\n      interceptor.on(event, listener);\n    }\n    return this;\n  }\n  once(event, listener) {\n    for (const interceptor of this.interceptors) {\n      interceptor.once(event, listener);\n    }\n    return this;\n  }\n  off(event, listener) {\n    for (const interceptor of this.interceptors) {\n      interceptor.off(event, listener);\n    }\n    return this;\n  }\n  removeAllListeners(event) {\n    for (const interceptors of this.interceptors) {\n      interceptors.removeAllListeners(event);\n    }\n    return this;\n  }\n};\n\n// src/utils/getCleanUrl.ts\nfunction getCleanUrl(url, isAbsolute = true) {\n  return [isAbsolute && url.origin, url.pathname].filter(Boolean).join(\"\");\n}\nexport {\n  BatchInterceptor,\n  INTERNAL_REQUEST_ID_HEADER_NAME,\n  IS_PATCHED_MODULE,\n  Interceptor,\n  InterceptorReadyState,\n  createRequestId,\n  decodeBuffer,\n  deleteGlobalSymbol,\n  encodeBuffer,\n  getCleanUrl,\n  getGlobalSymbol,\n  isResponseWithoutBody\n};\n//# sourceMappingURL=index.mjs.map","// src/createDeferredExecutor.ts\nfunction createDeferredExecutor() {\n  const executor = (resolve, reject) => {\n    executor.state = \"pending\";\n    executor.resolve = (data) => {\n      if (executor.state !== \"pending\") {\n        return;\n      }\n      executor.result = data;\n      const onFulfilled = (value) => {\n        executor.state = \"fulfilled\";\n        return value;\n      };\n      return resolve(\n        data instanceof Promise ? data : Promise.resolve(data).then(onFulfilled)\n      );\n    };\n    executor.reject = (reason) => {\n      if (executor.state !== \"pending\") {\n        return;\n      }\n      queueMicrotask(() => {\n        executor.state = \"rejected\";\n      });\n      return reject(executor.rejectionReason = reason);\n    };\n  };\n  return executor;\n}\n\n// src/DeferredPromise.ts\nvar DeferredPromise = class extends Promise {\n  #executor;\n  resolve;\n  reject;\n  constructor(executor = null) {\n    const deferredExecutor = createDeferredExecutor();\n    super((originalResolve, originalReject) => {\n      deferredExecutor(originalResolve, originalReject);\n      executor?.(deferredExecutor.resolve, deferredExecutor.reject);\n    });\n    this.#executor = deferredExecutor;\n    this.resolve = this.#executor.resolve;\n    this.reject = this.#executor.reject;\n  }\n  get state() {\n    return this.#executor.state;\n  }\n  get rejectionReason() {\n    return this.#executor.rejectionReason;\n  }\n  then(onFulfilled, onRejected) {\n    return this.#decorate(super.then(onFulfilled, onRejected));\n  }\n  catch(onRejected) {\n    return this.#decorate(super.catch(onRejected));\n  }\n  finally(onfinally) {\n    return this.#decorate(super.finally(onfinally));\n  }\n  #decorate(promise) {\n    return Object.defineProperties(promise, {\n      resolve: { configurable: true, value: this.resolve },\n      reject: { configurable: true, value: this.reject }\n    });\n  }\n};\nexport {\n  DeferredPromise,\n  createDeferredExecutor\n};\n//# sourceMappingURL=index.mjs.map","// src/utils/RequestController.ts\nimport { invariant } from \"outvariant\";\nimport { DeferredPromise } from \"@open-draft/deferred-promise\";\nvar RequestController = class {\n  constructor(request) {\n    this.request = request;\n    this.responsePromise = new DeferredPromise();\n  }\n  respondWith(response) {\n    invariant(\n      this.responsePromise.state === \"pending\",\n      'Failed to respond to \"%s %s\" request: the \"request\" event has already been responded to.',\n      this.request.method,\n      this.request.url\n    );\n    this.responsePromise.resolve(response);\n  }\n};\n\n// src/utils/toInteractiveRequest.ts\nfunction toInteractiveRequest(request) {\n  const requestController = new RequestController(request);\n  Reflect.set(\n    request,\n    \"respondWith\",\n    requestController.respondWith.bind(requestController)\n  );\n  return {\n    interactiveRequest: request,\n    requestController\n  };\n}\n\n// src/utils/emitAsync.ts\nasync function emitAsync(emitter, eventName, ...data) {\n  const listners = emitter.listeners(eventName);\n  if (listners.length === 0) {\n    return;\n  }\n  for (const listener of listners) {\n    await listener.apply(emitter, data);\n  }\n}\n\nexport {\n  toInteractiveRequest,\n  emitAsync\n};\n//# sourceMappingURL=chunk-OUWBQF3Z.mjs.map","// src/until.ts\nvar until = async (promise) => {\n  try {\n    const data = await promise().catch((error) => {\n      throw error;\n    });\n    return { error: null, data };\n  } catch (error) {\n    return { error, data: null };\n  }\n};\nexport {\n  until\n};\n//# sourceMappingURL=index.mjs.map","import {\n  emitAsync,\n  toInteractiveRequest\n} from \"./chunk-OUWBQF3Z.mjs\";\nimport {\n  IS_PATCHED_MODULE,\n  createServerErrorResponse,\n  isResponseError\n} from \"./chunk-OMISYKWR.mjs\";\nimport {\n  Interceptor,\n  createRequestId\n} from \"./chunk-QED3Q6Z2.mjs\";\n\n// src/interceptors/fetch/index.ts\nimport { invariant } from \"outvariant\";\nimport { DeferredPromise } from \"@open-draft/deferred-promise\";\nimport { until } from \"@open-draft/until\";\n\n// src/utils/canParseUrl.ts\nfunction canParseUrl(url) {\n  try {\n    new URL(url);\n    return true;\n  } catch (_error) {\n    return false;\n  }\n}\n\n// src/interceptors/fetch/index.ts\nvar _FetchInterceptor = class extends Interceptor {\n  constructor() {\n    super(_FetchInterceptor.symbol);\n  }\n  checkEnvironment() {\n    return typeof globalThis !== \"undefined\" && typeof globalThis.fetch !== \"undefined\";\n  }\n  async setup() {\n    const pureFetch = globalThis.fetch;\n    invariant(\n      !pureFetch[IS_PATCHED_MODULE],\n      'Failed to patch the \"fetch\" module: already patched.'\n    );\n    globalThis.fetch = async (input, init) => {\n      var _a;\n      const requestId = createRequestId();\n      const resolvedInput = typeof input === \"string\" && typeof location !== \"undefined\" && !canParseUrl(input) ? new URL(input, location.origin) : input;\n      const request = new Request(resolvedInput, init);\n      this.logger.info(\"[%s] %s\", request.method, request.url);\n      const { interactiveRequest, requestController } = toInteractiveRequest(request);\n      this.logger.info(\n        'emitting the \"request\" event for %d listener(s)...',\n        this.emitter.listenerCount(\"request\")\n      );\n      this.emitter.once(\"request\", ({ requestId: pendingRequestId }) => {\n        if (pendingRequestId !== requestId) {\n          return;\n        }\n        if (requestController.responsePromise.state === \"pending\") {\n          requestController.responsePromise.resolve(void 0);\n        }\n      });\n      this.logger.info(\"awaiting for the mocked response...\");\n      const signal = interactiveRequest.signal;\n      const requestAborted = new DeferredPromise();\n      if (signal) {\n        signal.addEventListener(\n          \"abort\",\n          () => {\n            requestAborted.reject(signal.reason);\n          },\n          { once: true }\n        );\n      }\n      const responsePromise = new DeferredPromise();\n      const respondWith = (response) => {\n        this.logger.info(\"responding with a mock response:\", response);\n        if (this.emitter.listenerCount(\"response\") > 0) {\n          this.logger.info('emitting the \"response\" event...');\n          const responseClone = response.clone();\n          this.emitter.emit(\"response\", {\n            response: responseClone,\n            isMockedResponse: true,\n            request: interactiveRequest,\n            requestId\n          });\n        }\n        Object.defineProperty(response, \"url\", {\n          writable: false,\n          enumerable: true,\n          configurable: false,\n          value: request.url\n        });\n        responsePromise.resolve(response);\n      };\n      const errorWith = (reason) => {\n        responsePromise.reject(reason);\n      };\n      const resolverResult = await until(\n        async () => {\n          const listenersFinished = emitAsync(this.emitter, \"request\", {\n            request: interactiveRequest,\n            requestId\n          });\n          await Promise.race([\n            requestAborted,\n            // Put the listeners invocation Promise in the same race condition\n            // with the request abort Promise because otherwise awaiting the listeners\n            // would always yield some response (or undefined).\n            listenersFinished,\n            requestController.responsePromise\n          ]);\n          this.logger.info(\"all request listeners have been resolved!\");\n          const mockedResponse2 = await requestController.responsePromise;\n          this.logger.info(\"event.respondWith called with:\", mockedResponse2);\n          return mockedResponse2;\n        }\n      );\n      if (requestAborted.state === \"rejected\") {\n        this.logger.info(\n          \"request has been aborted:\",\n          requestAborted.rejectionReason\n        );\n        responsePromise.reject(requestAborted.rejectionReason);\n        return responsePromise;\n      }\n      if (resolverResult.error) {\n        this.logger.info(\n          \"request listerner threw an error:\",\n          resolverResult.error\n        );\n        if (resolverResult.error instanceof Response) {\n          if (isResponseError(resolverResult.error)) {\n            errorWith(createNetworkError(resolverResult.error));\n          } else {\n            respondWith(resolverResult.error);\n          }\n        }\n        if (this.emitter.listenerCount(\"unhandledException\") > 0) {\n          await emitAsync(this.emitter, \"unhandledException\", {\n            error: resolverResult.error,\n            request,\n            requestId,\n            controller: {\n              respondWith,\n              errorWith\n            }\n          });\n          if (responsePromise.state !== \"pending\") {\n            return responsePromise;\n          }\n        }\n        respondWith(createServerErrorResponse(resolverResult.error));\n        return responsePromise;\n      }\n      const mockedResponse = resolverResult.data;\n      if (mockedResponse && !((_a = request.signal) == null ? void 0 : _a.aborted)) {\n        this.logger.info(\"received mocked response:\", mockedResponse);\n        if (isResponseError(mockedResponse)) {\n          this.logger.info(\n            \"received a network error response, rejecting the request promise...\"\n          );\n          errorWith(createNetworkError(mockedResponse));\n        } else {\n          respondWith(mockedResponse);\n        }\n        return responsePromise;\n      }\n      this.logger.info(\"no mocked response received!\");\n      return pureFetch(request).then((response) => {\n        this.logger.info(\"original fetch performed\", response);\n        if (this.emitter.listenerCount(\"response\") > 0) {\n          this.logger.info('emitting the \"response\" event...');\n          const responseClone = response.clone();\n          this.emitter.emit(\"response\", {\n            response: responseClone,\n            isMockedResponse: false,\n            request: interactiveRequest,\n            requestId\n          });\n        }\n        return response;\n      });\n    };\n    Object.defineProperty(globalThis.fetch, IS_PATCHED_MODULE, {\n      enumerable: true,\n      configurable: true,\n      value: true\n    });\n    this.subscriptions.push(() => {\n      Object.defineProperty(globalThis.fetch, IS_PATCHED_MODULE, {\n        value: void 0\n      });\n      globalThis.fetch = pureFetch;\n      this.logger.info(\n        'restored native \"globalThis.fetch\"!',\n        globalThis.fetch.name\n      );\n    });\n  }\n};\nvar FetchInterceptor = _FetchInterceptor;\nFetchInterceptor.symbol = Symbol(\"fetch\");\nfunction createNetworkError(cause) {\n  return Object.assign(new TypeError(\"Failed to fetch\"), {\n    cause\n  });\n}\n\nexport {\n  FetchInterceptor\n};\n//# sourceMappingURL=chunk-MAEPOYB6.mjs.map","import {\n  decodeBuffer,\n  encodeBuffer,\n  toArrayBuffer\n} from \"./chunk-6HYIRFX2.mjs\";\nimport {\n  emitAsync,\n  toInteractiveRequest\n} from \"./chunk-OUWBQF3Z.mjs\";\nimport {\n  IS_PATCHED_MODULE,\n  createServerErrorResponse,\n  isResponseError,\n  isResponseWithoutBody\n} from \"./chunk-OMISYKWR.mjs\";\nimport {\n  INTERNAL_REQUEST_ID_HEADER_NAME,\n  Interceptor,\n  createRequestId\n} from \"./chunk-QED3Q6Z2.mjs\";\n\n// src/interceptors/XMLHttpRequest/index.ts\nimport { invariant as invariant2 } from \"outvariant\";\n\n// src/interceptors/XMLHttpRequest/XMLHttpRequestProxy.ts\nimport { until } from \"@open-draft/until\";\n\n// src/interceptors/XMLHttpRequest/XMLHttpRequestController.ts\nimport { invariant } from \"outvariant\";\nimport { isNodeProcess } from \"is-node-process\";\n\n// src/interceptors/XMLHttpRequest/utils/concatArrayBuffer.ts\nfunction concatArrayBuffer(left, right) {\n  const result = new Uint8Array(left.byteLength + right.byteLength);\n  result.set(left, 0);\n  result.set(right, left.byteLength);\n  return result;\n}\n\n// src/interceptors/XMLHttpRequest/polyfills/EventPolyfill.ts\nvar EventPolyfill = class {\n  constructor(type, options) {\n    this.AT_TARGET = 0;\n    this.BUBBLING_PHASE = 0;\n    this.CAPTURING_PHASE = 0;\n    this.NONE = 0;\n    this.type = \"\";\n    this.srcElement = null;\n    this.currentTarget = null;\n    this.eventPhase = 0;\n    this.isTrusted = true;\n    this.composed = false;\n    this.cancelable = true;\n    this.defaultPrevented = false;\n    this.bubbles = true;\n    this.lengthComputable = true;\n    this.loaded = 0;\n    this.total = 0;\n    this.cancelBubble = false;\n    this.returnValue = true;\n    this.type = type;\n    this.target = (options == null ? void 0 : options.target) || null;\n    this.currentTarget = (options == null ? void 0 : options.currentTarget) || null;\n    this.timeStamp = Date.now();\n  }\n  composedPath() {\n    return [];\n  }\n  initEvent(type, bubbles, cancelable) {\n    this.type = type;\n    this.bubbles = !!bubbles;\n    this.cancelable = !!cancelable;\n  }\n  preventDefault() {\n    this.defaultPrevented = true;\n  }\n  stopPropagation() {\n  }\n  stopImmediatePropagation() {\n  }\n};\n\n// src/interceptors/XMLHttpRequest/polyfills/ProgressEventPolyfill.ts\nvar ProgressEventPolyfill = class extends EventPolyfill {\n  constructor(type, init) {\n    super(type);\n    this.lengthComputable = (init == null ? void 0 : init.lengthComputable) || false;\n    this.composed = (init == null ? void 0 : init.composed) || false;\n    this.loaded = (init == null ? void 0 : init.loaded) || 0;\n    this.total = (init == null ? void 0 : init.total) || 0;\n  }\n};\n\n// src/interceptors/XMLHttpRequest/utils/createEvent.ts\nvar SUPPORTS_PROGRESS_EVENT = typeof ProgressEvent !== \"undefined\";\nfunction createEvent(target, type, init) {\n  const progressEvents = [\n    \"error\",\n    \"progress\",\n    \"loadstart\",\n    \"loadend\",\n    \"load\",\n    \"timeout\",\n    \"abort\"\n  ];\n  const ProgressEventClass = SUPPORTS_PROGRESS_EVENT ? ProgressEvent : ProgressEventPolyfill;\n  const event = progressEvents.includes(type) ? new ProgressEventClass(type, {\n    lengthComputable: true,\n    loaded: (init == null ? void 0 : init.loaded) || 0,\n    total: (init == null ? void 0 : init.total) || 0\n  }) : new EventPolyfill(type, {\n    target,\n    currentTarget: target\n  });\n  return event;\n}\n\n// src/utils/findPropertySource.ts\nfunction findPropertySource(target, propertyName) {\n  if (!(propertyName in target)) {\n    return null;\n  }\n  const hasProperty = Object.prototype.hasOwnProperty.call(target, propertyName);\n  if (hasProperty) {\n    return target;\n  }\n  const prototype = Reflect.getPrototypeOf(target);\n  return prototype ? findPropertySource(prototype, propertyName) : null;\n}\n\n// src/utils/createProxy.ts\nfunction createProxy(target, options) {\n  const proxy = new Proxy(target, optionsToProxyHandler(options));\n  return proxy;\n}\nfunction optionsToProxyHandler(options) {\n  const { constructorCall, methodCall, getProperty, setProperty } = options;\n  const handler = {};\n  if (typeof constructorCall !== \"undefined\") {\n    handler.construct = function(target, args, newTarget) {\n      const next = Reflect.construct.bind(null, target, args, newTarget);\n      return constructorCall.call(newTarget, args, next);\n    };\n  }\n  handler.set = function(target, propertyName, nextValue) {\n    const next = () => {\n      const propertySource = findPropertySource(target, propertyName) || target;\n      const ownDescriptors = Reflect.getOwnPropertyDescriptor(\n        propertySource,\n        propertyName\n      );\n      if (typeof (ownDescriptors == null ? void 0 : ownDescriptors.set) !== \"undefined\") {\n        ownDescriptors.set.apply(target, [nextValue]);\n        return true;\n      }\n      return Reflect.defineProperty(propertySource, propertyName, {\n        writable: true,\n        enumerable: true,\n        configurable: true,\n        value: nextValue\n      });\n    };\n    if (typeof setProperty !== \"undefined\") {\n      return setProperty.call(target, [propertyName, nextValue], next);\n    }\n    return next();\n  };\n  handler.get = function(target, propertyName, receiver) {\n    const next = () => target[propertyName];\n    const value = typeof getProperty !== \"undefined\" ? getProperty.call(target, [propertyName, receiver], next) : next();\n    if (typeof value === \"function\") {\n      return (...args) => {\n        const next2 = value.bind(target, ...args);\n        if (typeof methodCall !== \"undefined\") {\n          return methodCall.call(target, [propertyName, args], next2);\n        }\n        return next2();\n      };\n    }\n    return value;\n  };\n  return handler;\n}\n\n// src/interceptors/XMLHttpRequest/utils/isDomParserSupportedType.ts\nfunction isDomParserSupportedType(type) {\n  const supportedTypes = [\n    \"application/xhtml+xml\",\n    \"application/xml\",\n    \"image/svg+xml\",\n    \"text/html\",\n    \"text/xml\"\n  ];\n  return supportedTypes.some((supportedType) => {\n    return type.startsWith(supportedType);\n  });\n}\n\n// src/utils/parseJson.ts\nfunction parseJson(data) {\n  try {\n    const json = JSON.parse(data);\n    return json;\n  } catch (_) {\n    return null;\n  }\n}\n\n// src/interceptors/XMLHttpRequest/utils/createResponse.ts\nfunction createResponse(request, body) {\n  const responseBodyOrNull = isResponseWithoutBody(request.status) ? null : body;\n  return new Response(responseBodyOrNull, {\n    status: request.status,\n    statusText: request.statusText,\n    headers: createHeadersFromXMLHttpReqestHeaders(\n      request.getAllResponseHeaders()\n    )\n  });\n}\nfunction createHeadersFromXMLHttpReqestHeaders(headersString) {\n  const headers = new Headers();\n  const lines = headersString.split(/[\\r\\n]+/);\n  for (const line of lines) {\n    if (line.trim() === \"\") {\n      continue;\n    }\n    const [name, ...parts] = line.split(\": \");\n    const value = parts.join(\": \");\n    headers.append(name, value);\n  }\n  return headers;\n}\n\n// src/interceptors/XMLHttpRequest/XMLHttpRequestController.ts\nvar IS_MOCKED_RESPONSE = Symbol(\"isMockedResponse\");\nvar IS_NODE = isNodeProcess();\nvar XMLHttpRequestController = class {\n  constructor(initialRequest, logger) {\n    this.initialRequest = initialRequest;\n    this.logger = logger;\n    this.method = \"GET\";\n    this.url = null;\n    this.events = /* @__PURE__ */ new Map();\n    this.requestId = createRequestId();\n    this.requestHeaders = new Headers();\n    this.responseBuffer = new Uint8Array();\n    this.request = createProxy(initialRequest, {\n      setProperty: ([propertyName, nextValue], invoke) => {\n        switch (propertyName) {\n          case \"ontimeout\": {\n            const eventName = propertyName.slice(\n              2\n            );\n            this.request.addEventListener(eventName, nextValue);\n            return invoke();\n          }\n          default: {\n            return invoke();\n          }\n        }\n      },\n      methodCall: ([methodName, args], invoke) => {\n        var _a;\n        switch (methodName) {\n          case \"open\": {\n            const [method, url] = args;\n            if (typeof url === \"undefined\") {\n              this.method = \"GET\";\n              this.url = toAbsoluteUrl(method);\n            } else {\n              this.method = method;\n              this.url = toAbsoluteUrl(url);\n            }\n            this.logger = this.logger.extend(`${this.method} ${this.url.href}`);\n            this.logger.info(\"open\", this.method, this.url.href);\n            return invoke();\n          }\n          case \"addEventListener\": {\n            const [eventName, listener] = args;\n            this.registerEvent(eventName, listener);\n            this.logger.info(\"addEventListener\", eventName, listener);\n            return invoke();\n          }\n          case \"setRequestHeader\": {\n            const [name, value] = args;\n            this.requestHeaders.set(name, value);\n            this.logger.info(\"setRequestHeader\", name, value);\n            return invoke();\n          }\n          case \"send\": {\n            const [body] = args;\n            if (body != null) {\n              this.requestBody = typeof body === \"string\" ? encodeBuffer(body) : body;\n            }\n            this.request.addEventListener(\"load\", () => {\n              if (typeof this.onResponse !== \"undefined\") {\n                const fetchResponse = createResponse(\n                  this.request,\n                  /**\n                   * The `response` property is the right way to read\n                   * the ambiguous response body, as the request's \"responseType\" may differ.\n                   * @see https://xhr.spec.whatwg.org/#the-response-attribute\n                   */\n                  this.request.response\n                );\n                this.onResponse.call(this, {\n                  response: fetchResponse,\n                  isMockedResponse: IS_MOCKED_RESPONSE in this.request,\n                  request: fetchRequest,\n                  requestId: this.requestId\n                });\n              }\n            });\n            const fetchRequest = this.toFetchApiRequest();\n            const onceRequestSettled = ((_a = this.onRequest) == null ? void 0 : _a.call(this, {\n              request: fetchRequest,\n              requestId: this.requestId\n            })) || Promise.resolve();\n            onceRequestSettled.finally(() => {\n              if (this.request.readyState < this.request.LOADING) {\n                this.logger.info(\n                  \"request callback settled but request has not been handled (readystate %d), performing as-is...\",\n                  this.request.readyState\n                );\n                if (IS_NODE) {\n                  this.request.setRequestHeader(\n                    INTERNAL_REQUEST_ID_HEADER_NAME,\n                    this.requestId\n                  );\n                }\n                return invoke();\n              }\n            });\n            break;\n          }\n          default: {\n            return invoke();\n          }\n        }\n      }\n    });\n  }\n  registerEvent(eventName, listener) {\n    const prevEvents = this.events.get(eventName) || [];\n    const nextEvents = prevEvents.concat(listener);\n    this.events.set(eventName, nextEvents);\n    this.logger.info('registered event \"%s\"', eventName, listener);\n  }\n  /**\n   * Responds to the current request with the given\n   * Fetch API `Response` instance.\n   */\n  respondWith(response) {\n    this.logger.info(\n      \"responding with a mocked response: %d %s\",\n      response.status,\n      response.statusText\n    );\n    define(this.request, IS_MOCKED_RESPONSE, true);\n    define(this.request, \"status\", response.status);\n    define(this.request, \"statusText\", response.statusText);\n    define(this.request, \"responseURL\", this.url.href);\n    this.request.getResponseHeader = new Proxy(this.request.getResponseHeader, {\n      apply: (_, __, args) => {\n        this.logger.info(\"getResponseHeader\", args[0]);\n        if (this.request.readyState < this.request.HEADERS_RECEIVED) {\n          this.logger.info(\"headers not received yet, returning null\");\n          return null;\n        }\n        const headerValue = response.headers.get(args[0]);\n        this.logger.info(\n          'resolved response header \"%s\" to',\n          args[0],\n          headerValue\n        );\n        return headerValue;\n      }\n    });\n    this.request.getAllResponseHeaders = new Proxy(\n      this.request.getAllResponseHeaders,\n      {\n        apply: () => {\n          this.logger.info(\"getAllResponseHeaders\");\n          if (this.request.readyState < this.request.HEADERS_RECEIVED) {\n            this.logger.info(\"headers not received yet, returning empty string\");\n            return \"\";\n          }\n          const headersList = Array.from(response.headers.entries());\n          const allHeaders = headersList.map(([headerName, headerValue]) => {\n            return `${headerName}: ${headerValue}`;\n          }).join(\"\\r\\n\");\n          this.logger.info(\"resolved all response headers to\", allHeaders);\n          return allHeaders;\n        }\n      }\n    );\n    Object.defineProperties(this.request, {\n      response: {\n        enumerable: true,\n        configurable: false,\n        get: () => this.response\n      },\n      responseText: {\n        enumerable: true,\n        configurable: false,\n        get: () => this.responseText\n      },\n      responseXML: {\n        enumerable: true,\n        configurable: false,\n        get: () => this.responseXML\n      }\n    });\n    const totalResponseBodyLength = response.headers.has(\"Content-Length\") ? Number(response.headers.get(\"Content-Length\")) : (\n      /**\n       * @todo Infer the response body length from the response body.\n       */\n      void 0\n    );\n    this.logger.info(\"calculated response body length\", totalResponseBodyLength);\n    this.trigger(\"loadstart\", {\n      loaded: 0,\n      total: totalResponseBodyLength\n    });\n    this.setReadyState(this.request.HEADERS_RECEIVED);\n    this.setReadyState(this.request.LOADING);\n    const finalizeResponse = () => {\n      this.logger.info(\"finalizing the mocked response...\");\n      this.setReadyState(this.request.DONE);\n      this.trigger(\"load\", {\n        loaded: this.responseBuffer.byteLength,\n        total: totalResponseBodyLength\n      });\n      this.trigger(\"loadend\", {\n        loaded: this.responseBuffer.byteLength,\n        total: totalResponseBodyLength\n      });\n    };\n    if (response.body) {\n      this.logger.info(\"mocked response has body, streaming...\");\n      const reader = response.body.getReader();\n      const readNextResponseBodyChunk = async () => {\n        const { value, done } = await reader.read();\n        if (done) {\n          this.logger.info(\"response body stream done!\");\n          finalizeResponse();\n          return;\n        }\n        if (value) {\n          this.logger.info(\"read response body chunk:\", value);\n          this.responseBuffer = concatArrayBuffer(this.responseBuffer, value);\n          this.trigger(\"progress\", {\n            loaded: this.responseBuffer.byteLength,\n            total: totalResponseBodyLength\n          });\n        }\n        readNextResponseBodyChunk();\n      };\n      readNextResponseBodyChunk();\n    } else {\n      finalizeResponse();\n    }\n  }\n  responseBufferToText() {\n    return decodeBuffer(this.responseBuffer);\n  }\n  get response() {\n    this.logger.info(\n      \"getResponse (responseType: %s)\",\n      this.request.responseType\n    );\n    if (this.request.readyState !== this.request.DONE) {\n      return null;\n    }\n    switch (this.request.responseType) {\n      case \"json\": {\n        const responseJson = parseJson(this.responseBufferToText());\n        this.logger.info(\"resolved response JSON\", responseJson);\n        return responseJson;\n      }\n      case \"arraybuffer\": {\n        const arrayBuffer = toArrayBuffer(this.responseBuffer);\n        this.logger.info(\"resolved response ArrayBuffer\", arrayBuffer);\n        return arrayBuffer;\n      }\n      case \"blob\": {\n        const mimeType = this.request.getResponseHeader(\"Content-Type\") || \"text/plain\";\n        const responseBlob = new Blob([this.responseBufferToText()], {\n          type: mimeType\n        });\n        this.logger.info(\n          \"resolved response Blob (mime type: %s)\",\n          responseBlob,\n          mimeType\n        );\n        return responseBlob;\n      }\n      default: {\n        const responseText = this.responseBufferToText();\n        this.logger.info(\n          'resolving \"%s\" response type as text',\n          this.request.responseType,\n          responseText\n        );\n        return responseText;\n      }\n    }\n  }\n  get responseText() {\n    invariant(\n      this.request.responseType === \"\" || this.request.responseType === \"text\",\n      \"InvalidStateError: The object is in invalid state.\"\n    );\n    if (this.request.readyState !== this.request.LOADING && this.request.readyState !== this.request.DONE) {\n      return \"\";\n    }\n    const responseText = this.responseBufferToText();\n    this.logger.info('getResponseText: \"%s\"', responseText);\n    return responseText;\n  }\n  get responseXML() {\n    invariant(\n      this.request.responseType === \"\" || this.request.responseType === \"document\",\n      \"InvalidStateError: The object is in invalid state.\"\n    );\n    if (this.request.readyState !== this.request.DONE) {\n      return null;\n    }\n    const contentType = this.request.getResponseHeader(\"Content-Type\") || \"\";\n    if (typeof DOMParser === \"undefined\") {\n      console.warn(\n        \"Cannot retrieve XMLHttpRequest response body as XML: DOMParser is not defined. You are likely using an environment that is not browser or does not polyfill browser globals correctly.\"\n      );\n      return null;\n    }\n    if (isDomParserSupportedType(contentType)) {\n      return new DOMParser().parseFromString(\n        this.responseBufferToText(),\n        contentType\n      );\n    }\n    return null;\n  }\n  errorWith(error) {\n    this.logger.info(\"responding with an error\");\n    this.setReadyState(this.request.DONE);\n    this.trigger(\"error\");\n    this.trigger(\"loadend\");\n  }\n  /**\n   * Transitions this request's `readyState` to the given one.\n   */\n  setReadyState(nextReadyState) {\n    this.logger.info(\n      \"setReadyState: %d -> %d\",\n      this.request.readyState,\n      nextReadyState\n    );\n    if (this.request.readyState === nextReadyState) {\n      this.logger.info(\"ready state identical, skipping transition...\");\n      return;\n    }\n    define(this.request, \"readyState\", nextReadyState);\n    this.logger.info(\"set readyState to: %d\", nextReadyState);\n    if (nextReadyState !== this.request.UNSENT) {\n      this.logger.info('triggerring \"readystatechange\" event...');\n      this.trigger(\"readystatechange\");\n    }\n  }\n  /**\n   * Triggers given event on the `XMLHttpRequest` instance.\n   */\n  trigger(eventName, options) {\n    const callback = this.request[`on${eventName}`];\n    const event = createEvent(this.request, eventName, options);\n    this.logger.info('trigger \"%s\"', eventName, options || \"\");\n    if (typeof callback === \"function\") {\n      this.logger.info('found a direct \"%s\" callback, calling...', eventName);\n      callback.call(this.request, event);\n    }\n    for (const [registeredEventName, listeners] of this.events) {\n      if (registeredEventName === eventName) {\n        this.logger.info(\n          'found %d listener(s) for \"%s\" event, calling...',\n          listeners.length,\n          eventName\n        );\n        listeners.forEach((listener) => listener.call(this.request, event));\n      }\n    }\n  }\n  /**\n   * Converts this `XMLHttpRequest` instance into a Fetch API `Request` instance.\n   */\n  toFetchApiRequest() {\n    this.logger.info(\"converting request to a Fetch API Request...\");\n    const fetchRequest = new Request(this.url.href, {\n      method: this.method,\n      headers: this.requestHeaders,\n      /**\n       * @see https://xhr.spec.whatwg.org/#cross-origin-credentials\n       */\n      credentials: this.request.withCredentials ? \"include\" : \"same-origin\",\n      body: [\"GET\", \"HEAD\"].includes(this.method) ? null : this.requestBody\n    });\n    const proxyHeaders = createProxy(fetchRequest.headers, {\n      methodCall: ([methodName, args], invoke) => {\n        switch (methodName) {\n          case \"append\":\n          case \"set\": {\n            const [headerName, headerValue] = args;\n            this.request.setRequestHeader(headerName, headerValue);\n            break;\n          }\n          case \"delete\": {\n            const [headerName] = args;\n            console.warn(\n              `XMLHttpRequest: Cannot remove a \"${headerName}\" header from the Fetch API representation of the \"${fetchRequest.method} ${fetchRequest.url}\" request. XMLHttpRequest headers cannot be removed.`\n            );\n            break;\n          }\n        }\n        return invoke();\n      }\n    });\n    define(fetchRequest, \"headers\", proxyHeaders);\n    this.logger.info(\"converted request to a Fetch API Request!\", fetchRequest);\n    return fetchRequest;\n  }\n};\nfunction toAbsoluteUrl(url) {\n  if (typeof location === \"undefined\") {\n    return new URL(url);\n  }\n  return new URL(url.toString(), location.href);\n}\nfunction define(target, property, value) {\n  Reflect.defineProperty(target, property, {\n    // Ensure writable properties to allow redefining readonly properties.\n    writable: true,\n    enumerable: true,\n    value\n  });\n}\n\n// src/interceptors/XMLHttpRequest/XMLHttpRequestProxy.ts\nfunction createXMLHttpRequestProxy({\n  emitter,\n  logger\n}) {\n  const XMLHttpRequestProxy = new Proxy(globalThis.XMLHttpRequest, {\n    construct(target, args, newTarget) {\n      logger.info(\"constructed new XMLHttpRequest\");\n      const originalRequest = Reflect.construct(\n        target,\n        args,\n        newTarget\n      );\n      const prototypeDescriptors = Object.getOwnPropertyDescriptors(\n        target.prototype\n      );\n      for (const propertyName in prototypeDescriptors) {\n        Reflect.defineProperty(\n          originalRequest,\n          propertyName,\n          prototypeDescriptors[propertyName]\n        );\n      }\n      const xhrRequestController = new XMLHttpRequestController(\n        originalRequest,\n        logger\n      );\n      xhrRequestController.onRequest = async function({ request, requestId }) {\n        const { interactiveRequest, requestController } = toInteractiveRequest(request);\n        this.logger.info(\"awaiting mocked response...\");\n        emitter.once(\"request\", ({ requestId: pendingRequestId }) => {\n          if (pendingRequestId !== requestId) {\n            return;\n          }\n          if (requestController.responsePromise.state === \"pending\") {\n            requestController.respondWith(void 0);\n          }\n        });\n        const resolverResult = await until(async () => {\n          this.logger.info(\n            'emitting the \"request\" event for %s listener(s)...',\n            emitter.listenerCount(\"request\")\n          );\n          await emitAsync(emitter, \"request\", {\n            request: interactiveRequest,\n            requestId\n          });\n          this.logger.info('all \"request\" listeners settled!');\n          const mockedResponse2 = await requestController.responsePromise;\n          this.logger.info(\"event.respondWith called with:\", mockedResponse2);\n          return mockedResponse2;\n        });\n        if (resolverResult.error) {\n          this.logger.info(\n            \"request listener threw an exception, aborting request...\",\n            resolverResult.error\n          );\n          if (resolverResult.error instanceof Response) {\n            if (isResponseError(resolverResult.error)) {\n              xhrRequestController.errorWith(new TypeError(\"Network error\"));\n            } else {\n              this.respondWith(resolverResult.error);\n            }\n            return;\n          }\n          if (emitter.listenerCount(\"unhandledException\") > 0) {\n            await emitAsync(emitter, \"unhandledException\", {\n              error: resolverResult.error,\n              request,\n              requestId,\n              controller: {\n                respondWith: xhrRequestController.respondWith.bind(xhrRequestController),\n                errorWith: xhrRequestController.errorWith.bind(xhrRequestController)\n              }\n            });\n            if (originalRequest.readyState > XMLHttpRequest.OPENED) {\n              return;\n            }\n          }\n          xhrRequestController.respondWith(\n            createServerErrorResponse(resolverResult.error)\n          );\n          return;\n        }\n        const mockedResponse = resolverResult.data;\n        if (typeof mockedResponse !== \"undefined\") {\n          this.logger.info(\n            \"received mocked response: %d %s\",\n            mockedResponse.status,\n            mockedResponse.statusText\n          );\n          if (isResponseError(mockedResponse)) {\n            this.logger.info(\n              \"received a network error response, rejecting the request promise...\"\n            );\n            xhrRequestController.errorWith(new TypeError(\"Network error\"));\n            return;\n          }\n          return xhrRequestController.respondWith(mockedResponse);\n        }\n        this.logger.info(\n          \"no mocked response received, performing request as-is...\"\n        );\n      };\n      xhrRequestController.onResponse = async function({\n        response,\n        isMockedResponse,\n        request,\n        requestId\n      }) {\n        this.logger.info(\n          'emitting the \"response\" event for %s listener(s)...',\n          emitter.listenerCount(\"response\")\n        );\n        emitter.emit(\"response\", {\n          response,\n          isMockedResponse,\n          request,\n          requestId\n        });\n      };\n      return xhrRequestController.request;\n    }\n  });\n  return XMLHttpRequestProxy;\n}\n\n// src/interceptors/XMLHttpRequest/index.ts\nvar _XMLHttpRequestInterceptor = class extends Interceptor {\n  constructor() {\n    super(_XMLHttpRequestInterceptor.interceptorSymbol);\n  }\n  checkEnvironment() {\n    return typeof globalThis.XMLHttpRequest !== \"undefined\";\n  }\n  setup() {\n    const logger = this.logger.extend(\"setup\");\n    logger.info('patching \"XMLHttpRequest\" module...');\n    const PureXMLHttpRequest = globalThis.XMLHttpRequest;\n    invariant2(\n      !PureXMLHttpRequest[IS_PATCHED_MODULE],\n      'Failed to patch the \"XMLHttpRequest\" module: already patched.'\n    );\n    globalThis.XMLHttpRequest = createXMLHttpRequestProxy({\n      emitter: this.emitter,\n      logger: this.logger\n    });\n    logger.info(\n      'native \"XMLHttpRequest\" module patched!',\n      globalThis.XMLHttpRequest.name\n    );\n    Object.defineProperty(globalThis.XMLHttpRequest, IS_PATCHED_MODULE, {\n      enumerable: true,\n      configurable: true,\n      value: true\n    });\n    this.subscriptions.push(() => {\n      Object.defineProperty(globalThis.XMLHttpRequest, IS_PATCHED_MODULE, {\n        value: void 0\n      });\n      globalThis.XMLHttpRequest = PureXMLHttpRequest;\n      logger.info(\n        'native \"XMLHttpRequest\" module restored!',\n        globalThis.XMLHttpRequest.name\n      );\n    });\n  }\n};\nvar XMLHttpRequestInterceptor = _XMLHttpRequestInterceptor;\nXMLHttpRequestInterceptor.interceptorSymbol = Symbol(\"xhr\");\n\nexport {\n  XMLHttpRequestInterceptor\n};\n//# sourceMappingURL=chunk-732REFPX.mjs.map","import {record} from 'rrweb';\nimport { BatchInterceptor } from '@mswjs/interceptors';\nimport { FetchInterceptor } from '@mswjs/interceptors/fetch';\nimport { XMLHttpRequestInterceptor } from '@mswjs/interceptors/XMLHttpRequest';\n// Buffer to store events before sending in batches. Used for onError event sending (last N events)\nvar eventsMatrix = [[]];\n// Buffer to store events for continuous send (when normal recording is enabled)\nvar eventBuffer = [];\nvar stopFn;\nvar sessionStartTime;\nvar shouldRecordSession = false;\nvar shouldRecordSessionOnError = false;\nconst requestIdToSpanIdMap = new Map();\n\nlet samplingConfig = {\n  // do not record mouse movement\n  mousemove: false,\n  // do not record mouse interaction\n  mouseInteraction: true,\n  // set the interval of scrolling event\n  scroll: 150, // do not emit twice in 150ms\n  // set the interval of media interaction event\n  media: 800,\n  // set the timing of record input\n  input: 'last' // When input multiple characters, only record the final input\n};\n\nfunction generateSpanId() {\n  let spanId = '';\n  for (let i = 0; i < 8; i++) {\n    // Generate a random byte and convert it to a 2-character hexadecimal string\n    const byte = Math.floor(Math.random() * 256).toString(16).padStart(2, '0');\n    spanId += byte;\n  }\n  return spanId;\n}\n\nfunction generateTraceparent(parentSpanId) {\n    // Generate random trace ID (hexadecimal, 32 characters)\n    const traceId = Array(32)\n        .fill()\n        .map(() => Math.floor(Math.random() * 16).toString(16))\n        .join('');\n\n    // Combine trace ID and parent ID in a traceparent format\n    const traceparent = `00-${traceId}-${parentSpanId}-01`;\n    return traceparent;\n  }\n\nfunction setCurrentUserId(userId) {\n  document.cookie = \"testchimp.current_user_id=\" + userId + \";path=/\";\n}\n\n// Function to get the current_user_id from the cookie\nfunction getCurrentUserId() {\n  return getCookie(\"testchimp.current_user_id\");\n}\n\n// Function to generate a unique session ID\nfunction generateSessionId() {\n  // Custom UUID generation logic\n  var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0,\n      v = c === 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n  return 'session_' + uuid;\n}\n\nfunction log(config,log){\n    if(config.enableLogging){\n        console.log(log);\n    }\n}\n\n// Function to retrieve session ID from standard session ID cookies or custom cookie key\nfunction getSessionIdFromCookie(cookieKey) {\n  if (!cookieKey) {\n    var standardCookieNames = ['JSESSIONID', 'PHPSESSID', 'ASP.NET_SessionId', 'CFID', 'CFTOKEN']; // Add more standard session ID cookie names if needed\n    var cookies = document.cookie.split(';');\n    for (var i = 0; i < cookies.length; i++) {\n      var cookie = cookies[i].trim();\n      for (var j = 0; j < standardCookieNames.length; j++) {\n        var standardCookieName = standardCookieNames[j];\n        if (cookie.startsWith(standardCookieName + '=')) {\n          return cookie.substring(standardCookieName.length + 1);\n        }\n      }\n    }\n  } else {\n    var cookies = document.cookie.split(';');\n    for (var i = 0; i < cookies.length; i++) {\n      var cookie = cookies[i].trim();\n      var cookieParts = cookie.split('=');\n      if (cookieParts.length === 2 && cookieParts[0] === cookieKey) {\n        return cookieParts[1];\n      }\n    }\n  }\n  return null; // Return null if session ID cookie doesn't exist\n}\n\nfunction setTrackingIdCookie(sessionId) {\n    var existingCookie = getCookie(\"testchimp.session-record-tracking-id\");\n    if (existingCookie === \"\") {\n       document.cookie = \"testchimp.session-record-tracking-id=\" + sessionId + \";path=/;max-age=600;\";\n    }\n    var parentSessionCookie=getCookie(\"testchimp.parent-session-record-tracking-id\");\n    if (parentSessionCookie === \"\") {\n        document.cookie = \"testchimp.parent-session-record-tracking-id\" + \"=\" + sessionId + \";path=/\";\n    }\n}\n\nfunction getTrackingIdCookie(){\n  var existingCookie=getCookie(\"testchimp.session-record-tracking-id\");\n  if (existingCookie === \"\") {\n    var sessionId = generateSessionId();\n    document.cookie = \"testchimp.session-record-tracking-id=\" + sessionId + \";path=/;max-age=600;\";\n    var parentSessionCookie=getCookie(\"testchimp.parent-session-record-tracking-id\");\n    if (parentSessionCookie === \"\") {\n        document.cookie = \"testchimp.parent-session-record-tracking-id\" + \"=\" + sessionId + \";path=/\";\n    }\n    return sessionId;\n  }\n  return existingCookie;\n}\n\nfunction getParentTrackingIdCookie(){\n    var parentSessionCookie=getCookie(\"testchimp.parent-session-record-tracking-id\");\n    if (parentSessionCookie === \"\") {\n        var sessionId = generateSessionId();\n        document.cookie = \"testchimp.parent-session-record-tracking-id\" + \"=\" + sessionId + \";path=/\";\n        return sessionId;\n    }\n    return parentSessionCookie;\n}\n\nfunction getCookie(name) {\n  var nameEQ = name + \"=\";\n  var cookies = document.cookie.split(';');\n  for (var i = 0; i < cookies.length; i++) {\n    var cookie = cookies[i];\n    while (cookie.charAt(0) == ' ') {\n      cookie = cookie.substring(1, cookie.length);\n    }\n    if (cookie.indexOf(nameEQ) == 0) {\n      return cookie.substring(nameEQ.length, cookie.length);\n    }\n  }\n  return \"\";\n}\n\nfunction sendPayloadToEndpoint(payload, endpoint) {\n  const body = JSON.stringify(payload);\n  fetch(endpoint, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    mode: 'no-cors',\n    body: body,\n  }).catch(function (error) {\n    console.error('Error sending payload:', error);\n  });\n}\n\nasync function populateHttpPayload(config, rawPayload) {\n    const method = rawPayload.method;\n    const httpPayload = {\n        headerMap: {},\n        queryParamMap: {},\n        httpMethod: method ?? \"\"\n    };\n\n    // Convert headers to a plain object\n    rawPayload.headers.forEach((value, key) => {\n        httpPayload.headerMap[key] = value;\n    });\n\n    if (rawPayload.status) {\n        httpPayload.responseCode = rawPayload.status;\n    }\n\n    const urlParams = new URLSearchParams(rawPayload.url.split('?')[1] || '');\n    urlParams.forEach((value, key) => {\n        httpPayload.queryParamMap[key] = value;\n    });\n\n    const contentType = rawPayload.headers.get('content-type') || '';\n\n    if (method !== 'GET') {\n        if (contentType.includes('application/json')) {\n            try {\n                const body = await rawPayload.json();\n                httpPayload.jsonBody = JSON.stringify(body);\n            } catch {\n                httpPayload.jsonBody = \"{}\";\n            }\n        } else if (contentType.includes('multipart/form-data')) {\n            try {\n                const formData = await rawPayload.formData();\n                const keyValueMap = {};\n                let formDataSize = 0;\n\n                for (const [key, value] of formData.entries()) {\n                    formDataSize += value.size;\n                    if (formDataSize > 10 * 1024 * 1024) {\n                        log(config, \"Binary data exceeds 10MB. Dropping data.\");\n                        break;\n                    }\n                    keyValueMap[key] = value;\n                }\n                httpPayload.httpFormDataBody = { keyValueMap };\n            } catch {\n                // Handle error\n            }\n        } else if (contentType.includes('application/octet-stream')) {\n            try {\n                const buffer = await rawPayload.arrayBuffer();\n                if (buffer.byteLength <= 10 * 1024 * 1024) {\n                    httpPayload.binaryDataBody = { data: buffer };\n                } else {\n                    log(config, \"Binary data exceeds 10MB. Dropping data.\");\n                }\n            } catch {\n                // Handle error\n            }\n        } else if (contentType.includes('application/x-www-form-urlencoded')) {\n            try {\n                const body = new URLSearchParams(await rawPayload.text());\n                const keyValueMap = {};\n                body.forEach((value, key) => {\n                    keyValueMap[key] = value;\n                });\n                httpPayload.httpFormUrlencodedBody = { keyValueMap };\n            } catch {\n                // Handle error\n            }\n        } else {\n            try {\n                const body = await rawPayload.text();\n                if (contentType.includes('text/plain')) {\n                    httpPayload.textBody = body;\n                } else if (contentType.includes('text/html')) {\n                    httpPayload.htmlBody = body;\n                } else if (contentType.includes('application/xml') || contentType.includes('text/xml')) {\n                    httpPayload.xmlBody = body;\n                } else {\n                    httpPayload.textBody = body;\n                }\n            } catch (error) {\n                console.error('Error reading payload:', error);\n            }\n        }\n    }\n\n    return httpPayload;\n}\n\nasync function enableRequestIntercept(config) {\n  let urlRegex = config.tracedUriRegexListToTrack;\n  let untracedUrisToTrackRegex = config.untracedUriRegexListToTrack;\n  let excludedUriRegexList=config.excludedUriRegexList;\n  let enableOptionsCallTracking=config.enableOptionsCallTracking;\n\n  const parentSessionId = getParentTrackingIdCookie();\n  if (typeof urlRegex === 'string') {\n    urlRegex = [urlRegex];\n  }\n\n  if (typeof untracedUrisToTrackRegex === 'string') {\n    untracedUrisToTrackRegex = [untracedUrisToTrackRegex];\n  }\n\n  if (typeof excludedUriRegexList === 'string') {\n    excludedUriRegexList = [excludedUriRegexList];\n  }\n\n  // Get sessionId from the storage\n  log(config, \"Using interception to add tracking cookie for url regex: \" + urlRegex);\n\n  // Create instances of the interceptors\n  const fetchInterceptor = new FetchInterceptor();\n  const xhrInterceptor = new XMLHttpRequestInterceptor();\n\n  // Create a BatchInterceptor to combine the interceptors\n  const interceptor = new BatchInterceptor({\n    name: 'request-interceptor',\n    interceptors: [fetchInterceptor, xhrInterceptor],\n  });\n\n  // Map to store requestId -> request.url\n  const requestUrls = new Map();\n\n  // Object to store request payloads\n  const requestPayloads = {};\n\n  // Add listeners for the 'request' event on the BatchInterceptor\n  interceptor.on('request', async ({ request, requestId }) => {\n    if (!enableOptionsCallTracking && request.method === 'OPTIONS') {\n        return;\n    }\n    let sessionId = getTrackingIdCookie();\n    let matchedTracedUri = urlRegex.some(regex => request.url.match(regex));\n    let matchedUntracedUri = untracedUrisToTrackRegex.some(regex => request.url.match(regex));\n    let matchedExcludedUri=excludedUriRegexList.some(regex=>request.url.match(regex));\n    if(!matchedExcludedUri){\n        if (matchedTracedUri) {\n          log(config, \"request matches regex for interception \" + request.url);\n          // Add the 'testchimp-session-record-tracking-id' header\n          request.headers.set('testchimp-session-record-tracking-id', sessionId);\n          request.headers.set('testchimp-parent-session-record-tracking-id', parentSessionId);\n          let currentUserId=getCurrentUserId();\n          if(currentUserId){\n            request.headers.set('testchimp-current-user-id', currentUserId);\n          }\n        } else if (matchedUntracedUri) {\n          log(config, \"request matches regex for untraced uris to track \" + request.url);\n          // Store the request URL in the map\n          const parsedUrl = new URL(request.url);\n          const urlWithoutQueryParams = `${parsedUrl.origin}${parsedUrl.pathname}`;\n          // Store the request URL without query parameters in the map\n          requestUrls.set(requestId, urlWithoutQueryParams);\n\n          let traceparent = request.headers.get('traceparent');\n          if (!traceparent) {\n            traceparent = generateTraceparent(generateSpanId());\n            log(config, \"Generating new traceparent \" + traceparent);\n          }\n          const parts = traceparent.split('-');\n          let spanId = parts[2];\n          requestIdToSpanIdMap.set(requestId, spanId);\n\n          // Capture request body and headers\n          try {\n            const requestPayload = await populateHttpPayload(config,request);\n            requestPayloads[requestId] = requestPayload;\n          } catch (error) {\n            console.error('Error populating request payload:', error);\n          }\n        }\n    }\n  });\n\n  // Add listeners for the 'response' event on the BatchInterceptor\n  interceptor.on('response', async ({ response, requestId }) => {\n    let matchedUntracedUri = untracedUrisToTrackRegex.some(regex => response.url.match(regex));\n    let matchedExcludedUri=excludedUriRegexList.some(regex=>response.url.match(regex));\n    if(!matchedExcludedUri){\n      let sessionId = getTrackingIdCookie();\n      if (matchedUntracedUri || requestUrls.has(requestId)) {\n          // Capture response body and headers\n          try {\n            const responsePayload = await populateHttpPayload(config,response);\n            const requestPayload = requestPayloads[requestId];\n            const requestUrl = requestUrls.get(requestId);\n            const spanId = requestIdToSpanIdMap.get(requestId);\n\n            if (requestPayload && requestUrl && spanId) {\n              const payload = {\n                requestPayload: {\n                  spanId: spanId,\n                  httpPayload: requestPayload\n                },\n                responsePayload: {\n                  spanId: spanId,\n                  httpPayload: responsePayload\n                }\n              };\n              const insertPayloadRequest = {\n                aware_project_id: config.projectId,\n                aware_session_tracking_api_key: config.sessionRecordingApiKey,\n                request_payload: JSON.stringify(payload.requestPayload),\n                response_payload: JSON.stringify(payload.responsePayload),\n                current_user_id: getCurrentUserId(), // Include the current_user_id\n                url: requestUrl, // Use the stored request.url\n                tracking_id: sessionId,\n                parent_tracking_id:parentSessionId,\n                environment: config.environment,\n                request_timestamp: new Date().getTime(),\n                response_timestamp: new Date().getTime()\n              };\n              sendPayloadToEndpoint(insertPayloadRequest, config.endpoint + '/insert_client_recorded_payloads');\n\n              // Remove the requestId from the maps after processing\n              requestUrls.delete(requestId);\n              requestIdToSpanIdMap.delete(requestId);\n              delete requestPayloads[requestId];\n            }\n          } catch (error) {\n            console.error('Error populating response payload:', error);\n          }\n        }\n    }\n  });\n\n  // Apply the interceptor\n  interceptor.apply();\n}\n\n// Function to send events to the backend and reset the events array\nfunction sendEvents(endpoint, config, events) {\n  if (events.length === 0 || !config.projectId || !config.sessionRecordingApiKey) return;\n\n  const sessionRecordEvents = events.map(event => {\n    return {\n      payload: JSON.stringify(event),\n    };\n  });\n\n  // Clear the event buffer. While sendEvents is used in both onError and normal recording, the eventBuffer is utilized only in normal recording.\n  eventBuffer = [];\n\n  let sessionId=getTrackingIdCookie();\n  let parentSessionId=getParentTrackingIdCookie();\n  const body = {\n    tracking_id: sessionId,\n    parent_tracking_id:parentSessionId,\n    aware_project_id: config.projectId,\n    aware_session_tracking_api_key: config.sessionRecordingApiKey,\n    event_list:{\n        events: sessionRecordEvents\n    }\n  };\n\n  let sessionSendEnabled=true;\n  let sessionRecordEndpoint=endpoint+\"/session_records\";\n  if(sessionSendEnabled){\n    sendPayloadToEndpoint(body,sessionRecordEndpoint);\n  }\n}\n\nfunction startSendingEventsWithCheckout(config) {\n\n  stopFn = record({\n    emit: function (event, isCheckout) {\n      // isCheckout is a flag to tell if the events have been checked out\n      if (isCheckout) {\n        eventsMatrix.push([]);\n      }\n      const lastEvents = eventsMatrix[eventsMatrix.length - 1];\n      lastEvents.push(event);\n    },\n    sampling: samplingConfig,\n    checkoutEveryNth: config.eventWindowToSaveOnError || 200, // Default checkout every 200 events\n  });\n}\n\n// Function to start sending events in batches every 5 seconds\nfunction startSendingEvents(endpoint, config) {\n\n  stopFn =record({\n    emit: function (event) {\n      eventBuffer.push(event)\n    },\n    sampling: samplingConfig,\n  });\n\n  // Save events every 5 seconds\n  var intervalId = setInterval(function () {\n    var sessionDuration = (new Date().getTime() - sessionStartTime) / 1000;\n    if (!config.maxSessionDurationSecs || (config.maxSessionDurationSecs && sessionDuration < config.maxSessionDurationSecs)) {\n      sendEvents(endpoint, config, eventBuffer);\n    } else {\n      clearInterval(intervalId); // Clear the interval\n      if (typeof stopFn === 'function') {\n        stopFn(); // Stop the recording\n        stopFn = null;\n      }\n    }\n  }, 5000);\n}\n\n// Function to stop sending events\nfunction stopSendingEvents() {\n  if (stopFn) {\n    stopFn(); // Stop recording events\n    stopFn = null;\n  }\n}\n\nfunction initRecording(endpoint,config){\n  // Start sending events\n  if (shouldRecordSession) {\n    startSendingEvents(endpoint, config);\n  } else {\n    if (shouldRecordSessionOnError) {\n      startSendingEventsWithCheckout(config);\n    }\n  }\n};\n\nfunction clearTrackingIdCookie(){\n    document.cookie = \"testchimp.session-record-tracking-id=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/;max-age=0;\";\n    document.cookie = \"testchimp.parent-session-record-tracking-id=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/;max-age=0;\";\n}\n\nfunction endTrackedSession(){\n    stopSendingEvents()\n    clearTrackingIdCookie();\n}\n\n// Function to start recording user sessions\nasync function startRecording(config) {\n  console.log(\"Initializing recording for TestChimp Project: \" + config.projectId);\n\n  // Retrieve session ID from cookie\n  var sessionId = getSessionIdFromCookie(config.sessionIdCookieKey);\n\n  // If session ID doesn't exist in cookie, generate a new one\n  if (!sessionId) {\n    sessionId = generateSessionId();\n  }\n  setTrackingIdCookie(sessionId);\n  sessionId = getTrackingIdCookie();\n\n  // Record the session start time\n  sessionStartTime = new Date().getTime();\n\n  const defaultMaxSessionDurationSecs = 600; // 10 mins\n  const defaultEventWindowToSaveOnError = 200;\n  const defaultUrlRegexToAddTracking = [\"/^$/\"]; // Match no URLs\n  const defaultUntracedUrisToTrackRegex = [\"/^$/\"]; // Match no URLs\n  const defaultSamplingProbability = 1.0;\n  const defaultSamplingProbabilityOnError = 0.0;\n  const defaultEnvironment = \"QA\";\n  const defaultEndpoint=\"https://ingress.testchimp.io\";\n\n  if (!config.projectId) {\n    console.log(\"No project id specified for session capture\");\n    return;\n  }\n  if (!config.sessionRecordingApiKey) {\n    console.log(\"No session recording api key specified for session capture\");\n    return;\n  }\n\n  let endpoint=config.endpoint || defaultEndpoint;\n  window.TestChimpSDKConfig = {\n    enableRecording:config.enableRecording || true,\n    endpoint: endpoint,\n    projectId: config.projectId,\n    sessionRecordingApiKey: config.sessionRecordingApiKey,\n    samplingProbability: config.samplingProbability || defaultSamplingProbability,\n    maxSessionDurationSecs: config.maxSessionDurationSecs || defaultMaxSessionDurationSecs,\n    samplingProbabilityOnError: config.samplingProbabilityOnError || defaultSamplingProbabilityOnError,\n    eventWindowToSaveOnError: config.eventWindowToSaveOnError || defaultEventWindowToSaveOnError,\n    tracedUriRegexListToTrack: config.tracedUriRegexListToTrack || defaultUrlRegexToAddTracking,\n    untracedUriRegexListToTrack: config.untracedUriRegexListToTrack || defaultUntracedUrisToTrackRegex,\n    excludedUriRegexList:config.excludedUriRegexList || [],\n    environment: config.environment || defaultEnvironment,\n    enableLogging: config.enableLogging || true,\n    enableOptionsCallTracking:config.enableOptionsCallTracking || false\n  };\n\n  config = window.TestChimpSDKConfig;\n  console.log(\"config used for session recording: \", config);\n    console.log(\"NEW7\");\n  // Determine whether to record the session based on samplingProbability\n  shouldRecordSession = config.samplingProbability && Math.random() <= config.samplingProbability;\n\n  // Determine the sampling decision for error scenarios\n  shouldRecordSessionOnError = config.samplingProbabilityOnError && Math.random() <= config.samplingProbabilityOnError;\n\n  log(config, \"Should record session: \" + shouldRecordSession + \" should record on error: \" + shouldRecordSessionOnError);\n\n  // Intercept all outgoing requests and add additional HTTP header\n  if (shouldRecordSession || shouldRecordSessionOnError) {\n    log(config, \"Setting tracking id in cookie \" + sessionId);\n    await enableRequestIntercept(config);\n  }\n\n  window.onerror = function () {\n    if (shouldRecordSessionOnError && !shouldRecordSession) {\n      const len = eventsMatrix.length;\n      const events = eventsMatrix[len - 2].concat(eventsMatrix[len - 1]);\n      sendEvents(endpoint, config, events);\n    }\n  };\n\n  initRecording(endpoint, config);\n}\n\n\n// Expose the startRecording function along with other recording-related methods to consumers\nvar TestChimpSDK = {\n  startRecording: startRecording,\n  endTrackedSession:endTrackedSession,\n  stopRecording: stopSendingEvents, // Expose the stopRecording function\n  setCurrentUserId: setCurrentUserId // Expose the setCurrentUserId function\n};\n\n// Export TestChimpSDK\nexport { TestChimpSDK };\n"],"names":["root","factory","exports","module","define","amd","this","NodeType","__webpack_require__","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","isShadowRoot","n","host","Boolean","shadowRoot","isNativeShadowDom","toString","getCssRulesString","s","rules","cssRules","cssText","Array","from","map","getCssRuleString","join","includes","replace","error","rule","cssStringified","isCSSImportRule","styleSheet","_a","Mirror","idNodeMap","Map","nodeMetaMap","WeakMap","getId","id","getMeta","getNode","getIds","keys","removeNodeFromMap","_this","childNodes","forEach","childNode","has","hasNode","node","add","meta","set","oldNode","reset","maskInputValue","maskInputOptions","tagName","type","maskInputFn","text","toLowerCase","repeat","length","canvasService","canvasCtx","ORIGINAL_ATTRIBUTE_NAME","_id","tagNameRegex","RegExp","IGNORED_NODE","genId","URL_IN_CSS_REF","RELATIVE_PATH","DATA_URI","absoluteToStylesheet","href","origin","quote1","path1","quote2","path2","path3","url","filePath","maybeQuote","test","concat","indexOf","split","slice","stack","parts","pop","_i","parts_1","part","push","SRCSET_NOT_SPACES","SRCSET_COMMAS_OR_SPACES","absoluteToDoc","doc","attributeValue","trim","a","createElement","getHref","document","transformAttribute","name","pos","collectCharacters","regEx","chars","match","exec","substring","output","descriptorsStr","inParens","c","charAt","getAbsoluteSrcsetString","classMatchesRegex","regex","checkAncestors","nodeType","ELEMENT_NODE","parentNode","eIndex","classList","className","needMaskingText","maskTextClass","maskTextSelector","el","parentElement","contains","closest","matches","lowerIfExists","maybeAttr","undefined","serializeNodeWithId","options","mirror","blockClass","blockSelector","skipChild","_b","inlineStylesheet","_c","maskTextFn","slimDOMOptions","_d","dataURLOptions","_e","inlineImages","_f","recordCanvas","onSerialize","onIframeLoad","_g","iframeLoadTimeout","onStylesheetLoad","_h","stylesheetLoadTimeout","_j","keepIframeSrcFn","_k","newlyAddedElement","_l","preserveWhiteSpace","_serializedNode","rootId","docId","getRootId","DOCUMENT_NODE","compatMode","Document","DOCUMENT_TYPE_NODE","DocumentType","publicId","systemId","needBlock","element","_isBlockedElement","HTMLFormElement","processedTagName","getValidTagName","attributes","len","i","attr","stylesheet","styleSheets","find","rel","_cssText","sheet","innerText","textContent","checked","selected","__context","canvas","ctx","getContext","x","width","y","height","getImageData","originalGetImageData","Uint32Array","Math","min","data","buffer","some","pixel","is2DCanvasBlank","rr_dataURL","toDataURL","quality","canvasDataURL","blankCanvas","image_1","oldValue_1","crossOrigin","recordInlineImage","naturalWidth","naturalHeight","drawImage","err","console","warn","currentSrc","removeAttribute","complete","onload","rr_mediaState","paused","rr_mediaCurrentTime","currentTime","scrollLeft","rr_scrollLeft","scrollTop","rr_scrollTop","getBoundingClientRect","rr_width","rr_height","src","contentDocument","rr_src","Element","isSVG","ownerSVGElement","serializeElementNode","TEXT_NODE","parentTagName","isStyle","isScript","nextSibling","previousSibling","Text","serializeTextNode","CDATA_SECTION_NODE","CDATA","COMMENT_NODE","Comment","serializeNode","sn","comment","script","as","endsWith","headFavicon","headMetaDescKeywords","headMetaSocial","property","headMetaRobots","headMetaHttpEquiv","headMetaAuthorship","headMetaVerification","slimDOMExcluded","serializedNode","assign","recordChild","isShadowHost","headWhitespace","bypassOptions","_m","serializedChildNode","isElement","_o","_p","isShadow","iframeEl","listener","win","contentWindow","readyState","fired","blankUrl","location","setTimeout","addEventListener","timer_1","clearTimeout","onceIframeLoaded","iframeDoc","serializedIframeNode","link","styleSheetLoadTimeout","styleSheetLoaded","timer","onceStylesheetLoaded","serializedLinkNode","on","fn","target","capture","passive","removeEventListener","source","DEPARTED_MIRROR_ACCESS_WARNING","_mirror","throttle","func","wait","timeout","previous","args","now","Date","leading","remaining","context","apply","trailing","hookSetter","d","isRevoked","window","original","getOwnPropertyDescriptor","patch","replacement","wrapped","defineProperties","__rrweb_original__","getWindowHeight","innerHeight","documentElement","clientHeight","body","getWindowWidth","innerWidth","clientWidth","isBlocked","isIgnored","isAncestorRemoved","isTouchEvent","event","changedTouches","isSerializedIframe","nodeName","isSerializedStylesheet","getAttribute","hasShadowRoot","Proxy","Reflect","receiver","StyleSheetMirror","constructor","styleIDMap","idStyleMap","newId","getStyle","generateId","EventType","EventType2","IncrementalSource","IncrementalSource2","MouseInteractions","MouseInteractions2","CanvasContext","CanvasContext2","isNodeInLinkedList","DoubleLinkedList","head","position","Error","current","index","next","addNode","__ln","removeNode","moveKey","parentId","MutationBuffer","frozen","locked","texts","removes","mapRemoves","movedMap","addedSet","Set","movedSet","droppedSet","processMutations","mutations","processMutation","emit","adds","addList","getNextId","ns","nextId","pushAdd","shadowHost","getRootNode","Node","DOCUMENT_FRAGMENT_NODE","rootShadowHost","notInDoc","currentN","iframeManager","addIframe","stylesheetManager","trackLinkElement","shadowDomManager","addShadowRoot","iframe","childSn","attachIframe","observeAttachShadow","attachLinkElement","shift","values","isParentRemoved","isAncestorInSet","candidate","_node","unhandledNode","payload","filter","attribute","mutationCb","m","oldValue","attributeName","item","old","setAttribute","style","styleObj","pname","newValue","getPropertyValue","newPriority","getPropertyPriority","addedNodes","genAdds","removedNodes","nodeId","isSerialized","deepDelete","targetId","delete","childN","init","freeze","canvasManager","unfreeze","isFrozen","lock","unlock","addsSet","_isParentRemoved","r","size","_isAncestorInSet","mutationBuffers","isCSSGroupingRuleSupported","CSSGroupingRule","isCSSMediaRuleSupported","CSSMediaRule","isCSSSupportsRuleSupported","CSSSupportsRule","isCSSConditionRuleSupported","CSSConditionRule","getEventTarget","path","composedPath","initMutationObserver","rootEl","mutationBuffer","mutationObserverCtor","MutationObserver","__rrMutationObserver","angularZoneSymbol","Zone","__symbol__","observer","bind","observe","attributeOldValue","characterData","characterDataOldValue","childList","subtree","initScrollObserver","scrollCb","sampling","evt","scrollEl","scrollingElement","scroll","wrapEventWithUserTriggeredFlag","v","enable","userTriggered","INPUT_TAGS","lastInputValueMap","getNestedCSSRulePositions","childRule","parentRule","unshift","parentStyleSheet","recurse","getIdAndStyleId","styleMirror","styleId","ownerNode","initAdoptedStyleSheetObserver","hostId","patchTarget","defaultView","ownerDocument","ShadowRoot","originalPropertyDescriptor","configurable","sheets","result","adoptStyleSheets","e","initObservers","hooks","currentWindow","mousemoveCb","mouseInteractionCb","viewportResizeCb","inputCb","mediaInteractionCb","styleSheetRuleCb","styleDeclarationCb","canvasMutationCb","fontCb","selectionCb","p","mutation","mousemove","mouseInteraction","viewportResize","input","mediaInteaction","styleSheetRule","styleDeclaration","canvasMutation","font","selection","mergeHooks","mutationObserver","mousemoveHandler","threshold","callbackThreshold","mousemoveCallback","timeBaseline","positions","wrappedCb","totalOffset","timeOffset","updatePosition","clientX","clientY","DragEvent","Drag","MouseEvent","MouseMove","TouchMove","handlers","h","initMoveObserver","mouseInteractionHandler","disableMap","Number","isNaN","eventKey","eventName","handler","getHandler","initMouseInteractionObserver","scrollHandler","viewportResizeHandler","lastH","lastW","initViewportResizeObserver","inputHandler","ignoreClass","userTriggeredOnInput","eventHandler","isTrusted","isChecked","cbWithDedup","querySelectorAll","lastInputValue","propertyDescriptor","HTMLInputElement","hookProperties","HTMLSelectElement","HTMLTextAreaElement","HTMLOptionElement","initInputObserver","mediaInteractionHandler","volume","muted","playbackRate","media","initMediaInteractionObserver","styleSheetObserver","insertRule","CSSStyleSheet","deleteRule","replaceSync","supportedNestedCSSRuleTypes","unmodifiedFunctions","entries","typeKey","initStyleSheetObserver","adoptedStyleSheetObserver","styleDeclarationObserver","ignoreCSSAttributes","setProperty","CSSStyleDeclaration","priority","removeProperty","remove","initStyleDeclarationObserver","fontObserver","collectFonts","fontMap","originalFontFace","FontFace","family","descriptors","fontFace","fontSource","JSON","stringify","Uint8Array","restoreHandler","fonts","initFontObserver","selectionObserver","param","collapsed","updateSelection","getSelection","isCollapsed","ranges","count","rangeCount","range","getRangeAt","startContainer","startOffset","endContainer","endOffset","start","end","initSelectionObserver","pluginHandlers","plugin","plugins","callback","b","disconnect","CrossOriginIframeMirror","generateIdFn","iframeIdToRemoteIdMap","iframeRemoteIdToIdMap","remoteId","idToRemoteMap","remoteToIdMap","idToRemoteIdMap","getIdToRemoteIdMap","remoteIdToIdMap","getRemoteIdToIdMap","getRemoteId","getRemoteIds","ids","IframeManager","iframes","crossOriginIframeMap","crossOriginIframeMirror","wrappedEmit","recordCrossOriginIframes","crossOriginIframeStyleMirror","handleMessage","addLoadListener","cb","loadListener","isAttachIframe","adoptedStyleSheets","message","transformedEvent","transformCrossOriginEvent","isCheckout","FullSnapshot","replaceIdOnNode","timestamp","IncrementalSnapshot","Mutation","Meta","Load","DomContentLoaded","Plugin","Custom","replaceIds","ViewportResize","MediaInteraction","MouseInteraction","Scroll","CanvasMutation","Input","StyleSheetRule","StyleDeclaration","replaceStyleIds","Font","Selection","AdoptedStyleSheet","styles","iframeMirror","isArray","child","ShadowDomManager","shadowDoms","WeakSet","restorePatches","manager","option","iframeElement","HTMLElement","restorePatch","lookup","charCodeAt","canvasVarMap","saveWebGLVar","isInstanceOfWebGLObject","list","ctor","contextMap","variableListFor","serializeArg","arg","Float32Array","Float64Array","Int32Array","Uint16Array","Int16Array","Int8Array","Uint8ClampedArray","rr_type","ArrayBuffer","base64","arraybuffer","bytes","encode","DataView","byteOffset","byteLength","HTMLImageElement","HTMLCanvasElement","ImageData","serializeArgs","supportedWebGLConstructorNames","initCanvasContextObserver","contextType","patchGLPrototype","props","getOwnPropertyNames","recordArgs","hookHandler","setter","WorkerClass","WorkerThreads","require","Worker","enableUnicodeArg","WorkerFactory","process","sourcemapArg","sourcemap","enableUnicode","Buffer","decodeBase64","eval","createBase64WorkerFactory","binaryString","atob","binaryView","String","fromCharCode","blob","Blob","URL","createObjectURL","createURL","CanvasManager","pendingCanvasMutations","rafStamps","latestId","invokeId","initCanvasMutationObserver","initCanvasFPSObserver","clear","resetObservers","fps","canvasContextReset","snapshotInProgressMap","worker","onmessage","commands","timeBetweenSnapshots","rafId","lastSnapshotTime","takeCanvasSnapshots","matchedCanvas","getCanvas","__awaiter","thisArg","_arguments","generator","getContextAttributes","preserveDrawingBuffer","COLOR_BUFFER_BIT","bitmap","createImageBitmap","postMessage","P","Promise","resolve","reject","fulfilled","step","rejected","done","then","requestAnimationFrame","cancelAnimationFrame","startRAFTimestamping","startPendingCanvasMutationFlusher","canvas2DReset","props2D","CanvasRenderingContext2D","initCanvas2DMutationObserver","canvasWebGL1and2Reset","WebGLRenderingContext","WebGL","WebGL2RenderingContext","WebGL2","initCanvasWebGLMutationObserver","flushPendingCanvasMutations","setLatestRAFTimestamp","flushPendingCanvasMutationFor","valuesWithType","rest","t","getOwnPropertySymbols","propertyIsEnumerable","__rest","StylesheetManager","trackedLinkElements","adoptedStyleSheetCb","linkEl","trackStylesheetInLinkElement","adoptedStyleSheetData","styleIds","CSSRule","wrapEvent","takeFullSnapshot","recording","record","checkoutEveryNms","checkoutEveryNth","maskAllInputs","_maskInputOptions","_slimDOMOptions","packFn","mousemoveWait","inEmittingFrame","parent","passEmitsToParent","color","date","email","month","number","search","tel","time","week","textarea","select","password","lastFullSnapshotEvent","NodeList","DOMTokenList","TypeError","polyfill","incrementalSnapshotCount","eventProcessor","buf","exceedCount","exceedTime","wrappedMutationEmit","wrappedScrollEmit","wrappedCanvasMutationEmit","getMirror","nodeMirror","slimDOM","snapshot","initialOffset","left","pageXOffset","top","pageYOffset","addCustomEvent","tag","freezePage","encoder","TextEncoder","IS_PATCHED_MODULE","RESPONSE_STATUS_CODES_WITHOUT_BODY","createServerErrorResponse","Response","status","statusText","headers","isResponseError","response","isPropertyAccessible","isNodeProcess","navigator","product","versions","POSITIONALS_EXP","format","positionals","positionalIndex","formattedMessage","isEscaped","_","flag","positional","json","serializePositional","InvariantError","super","nextStack","splice","cleanErrorStack","invariant","predicate","ErrorConstructor","formatMessage","construct","__defProp","colors_exports","yellow","blue","gray","red","green","all","__export","IS_NODE","Logger","prefix","LOGGER_NAME","getVariable","LOGGER_LEVEL","startsWith","debug","isDefinedAndNotEquals","noop","info","success","warning","only","extend","domain","logEntry","level","colors","performance2","PerformanceEntry","message2","positionals2","measure","deltaTime","createEntry","customColors","entry","colorize","getWriter","write","formatTimestamp","serializeInput","toLocaleTimeString","getMilliseconds","log","startTime","endTime","performance","toFixed","stdout","stderr","variableName","env","globalThis","expected","MemoryLeakError","emitter","_Emitter","listenerCount","events","maxListeners","defaultMaxListeners","hasWarnedAboutPotentialMemoryLeak","_emitInternalEvent","internalEventName","_getListeners","_removeListener","listeners","_wrapOnceListener","onceListener","removeListener","setMaxListeners","getMaxListeners","eventNames","addListener","nextListeners","memoryLeakWarning","once","prependListener","prependOnceListener","off","removeAllListeners","rawListeners","Emitter","getGlobalSymbol","symbol","Interceptor","subscriptions","logger","description","checkEnvironment","runningInstance","getInstance","setup","setInstance","dispose","clearInstance","instance","createRequestId","random","BatchInterceptor","interceptors","interceptor","DeferredPromise","executor","deferredExecutor","state","reason","queueMicrotask","rejectionReason","createDeferredExecutor","originalResolve","originalReject","onFulfilled","onRejected","catch","onfinally","finally","promise","RequestController","request","responsePromise","respondWith","method","toInteractiveRequest","requestController","interactiveRequest","async","emitAsync","listners","until","_FetchInterceptor","fetch","pureFetch","requestId","resolvedInput","_error","canParseUrl","Request","pendingRequestId","signal","requestAborted","responseClone","clone","isMockedResponse","writable","errorWith","resolverResult","listenersFinished","race","mockedResponse2","createNetworkError","controller","mockedResponse","aborted","FetchInterceptor","cause","EventPolyfill","AT_TARGET","BUBBLING_PHASE","CAPTURING_PHASE","NONE","srcElement","currentTarget","eventPhase","composed","cancelable","defaultPrevented","bubbles","lengthComputable","loaded","total","cancelBubble","returnValue","timeStamp","initEvent","preventDefault","stopPropagation","stopImmediatePropagation","ProgressEventPolyfill","SUPPORTS_PROGRESS_EVENT","ProgressEvent","findPropertySource","propertyName","getPrototypeOf","createProxy","proxy","constructorCall","methodCall","getProperty","newTarget","nextValue","propertySource","ownDescriptors","next2","optionsToProxyHandler","createHeadersFromXMLHttpReqestHeaders","headersString","Headers","lines","line","append","IS_MOCKED_RESPONSE","XMLHttpRequestController","initialRequest","requestHeaders","responseBuffer","invoke","methodName","toAbsoluteUrl","registerEvent","requestBody","onResponse","fetchResponse","responseBodyOrNull","getAllResponseHeaders","createResponse","fetchRequest","toFetchApiRequest","onRequest","LOADING","setRequestHeader","nextEvents","getResponseHeader","__","HEADERS_RECEIVED","headerValue","allHeaders","headerName","responseText","responseXML","totalResponseBodyLength","trigger","setReadyState","finalizeResponse","DONE","reader","getReader","readNextResponseBodyChunk","read","right","concatArrayBuffer","responseBufferToText","TextDecoder","encoding","decode","responseType","responseJson","parse","parseJson","arrayBuffer","array","mimeType","responseBlob","contentType","DOMParser","supportedType","parseFromString","nextReadyState","UNSENT","ProgressEventClass","createEvent","registeredEventName","credentials","withCredentials","proxyHeaders","_XMLHttpRequestInterceptor","interceptorSymbol","XMLHttpRequest","PureXMLHttpRequest","originalRequest","prototypeDescriptors","getOwnPropertyDescriptors","xhrRequestController","OPENED","createXMLHttpRequestProxy","XMLHttpRequestInterceptor","stopFn","sessionStartTime","eventsMatrix","eventBuffer","shouldRecordSession","shouldRecordSessionOnError","requestIdToSpanIdMap","samplingConfig","getCurrentUserId","getCookie","generateSessionId","config","enableLogging","getTrackingIdCookie","existingCookie","sessionId","cookie","getParentTrackingIdCookie","parentSessionCookie","nameEQ","cookies","sendPayloadToEndpoint","endpoint","mode","populateHttpPayload","rawPayload","httpPayload","headerMap","queryParamMap","httpMethod","responseCode","URLSearchParams","jsonBody","formData","keyValueMap","formDataSize","httpFormDataBody","binaryDataBody","httpFormUrlencodedBody","textBody","htmlBody","xmlBody","sendEvents","projectId","sessionRecordingApiKey","sessionRecordEvents","tracking_id","parent_tracking_id","aware_project_id","aware_session_tracking_api_key","event_list","stopSendingEvents","TestChimpSDK","startRecording","cookieKey","cookieParts","standardCookieNames","j","standardCookieName","getSessionIdFromCookie","sessionIdCookieKey","setTrackingIdCookie","getTime","TestChimpSDKConfig","enableRecording","samplingProbability","maxSessionDurationSecs","samplingProbabilityOnError","eventWindowToSaveOnError","tracedUriRegexListToTrack","untracedUriRegexListToTrack","excludedUriRegexList","environment","enableOptionsCallTracking","urlRegex","untracedUrisToTrackRegex","parentSessionId","fetchInterceptor","xhrInterceptor","requestUrls","requestPayloads","_ref","matchedTracedUri","matchedUntracedUri","currentUserId","parsedUrl","urlWithoutQueryParams","pathname","traceparent","parentSpanId","spanId","floor","padStart","generateSpanId","fill","requestPayload","_ref2","responsePayload","requestUrl","request_payload","response_payload","current_user_id","request_timestamp","response_timestamp","enableRequestIntercept","onerror","intervalId","setInterval","sessionDuration","clearInterval","startSendingEvents","startSendingEventsWithCheckout","initRecording","endTrackedSession","stopRecording","setCurrentUserId","userId"],"sourceRoot":""}